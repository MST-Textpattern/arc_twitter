# arc_twitter v4.0
# <a href="http://www.twitter.com">Twitter</a> for Textpattern
# Andy Carter
# http://redhotchilliproject.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YToxMTp7czo0OiJuYW1lIjtzOjExOiJhcmNfdHdpdHRlciI7czo3OiJ2ZXJzaW9uIjtzOjM6
IjQuMCI7czo2OiJhdXRob3IiO3M6MTE6IkFuZHkgQ2FydGVyIjtzOjEwOiJhdXRob3JfdXJp
IjtzOjMxOiJodHRwOi8vcmVkaG90Y2hpbGxpcHJvamVjdC5jb20vIjtzOjExOiJkZXNjcmlw
dGlvbiI7czo2MDoiPGEgaHJlZj0iaHR0cDovL3d3dy50d2l0dGVyLmNvbSI+VHdpdHRlcjwv
YT4gZm9yIFRleHRwYXR0ZXJuIjtzOjU6Im9yZGVyIjtzOjE6IjUiO3M6NDoidHlwZSI7czox
OiI1IjtzOjU6ImZsYWdzIjtzOjE6IjMiO3M6NDoiaGVscCI7czoxNzk3NjoiCTxoMSBjbGFz
cz0idGl0bGUiPjxzcGFuIGNsYXNzPSJjYXBzIj5UWFA8L3NwYW4+IFR3ZWV0IChhcmNfdHdp
dHRlciBmb3IgVGV4dHBhdHRlcm4pPC9oMT4KCgk8b2w+CgkJPGxpPjxhIGhyZWY9IiNhcmNf
dHdpdHRlcl9hdXRob3IiPkF1dGhvcjwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3
aXR0ZXJfaW5zdGFsbGF0aW9uIj5JbnN0YWxsYXRpb24gLyBVbmluc3RhbGxhdGlvbjwvYT48
L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfdGFnIj5UaGUgYXJjX3R3aXR0ZXIg
dGFnPC9hPjwvbGk+CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl9zZWFyY2hfdGFnIj5U
aGUgYXJjX3R3aXR0ZXJfc2VhcmNoIHRhZzwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJj
X3R3aXR0ZXJfdHdlZXRfYnV0dG9uX3RhZyI+VGhlIGFyY190d2l0dGVyX3R3ZWV0X2J1dHRv
biB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX2ZvbGxvd19idXR0
b25fdGFnIj5UaGUgYXJjX3R3aXR0ZXJfZm9sbG93X2J1dHRvbiB0YWc8L2E+PC9saT4KCQk8
bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3R3ZWV0X3VybCI+VGhlIGFyY190d2l0dGVyX3R3
ZWV0X3VybCB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3Rpbnl1
cmwiPlRoZSBhcmNfdHdpdHRlcl90aW55dXJsIHRhZzwvYT48L2xpPgoJCTxsaT48YSBocmVm
PSIjYXJjX3R3aXR0ZXJfY2FjaGluZyI+Q2FjaGluZzwvYT48L2xpPgoJCTxsaT48YSBocmVm
PSIjYXJjX3R3aXR0ZXJfcHJlZnMiPlByZWZlcmVuY2VzPC9hPjwvbGk+CgkJPGxpPjxhIGhy
ZWY9IiNhcmNfdHdpdHRlcl9hcnRpY2xlIj5Ud2VldGluZyBhcnRpY2xlczwvYT48L2xpPgoJ
CTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfYWRtaW4iPlRoZSBUd2l0dGVyIHRhYjwvYT48
L2xpPgoJPC9vbD4KCgk8cD48c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9zcGFuPiBUd2VldCBw
cm92aWRlcyBhY2Nlc3MgdG8geW91ciBUd2l0dGVyIGFjY291bnQgdGhyb3VnaCBib3RoIHRo
ZSBhZG1pbiBpbnRlcmZhY2UgYW5kIHRoZSBwdWJsaWMgc2lkZSBvZiB5b3VyIHNpdGUuIFVw
ZGF0ZSBUd2l0dGVyIHdoZW4geW91IHBvc3QgYSBuZXcgYXJ0aWNsZSAod2l0aCBhcnRpY2xl
LWJ5LWFydGljbGUgb3B0IG91dCBvcHRpb24pLCB1cGRhdGUgYW5kIHZpZXcgeW91ciBUd2l0
dGVyIGZlZWQgdGhyb3VnaCB0aGUgYWRtaW4gVHdpdHRlciB0YWIsIGFuZCBkaXNwbGF5IFR3
aXR0ZXIgZmVlZHMgb24geW91ciBzaXRlLjwvcD4KCgk8cD5SZXF1aXJlbWVudHM6LTwvcD4K
Cgk8dWw+CgkJPGxpPlRleHRwYXR0ZXJuIDQuNSs8L2xpPgoJCTxsaT48c3BhbiBjbGFzcz0i
Y2FwcyI+UEhQPC9zcGFuPiA1IGFuZCBjVVJMPC9saT4KCTwvdWw+CgoJPGgyIGNsYXNzPSJz
ZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfYXV0aG9yIj5BdXRob3I8L2gyPgoKCTxwPjxhIGhy
ZWY9Imh0dHA6Ly9yZWRob3RjaGlsbGlwcm9qZWN0LmNvbSI+QW5keSBDYXJ0ZXI8L2E+LiBG
b3Igb3RoZXIgVGV4dHBhdHRlcm4gcGx1Z2lucyBieSBtZSB2aXNpdCBteSA8YSBocmVmPSJo
dHRwOi8vcmVkaG90Y2hpbGxpcHJvamVjdC5jb20vdHhwIj5QbHVnaW5zIHBhZ2U8L2E+Ljwv
cD4KCgk8cD5Db250cmlidXRvcnM6IEFuZHkgQ2FydGVyLCBQaGlsIFdhcmVoYW0gYW5kIFRv
bW15IFNjaG11Y2tlci48L3A+CgoJPHA+VGhhbmtzIHRvIDxhIGhyZWY9Imh0dHA6Ly9tYW5m
cmUubmV0LyI+TWljaGFlbCBNYW5mcmU8L2E+IGZvciBpbnNwaXJhdGlvbiBmb3IgdGhlIGFy
dGljbGUgdHdlZXQgcGFydCBvZiB0aGlzIHBsdWdpbiBiYXNlZCBvbiBoaXMgPHNwYW4gY2xh
c3M9InRhZyI+bWVtX3R3aXR0ZXI8L3NwYW4+IHBsdWdpbi4gIEFkZGl0aW9uYWwgdGhhbmtz
IHRvIHRoZSBncmVhdCBUZXh0cGF0dGVybiBjb21tdW5pdHkgZm9yIGhlbHBpbmcgdG8gdGVz
dCB0aGlzIHBsdWdpbiBhbmQgZm9yIHN1Z2dlc3RpbmcgbmV3IGZlYXR1cmVzLiBUaGUgT0F1
dGggcGFydCBvZiB0aGUgcGx1Z2luIGlzIHRoYW5rcyB0byA8YSBocmVmPSJodHRwOi8vdHdp
dHRlci5jb20vYWJyYWhhbSI+QWJyYWhhbSBXaWxsaWFtczwvYT4uPC9wPgoKCTxoMiBjbGFz
cz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX2luc3RhbGxhdGlvbiI+SW5zdGFsbGF0aW9u
IC8gVW5pbnN0YWxsYXRpb248L2gyPgoKCTxwPlRvIGluc3RhbGwgZ28gdG8gdGhlICYjODIx
NjtwbHVnaW5zJiM4MjE3OyB0YWIgdW5kZXIgJiM4MjE2O2FkbWluJiM4MjE3OyBhbmQgcGFz
dGUgdGhlIHBsdWdpbiBjb2RlIGludG8gdGhlICYjODIxNjtJbnN0YWxsIHBsdWdpbiYjODIx
NzsgYm94LCAmIzgyMTY7dXBsb2FkJiM4MjE3OyBhbmQgdGhlbiAmIzgyMTY7aW5zdGFsbCYj
ODIxNzsuIFRoZSBwbHVnaW4gd2lsbCBiZSBhdXRvbWF0aWNhbGx5IGFjdGl2YXRlZC48L3A+
CgoJPHA+QmVmb3JlIHlvdSBzdGFydCB1c2luZyA8c3BhbiBjbGFzcz0idGFnIj5hcmNfdHdp
dHRlcjwvc3Bhbj4geW91IHdpbGwgbmVlZCB0byBtYWtlIHN1cmUgdGhhdCB0aGUgY2FjaGUg
ZGlyZWN0b3J5IGlzIHdyaXRhYmxlLiBTZWUgdGhlICYjODIxNjtDYWNoaW5nJiM4MjE3OyBz
dWJzZWN0aW9uIGJlbG93IGZvciBmdXJ0aGVyIGluZm9ybWF0aW9uLjwvcD4KCgk8cD48c3Bh
biBjbGFzcz0idGFnIj5hcmNfdHdpdHRlcjwvc3Bhbj4gc2hvdWxkIG5vdyBiZSByZWFkeSBm
b3IgdXNlIG9uIHRoZSBwdWJsaWMtc2lkZSBvZiB5b3VyIHNpdGUuPC9wPgoKCTxwPlRvIHVu
bG9jayB0aGUgYWRtaW4gZmVhdHVyZXMgb2YgdGhpcyBwbHVnaW4geW91IHdpbGwgbmVlZCB0
byBhc3NvY2lhdGUgeW91ciBzaXRlIHdpdGggYSBUd2l0dGVyIGFjY291bnQgYnkgY29ubmVj
dGluZyB0byBUd2l0dGVyIGZyb20gdGhlIHBsdWdpbiYjODIxNztzIG9wdGlvbnMgc2NyZWVu
LiBDbGljayBvbiB0aGUgbGluayB0byBjb25uZWN0IHRvIFR3aXR0ZXIsIHlvdSB3aWxsIGJl
IGFza2VkIHRvIGxvZ2luIHRvIFR3aXR0ZXIsIGNsaWNraW5nIHRoaXMgbGluayB3aWxsIHRl
bXBvcmFyaWx5IHRha2UgeW91IHRvIHRoZSBUd2l0dGVyIHNpdGUgd2hlcmUgeW91IHdpbGwg
YmUgYXNrZWQgdG8gbG9naW4gYW5kIGFwcHJvdmUgYWNjZXNzIGZvciA8c3BhbiBjbGFzcz0i
Y2FwcyI+VFhQPC9zcGFuPiBUd2VldCB0byByZWFkIGFuZCB3cml0ZSB0byB5b3VyIFR3aXR0
ZXIgYWNjb3VudC4gSWYgYWxsIGlzIHN1Y2Nlc3NmdWwgeW91IHdpbGwgYmUgcmV0dXJuZWQg
dG8gdGhlIG9wdGlvbnMgc2NyZWVuIGFuZCB5b3VyIHVzZXIgbmFtZSB3aWxsIGFwcGVhci48
L3A+CgoJPHA+QXQgYW55IHRpbWUgeW91IGNhbiBkaXNhc3NvY2lhdGUgeW91ciBUd2l0dGVy
IGFjY291bnQgd2l0aCA8c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9zcGFuPiBUd2VldCB2aWEg
eW91ciBUd2l0dGVyIGFjY291bnQgcHJlZmVyZW5jZXMgb24gdGhlIDxhIGhyZWY9Imh0dHA6
Ly93d3cudHdpdHRlci5jb20iPlR3aXR0ZXIgd2Vic2l0ZTwvYT4uPC9wPgoKCTxwPlRvIHVu
aW5zdGFsbCA8c3BhbiBjbGFzcz0idGFnIj5hcmNfdHdpdHRlcjwvc3Bhbj4gc2ltcGx5IGRl
bGV0ZSB0aGUgcGx1Z2luIGZyb20gdGhlICYjODIxNjtQbHVnaW5zJiM4MjE3OyB0YWIuICBU
aGlzIHdpbGwgcmVtb3ZlIHRoZSBwbHVnaW4gY29kZSwgZGVsZXRlIHJlbGF0ZWQgcHJlZmVy
ZW5jZXMgYW5kIGRyb3AgdGhlIDxzcGFuIGNsYXNzPSJ0YWciPmFyY190d2l0dGVyPC9zcGFu
PiB0YWJsZSBmcm9tIHlvdXIgVGV4dHBhdHRlcm4gZGF0YWJhc2UuPC9wPgoKCTxoMiBjbGFz
cz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX3RhZyI+VGhlIGFyY190d2l0dGVyIHRhZzwv
aDI+CgoJPGgzPlN5bnRheDwvaDM+CgoJPHA+Jmx0O3R4cDphcmNfdHdpdHRlciB1c2VyPSZx
dW90O2RybW9ua2V5bmluamEmcXVvdDsgLyZndDs8L3A+CgoJPGgzPlVzYWdlPC9oMz4KCgk8
dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0cmlidXRlPC90aD4KCQkJPHRoPkRlc2NyaXB0aW9u
PC90aD4KCQkJPHRoPkRlZmF1bHQ8L3RoPgoJCQk8dGg+RXhhbXBsZTwvdGg+CgkJPC90cj4K
CQk8dHI+CgkJCTx0ZD51c2VyPC90ZD4KCQkJPHRkPlR3aXR0ZXIgdXNlciBuYW1lPC90ZD4K
CQkJPHRkPiA8ZW0+YXJjX3R3aXR0ZXIgdXNlcm5hbWU8L2VtPjwvdGQ+CgkJCTx0ZD51c2Vy
PSZxdW90O2RybW9ua2V5bmluamEmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+
cmV0d2VldHM8L3RkPgoJCQk8dGQ+MSB0byBpbmNsdWRlIHJldHdlZXRzLCAwIHRvIGV4Y2x1
ZGUgdGhlbSBmcm9tIHRoZSBmZWVkPC90ZD4KCQkJPHRkPjA8L3RkPgoJCTwvdHI+CgkJPHRy
PgoJCQk8dGQ+cmVwbGllczwvdGQ+CgkJCTx0ZD4xIHRvIGluY2x1ZGUgcmVwbGllcywgMCB0
byBleGNsdWRlIHRoZW0gZnJvbSB0aGUgZmVlZDwvdGQ+CgkJCTx0ZD4xPC90ZD4KCQk8L3Ry
PgoJCTx0cj4KCQkJPHRkPmxpbWl0PC90ZD4KCQkJPHRkPk1heGltdW0gbnVtYmVyIG9mIHR3
ZWV0cyB0byBkaXNwbGF5IChtYXguIDIwMCk8L3RkPgoJCQk8dGQ+MTA8L3RkPgoJCQk8dGQ+
bGltaXQ9JnF1b3Q7MjUmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+ZmV0Y2g8
L3RkPgoJCQk8dGQ+TWF4aW11bSBudW1iZXIgb2YgdHdlZXRzIHRvIHJldHJpZXZlIGZyb20g
VHdpdHRlciAobWF4LiAyMDApPHN1cCBjbGFzcz0iZm9vdG5vdGUiPjxhIGhyZWY9IiNmbjM1
ODcxNTA0NTUxZDMxZGQzNTM5YjAiPjE8L2E+PC9zdXA+PC90ZD4KCQkJPHRkPjA8L3RkPgoJ
CQk8dGQ+ZmV0Y2g9JnF1b3Q7NTAmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+
ZGF0ZWZvcm1hdDwvdGQ+CgkJCTx0ZD5Gb3JtYXQgdGhhdCB1cGRhdGUgZGF0ZXMgd2lsbCBh
cHBlYXIgYXM8L3RkPgoJCQk8dGQ+IDxlbT5BcmNoaXZlIGRhdGUgZm9ybWF0PC9lbT48L3Rk
PgoJCQk8dGQ+ZGF0ZWZvcm1hdD0mcXVvdDslYiAlT2UsICVJOiVNICVwJnF1b3Q7PC90ZD4K
CQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxhYmVsPC90ZD4KCQkJPHRkPkxhYmVsIGZvciB0aGUg
dG9wIG9mIHRoZSBsaXN0PC90ZD4KCQkJPHRkPiA8ZW0+bm8gbGFiZWw8L2VtPjwvdGQ+CgkJ
CTx0ZD5sYWJlbD0mcXVvdDtNeSBUd2l0dGVyIHRpbWVsaW5lJnF1b3Q7PC90ZD4KCQk8L3Ry
PgoJCTx0cj4KCQkJPHRkPmxhYmVsdGFnPC90ZD4KCQkJPHRkPkluZGVwZW5kZW50IHdyYXB0
YWcgZm9yIGxhYmVsPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJCTx0ZD5s
YWJlbHRhZz0mcXVvdDtoMyZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5icmVh
azwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkhU
TUw8L3NwYW4+PC9zcGFuPiB0YWcgKHdpdGhvdXQgYnJhY2tldHMpLCBvciBzdHJpbmcsIHVz
ZWQgdG8gc2VwYXJhdGUgdGhlIHVwZGF0ZXM8L3RkPgoJCQk8dGQ+bGk8L3RkPgoJCQk8dGQ+
YnJlYWs9JnF1b3Q7YnImcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+d3JhcHRh
ZzwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkhU
TUw8L3NwYW4+PC9zcGFuPiB0YWcgdG8gYmUgdXNlZCBhcyB0aGUgd3JhcHRhZywgd2l0aG91
dCBicmFja2V0czwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8dGQ+d3Jh
cHRhZz0mcXVvdDt1bCZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzczwv
dGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwv
c3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBmb3Igd3JhcHRhZzwvdGQ+CgkJCTx0ZD5h
cmNfdHdpdHRlcjwvdGQ+CgkJCTx0ZD5jbGFzcz0mcXVvdDt0d2l0dGVyJnF1b3Q7PC90ZD4K
CQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNzX3Bvc3RlZDwvdGQ+CgkJCTx0ZD48c3BhbiBj
bGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNz
IGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHNwYW4gdGFnIGFyb3VuZCBwb3N0ZWQgZGF0ZTwvdGQ+
CgkJCTx0ZD5hcmNfdHdpdHRlci1wb3N0ZWQ8L3RkPgoJCTwvdHI+Cgk8L3RhYmxlPgoKCTxw
IGlkPSJmbjM1ODcxNTA0NTUxZDMxZGQzNTM5YjAiIGNsYXNzPSJmb290bm90ZSI+PHN1cD4x
PC9zdXA+IFR3aXR0ZXImIzgyMTc7cyA8c3BhbiBjbGFzcz0iY2FwcyI+QVBJPC9zcGFuPiBj
b3VudHMgdGhlIG51bWJlciBvZiB0d2VldHMgdG8gcmV0dXJuIGJlZm9yZSBhcHBseWluZyBz
b21lIG9mIHRoZSBmaWx0ZXJzLCBzbyB0aGUgcmVzcG9uc2UgY2FuIGJlIGZld2VyIHR3ZWV0
cyB0aGFuIGV4cGVjdGVkLiBUbyBoZWxwIGF2b2lkIHRoaXMgeW91IGNhbiBzZXQgYSA8ZW0+
ZmV0Y2g8L2VtPiBsaW1pdCB0aGF0IGlzIGhpZ2hlciB0aGFuIHRoZSBkaXNwbGF5IDxlbT5s
aW1pdDwvZW0+IHRoYXQgeW91IHdhbnQgdG8gb3V0cHV0LiBJZiA8ZW0+ZmV0Y2g8L2VtPiBp
cyBsZXNzIHRoYW4gPGVtPmxpbWl0PC9lbT4gdGhlIGxhdHRlciB3aWxsIGJlIHVzZWQgaW5z
dGVhZC48L3A+CgoJPGgzPkV4YW1wbGUgdXNhZ2U8L2gzPgoKCTxwPiZsdDt0eHA6YXJjX3R3
aXR0ZXIgdXNlcj0mcXVvdDtkcm1vbmtleW5pbmphJnF1b3Q7IGxpbWl0PSZxdW90OzUmcXVv
dDsgd3JhcHRhZz0mcXVvdDt1bCZxdW90OyBicmVhaz0mcXVvdDtsaSZxdW90OyBkYXRlZm9y
bWF0PSZxdW90OyViICVPZSwgJUk6JU0gJXAmcXVvdDsgLyZndDs8L3A+CgoJPHA+UHJvZHVj
ZXMgYSBidWxsZXQgcG9pbnQgbGlzdCBvZiB0aGUgbGFzdCA1IFR3aXR0ZXIgdXBkYXRlcyBm
cm9tIGRybW9ua2V5bmluamEmIzgyMTc7cyBUd2l0dGVyIGZlZWQgd2l0aCBhIGRlZmluZWQg
ZGF0ZSBmb3JtYXQgdG8gb3ZlcnJpZGUgdGhlIGRlZmF1bHQgYXJjaGl2ZSBkYXRlIGZvcm1h
dC48L3A+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfc2VhcmNoX3Rh
ZyI+VGhlIGFyY190d2l0dGVyX3NlYXJjaCB0YWc8L2gyPgoKCTxoMz5TeW50YXg8L2gzPgoK
CTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJfc2VhcmNoIGhhc2h0YWdzPSZxdW90O3R4cCZxdW90
OyAvJmd0OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5B
dHRyaWJ1dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwv
dGg+CgkJCTx0aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnNlYXJjaDwv
dGQ+CgkJCTx0ZD5Db21tYSBzZXBhcmF0ZWQgbGlzdCBvZiBzZWFyY2ggd29yZHM8L3RkPgoJ
CQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQkJPHRkPnNlYXJjaD0mcXVvdDt0eHAsdGV4
dHBhdHRlcm4mcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+aGFzaHRhZ3M8L3Rk
PgoJCQk8dGQ+Q29tbWEgc2VwYXJhdGVkIGxpc3Qgb2YgaGFzaHRhZ3MgdG8gc2VhcmNoIGZv
ciAobm90IGluY2x1ZGluZyB0aGUgaGFzaCk8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+
PC90ZD4KCQkJPHRkPmhhc2h0YWdzPSZxdW90O3R4cCx0ZXh0cGF0dGVybiZxdW90OzwvdGQ+
CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5yZXBseTwvdGQ+CgkJCTx0ZD5Vc2VybmFtZSBvZiB0
d2VldHMgaW4gcmVwbHkgdG88L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQkJ
PHRkPnJlcGx5PSZxdW90O3R3aXR0ZXImcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8
dGQ+bWVudGlvbjwvdGQ+CgkJCTx0ZD5Vc2VybmFtZSBvZiB1c2VyIG1lbnRpb25lZCBpbiB0
d2VldHMgKDxpPmkuZS48L2k+IHR3ZWV0cyBjb250YWluaW5nIEB1c2VybmFtZSk8L3RkPgoJ
CQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQkJPHRkPm1lbnRpb249JnF1b3Q7dHdpdHRl
ciZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5saW1pdDwvdGQ+CgkJCTx0ZD5N
YXhpbXVtIG51bWJlciBvZiB0d2VldHMgdG8gZGlzcGxheSAobWF4LiAyMDApPC90ZD4KCQkJ
PHRkPjEwPC90ZD4KCQkJPHRkPmxpbWl0PSZxdW90OzI1JnF1b3Q7PC90ZD4KCQk8L3RyPgoJ
CTx0cj4KCQkJPHRkPmRhdGVmb3JtYXQ8L3RkPgoJCQk8dGQ+Rm9ybWF0IHRoYXQgdXBkYXRl
IGRhdGVzIHdpbGwgYXBwZWFyIGFzPC90ZD4KCQkJPHRkPiA8ZW0+QXJjaGl2ZSBkYXRlIGZv
cm1hdDwvZW0+PC90ZD4KCQkJPHRkPmRhdGVmb3JtYXQ9JnF1b3Q7JWIgJU9lLCAlSTolTSAl
cCZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbDwvdGQ+CgkJCTx0ZD5M
YWJlbCBmb3IgdGhlIHRvcCBvZiB0aGUgbGlzdDwvdGQ+CgkJCTx0ZD4gPGVtPm5vIGxhYmVs
PC9lbT48L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGFiZWx0YWc8L3RkPgoJCQk8dGQ+
SW5kZXBlbmRlbnQgd3JhcHRhZyBmb3IgbGFiZWw8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwv
ZW0+PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmJyZWFrPC90ZD4KCQkJPHRkPjxzcGFu
IGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+SFRNTDwvc3Bhbj48L3NwYW4+IHRh
ZyAod2l0aG91dCBicmFja2V0cyksIG9yIHN0cmluZywgdXNlZCB0byBzZXBhcmF0ZSB0aGUg
dXBkYXRlczwvdGQ+CgkJCTx0ZD5saTwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD53cmFw
dGFnPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+
SFRNTDwvc3Bhbj48L3NwYW4+IHRhZyB0byBiZSB1c2VkIGFzIHRoZSB3cmFwdGFnLCB3aXRo
b3V0IGJyYWNrZXRzPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4K
CQk8dHI+CgkJCTx0ZD5jbGFzczwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNw
YW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBmb3Ig
d3JhcHRhZzwvdGQ+CgkJCTx0ZD5hcmNfdHdpdHRlcl9zZWFyY2g8L3RkPgoJCTwvdHI+CgkJ
PHRyPgoJCQk8dGQ+Y2xhc3NfdXNlcjwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+
PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBh
cHBsaWVkIHRvIHNwYW4gdGFnIGFyb3VuZCB1c2VyIG5hbWU8L3RkPgoJCQk8dGQ+YXJjX3R3
aXR0ZXItdXNlcjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzc19wb3N0ZWQ8L3Rk
PgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3Nw
YW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgYXBwbGllZCB0byBzcGFuIHRhZyBhcm91bmQg
cG9zdGVkIGRhdGU8L3RkPgoJCQk8dGQ+YXJjX3R3aXR0ZXItcG9zdGVkPC90ZD4KCQk8L3Ry
PgoJPC90YWJsZT4KCgk8aDM+RXhhbXBsZSB1c2FnZTwvaDM+CgoJPHA+Jmx0O3R4cDphcmNf
dHdpdHRlcl9zZWFyY2ggc2VhcmNoPSZxdW90O3BsdWdpbiZxdW90OyBoYXNodGFncz0mcXVv
dDt0eHAsdGV4dHBhdHRlcm4mcXVvdDsgbGltaXQ9JnF1b3Q7MjUmcXVvdDsgLyZndDs8L3A+
CgoJPHA+UHJvZHVjZXMgYSBsaXN0IG9mIHR3ZWV0cyBjb250YWluaW5nIHRoZSB3b3JkICYj
ODIxNjtwbHVnaW4mIzgyMTc7IGFuZCB0aGUgaGFzaHRhZ3MgJiM4MjE2OyN0eHAmIzgyMTc7
IGFuZCAmIzgyMTY7I3RleHRwYXR0ZXJuJiM4MjE3Oy4gVGhlIHRhZyB3aWxsIHJldHVybiBh
IG1heGltdW0gb2YgMjUgdHdlZXRzLjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJh
cmNfdHdpdHRlcl9yZXR3ZWV0X3RhZyI+VGhlIGFyY190d2l0dGVyX3R3ZWV0X2J1dHRvbiB0
YWc8L2gyPgoKCTxwPk91dHB1dHMgdGhlIFR3aXR0ZXIgdHdlZXQgYnV0dG9uIChmb3JtZXJs
eSAmbHQ7dHhwOmFyY190d2l0dGVyX3JldHdlZXQgLyZndDspLjwvcD4KCgk8aDM+U3ludGF4
PC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyX3R3ZWV0X2J1dHRvbiAvJmd0OzwvcD4K
Cgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8L3Ro
PgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0aD5F
eGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnVzZXI8L3RkPgoJCQk8dGQ+VHdp
dHRlciB1c2VyIG5hbWUgdG8gcXVvdGU8L3RkPgoJCQk8dGQ+IDxlbT5hcmNfdHdpdHRlciB1
c2VybmFtZTwvZW0+PC90ZD4KCQkJPHRkPnVzZXI9JnF1b3Q7ZHJtb25rZXluaW5qYSZxdW90
OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD51cmw8L3RkPgoJCQk8dGQ+PHNwYW4gY2xh
c3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+PC9zcGFuPiB0byB0d2Vl
dDwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD50ZXh0PC90ZD4KCQkJPHRkPlR3ZWV0IHRl
eHQ8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Zm9sbG93MTwvdGQ+CgkJCTx0ZD5TdWdn
ZXN0ZWQgVHdpdHRlciBhY2NvdW50IHRvIGZvbGxvdywgZm9yIGV4YW1wbGUgeW91ciBvd248
L3RkPgoJCQk8dGQ+QSBUd2l0dGVyIHVzZXIgdG8gcmVjb21tZW5kPC90ZD4KCQkJPHRkPmZv
bGxvdzE9JnF1b3Q7VGV4dHBhdHRlcm4mcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8
dGQ+Zm9sbG93MjwvdGQ+CgkJCTx0ZD5BcyBmb2xsb3cxPC90ZD4KCQkJPHRkPiA8ZW0+dW5z
ZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYW5nPC90ZD4KCQkJPHRkPkxh
bmd1YWdlPC90ZD4KCQkJPHRkPmVuPC90ZD4KCQkJPHRkPmxhbmc9JnF1b3Q7ZXMmcXVvdDs8
L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y291bnQ8L3RkPgoJCQk8dGQ+Q291bnQgYm94
IHBvc2l0aW9uLCBvcHRpb25zOiBub25lLCBob3Jpem9udGFsIG9yIHZlcnRpY2FsPC90ZD4K
CQkJPHRkPmhvcml6b250YWw8L3RkPgoJCQk8dGQ+Y291bnQ9JnF1b3Q7bm9uZSZxdW90Ozwv
dGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5pbmNsdWRlX2pzPC90ZD4KCQkJPHRkPldoZXRo
ZXIgb3Igbm90IHRvIGluY2x1ZGUgdGhlIHdpZGdldCBKYXZhU2NyaXB0PC90ZD4KCQkJPHRk
PjE8L3RkPgoJCQk8dGQ+aW5jbHVkZV9qcz0mcXVvdDswJnF1b3Q7PC90ZD4KCQk8L3RyPgoJ
CTx0cj4KCQkJPHRkPm9wdGltaXNlX2pzPC90ZD4KCQkJPHRkPk9wdGltaXNlIHRoZSBKYXZh
U2NyaXB0IGJ5IHVzaW5nIGEgbG9jYWwgc2NyaXB0IHJhdGhlciB0aGFuIHRoYXQgaG9zdGVk
IG9uIHRoZSBUd2l0dGVyIHNpdGU8L3RkPgoJCQk8dGQ+MDwvdGQ+CgkJCTx0ZD5vcHRpbWlz
ZV9qcz0mcXVvdDsxJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNzPC90
ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9z
cGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGFwcGxpZWQgdG8gdGhlIHR3ZWV0IGJ1dHRv
bjwvdGQ+CgkJCTx0ZD50d2l0dGVyLXNoYXJlLWJ1dHRvbjwvdGQ+CgkJPC90cj4KCTwvdGFi
bGU+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfZm9sbG93X2J1dHRv
bl90YWciPlRoZSBhcmNfdHdpdHRlcl9mb2xsb3dfYnV0dG9uIHRhZzwvaDI+CgoJPHA+T3V0
cHV0cyB0aGUgVHdpdHRlciBmb2xsb3cgYnV0dG9uIChhbiBhbHRlcm5hdGl2ZSB2ZXJzaW9u
IGlzIGluY2x1ZGVkIGluIGFyY190d2l0dGVyX2ludGVudHMpLjwvcD4KCgk8aDM+U3ludGF4
PC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyX2ZvbGxvd19idXR0b24gLyZndDs8L3A+
CgoJPGgzPlVzYWdlPC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0cmlidXRlPC90
aD4KCQkJPHRoPkRlc2NyaXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8L3RoPgoJCQk8dGg+
RXhhbXBsZTwvdGg+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD51c2VyPC90ZD4KCQkJPHRkPlR3
aXR0ZXIgdXNlciBuYW1lIHRvIGZvbGxvdzwvdGQ+CgkJCTx0ZD4gPGVtPmFyY190d2l0dGVy
IHVzZXJuYW1lPC9lbT48L3RkPgoJCQk8dGQ+dXNlcj0mcXVvdDtkcm1vbmtleW5pbmphJnF1
b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxhbmc8L3RkPgoJCQk8dGQ+TGFuZ3Vh
Z2U8L3RkPgoJCQk8dGQ+ZW48L3RkPgoJCQk8dGQ+bGFuZz0mcXVvdDtlcyZxdW90OzwvdGQ+
CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jb3VudDwvdGQ+CgkJCTx0ZD5XaGV0aGVyIG9yIG5v
dCB0aGUgZm9sbG93ZXIgY291bnQgaXMgc2hvd248L3RkPgoJCQk8dGQ+MTwvdGQ+CgkJCTx0
ZD5jb3VudD0mcXVvdDswJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmluY2x1
ZGVfanM8L3RkPgoJCQk8dGQ+V2hldGhlciBvciBub3QgdG8gaW5jbHVkZSB0aGUgd2lkZ2V0
IEphdmFTY3JpcHQ8L3RkPgoJCQk8dGQ+MTwvdGQ+CgkJCTx0ZD5pbmNsdWRlX2pzPSZxdW90
OzAmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+b3B0aW1pc2VfanM8L3RkPgoJ
CQk8dGQ+T3B0aW1pc2UgdGhlIEphdmFTY3JpcHQgYnkgdXNpbmcgYSBsb2NhbCBzY3JpcHQg
cmF0aGVyIHRoYW4gdGhhdCBob3N0ZWQgb24gdGhlIFR3aXR0ZXIgc2l0ZTwvdGQ+CgkJCTx0
ZD4wPC90ZD4KCQkJPHRkPm9wdGltaXNlX2pzPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+
CgkJPHRyPgoJCQk8dGQ+Y2xhc3M8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxz
cGFuIGNsYXNzPSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgYXBw
bGllZCB0byB0aGUgZm9sbG93IGJ1dHRvbjwvdGQ+CgkJCTx0ZD50d2l0dGVyLWZvbGxvdy1i
dXR0b248L3RkPgoJCTwvdHI+Cgk8L3RhYmxlPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9
ImFyY190d2l0dGVyX3R3ZWV0X3VybCI+YXJjX3R3aXR0ZXJfdHdlZXRfdXJsPC9oMj4KCgk8
cD5SZXR1cm5zIHRoZSA8c3BhbiBjbGFzcz0iY2FwcyI+VVJMPC9zcGFuPiBvZiB0aGUgVHdp
dHRlciBzdGF0dXMgZm9yIGFuIGFydGljbGUuPC9wPgoKCTxoMz5TeW50YXg8L2gzPgoKCTxw
PiZsdDt0eHA6YXJjX3R3aXR0ZXJfdHdlZXRfdXJsIC8mZ3Q7PC9wPgoKCTxwPiZsdDt0eHA6
YXJjX3R3aXR0ZXJfdHdlZXRfdXJsJmd0O0xpbmsgdGV4dCZsdDsvdHhwOmFyY190d2l0dGVy
X3R3ZWV0X3VybCZndDs8L3A+CgoJPGgzPlVzYWdlPC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJ
CQk8dGg+QXR0cmlidXRlPC90aD4KCQkJPHRoPkRlc2NyaXB0aW9uPC90aD4KCQkJPHRoPkRl
ZmF1bHQ8L3RoPgoJCQk8dGg+RXhhbXBsZTwvdGg+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5p
ZDwvdGQ+CgkJCTx0ZD5UZXh0cGF0dGVybiBhcnRpY2xlIElEPC90ZD4KCQkJPHRkPiA8ZW0+
Y3VycmVudCBhcnRpY2xlPC9lbT48L3RkPgoJCQk8dGQ+aWQ9JnF1b3Q7MSZxdW90OzwvdGQ+
CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD50aXRsZTwvdGQ+CgkJCTx0ZD5UaXRsZSBhdHRyaWJ1
dGUgb2YgdGhlIGxpbms8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3Ry
PgoJCTx0cj4KCQkJPHRkPmNsYXNzPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48
c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGFw
cGxpZWQgdG8gdGhlIGxpbms8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8
L3RyPgoJPC90YWJsZT4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl90
aW55dXJsIj5hcmNfdHdpdHRlcl90aW55dXJsPC9oMj4KCgk8cD5SZXR1cm5zIHRoZSBzaG9y
dGVuZWQgPHNwYW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj4gb2YgdGhlIGFydGljbGUgdXNl
ZCBmb3IgdGhlIFR3aXR0ZXIgdXBkYXRlLjwvcD4KCgk8aDM+U3ludGF4PC9oMz4KCgk8cD4m
bHQ7dHhwOmFyY190d2l0dGVyX3Rpbnl1cmwgLyZndDs8L3A+CgoJPHA+Jmx0O3R4cDphcmNf
dHdpdHRlcl90aW55dXJsJmd0O0xpbmsgdGV4dCZsdDsvdHhwOmFyY190d2l0dGVyX3Rpbnl1
cmwmZ3Q7PC9wPgoKCTxoMz5Vc2FnZTwvaDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0
dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90
aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+aWQ8L3RkPgoJ
CQk8dGQ+VGV4dHBhdHRlcm4gYXJ0aWNsZSBJRDwvdGQ+CgkJCTx0ZD4gPGVtPmN1cnJlbnQg
YXJ0aWNsZTwvZW0+PC90ZD4KCQkJPHRkPmlkPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+
CgkJPHRyPgoJCQk8dGQ+dGl0bGU8L3RkPgoJCQk8dGQ+VGl0bGUgYXR0cmlidXRlIG9mIHRo
ZSBsaW5rPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+
CgkJCTx0ZD5jbGFzczwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xh
c3M9ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRv
IHRoZSBsaW5rPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCTwv
dGFibGU+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfY2FjaGluZyI+
Q2FjaGluZzwvaDI+CgoJPHA+SW4gb3JkZXIgdG8gcHJldmVudCBleGNlc3NpdmUgcmVwZWF0
aXRpdmUgY2FsbHMgdG8gdGhlIFR3aXR0ZXIgd2Vic2l0ZSBpdCBpcyByZWNvbW1lbmRlZCB0
byBjYWNoZSByZXN1bHRzLiBUd2l0dGVyIGxpbWl0cyB0aGUgbnVtYmVyIG9mIGNhbGxzIHRo
cm91Z2ggdGhlIDxzcGFuIGNsYXNzPSJjYXBzIj5BUEk8L3NwYW4+LCBhbmQgY29udGludW91
cyBjYWxscyB3aWxsIHJlc3VsdCBpbiBUd2l0dGVyIGNsb3NpbmcgdG8gZnVydGhlciByZXF1
ZXN0cy4gQnkgZGVmYXVsdCwgYXJjX3R3aXR0ZXIgY2FjaGVzIGZvciAzMCBtaW51dGUgaW50
ZXJ2YWxzLjwvcD4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0cmlidXRlPC90aD4KCQkJ
PHRoPkRlc2NyaXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8L3RoPgoJCQk8dGg+RXhhbXBs
ZTwvdGg+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jYWNoaW5nPC90ZD4KCQkJPHRkPiYjODIx
NjsxJiM4MjE3OyB0byBjYWNoZSBmZWVkLCAmIzgyMTY7MCYjODIxNzsgdG8gdHVybiBjYWNo
aW5nIG9mZiAobm90IHJlY29tbWVuZGVkKTwvdGQ+CgkJCTx0ZD4xPC90ZD4KCQkJPHRkPmNh
Y2hpbmc9JnF1b3Q7MSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jYWNoZV9k
aXI8L3RkPgoJCQk8dGQ+QWJzb2x1dGUgcGF0aCB0byB0aGUgY2FjaGUgZGlyZWN0b3J5ICht
dXN0IGJlIHdyaXRhYmxlKTwvdGQ+CgkJCTx0ZD4gPGVtPmFyY190d2l0dGVyIHByZWZlcmVu
Y2VzPC9lbT48L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2FjaGVfdGltZTwvdGQ+CgkJ
CTx0ZD5UaW1lIGluIG1pbnV0ZXMgdGhhdCB0aGUgY2FjaGUgZmlsZXMgYXJlIHN0b3JlZCBi
ZWZvcmUgYmVpbmcgcmVmcmVzaGVkPC90ZD4KCQkJPHRkPjU8L3RkPgoJCQk8dGQ+Y2FjaGVf
dGltZT0mcXVvdDszMCZxdW90OzwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJPHA+VGhlIGFk
bWluIHNpZGUgb2YgdGhpcyBwbHVnaW4gZW5mb3JjZXMgY2FjaGluZywgYXBhcnQgZnJvbSB3
aGVuIGl0IGlzIHBvc3RpbmcgdG8gVHdpdHRlciAoPGk+ZS5nLjwvaT4gd2hlbiBwb3N0aW5n
IG9yIGRlbGV0aW5nIGFuIHVwZGF0ZSkuPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9
ImFyY190d2l0dGVyX3ByZWZzIj5QcmVmZXJlbmNlczwvaDI+CgoJPHA+WW91IGNhbiBhY2Nl
c3MgdGhlIHBsdWdpbnMgY29yZSBwcmVmZXJlbmNlcyBmcm9tIGVpdGhlciB0aGUgUHJlZmVy
ZW5jZXMgb3IgUGx1Z2lucyB0YWJzIGluIGFkbWluLiBTZXR1cCB5b3VyIFR3aXR0ZXIgYWNj
b3VudCAoeW91IHdpbGwgYmUgYXNrZWQgdG8gY29ubmVjdCB2aWEgVHdpdHRlciBhbmQgdGhp
cyBuZWVkcyBkb2luZyBiZWZvcmUgeW91IGNhbiB1c2UgdGhlIHBsdWdpbikgYW5kIGNoYW5n
ZSB0aGUgY2FjaGUgZGlyZWN0b3J5IHVzaW5nIGFyY190d2l0dGVyJiM4MjE3O3MgcHJlZmVy
ZW5jZXMuIFdpdGhvdXQgcHJvdmlkaW5nIHlvdXIgYWNjb3VudCBsb2dpbiBkZXRhaWxzIHRo
ZSBhZG1pbiBhcmVhIGZlYXR1cmVzIG9mIHRoaXMgcGx1Z2luIHdpbGwgYmUgaW5hY3RpdmUu
PC9wPgoKCTxwPllvdSBjYW4gc2VsZWN0IHRoZSA8c3BhbiBjbGFzcz0iY2FwcyI+VVJMPC9z
cGFuPiBzaG9ydGVuZXIgbWV0aG9kIHlvdSB3YW50IHRvIHVzZSB0byBsaW5rIGJhY2sgdG8g
eW91ciBhcnRpY2xlIG9uIFR3aXR0ZXIuIFBsZWFzZSBub3RlIHRoYXQgaWYgeW91IHNlbGVj
dCBzbWRfc2hvcnRfdXJsIHlvdSB3aWxsIG5lZWQgdG8gaGF2ZSBpbnN0YWxsZWQgYW5kIGFj
dGl2YXRlZCB0aGUgPGEgaHJlZj0iaHR0cDovL3RleHRwYXR0ZXJuLm9yZy9wbHVnaW5zLzEw
OTkvc21kX3Nob3J0X3VybCI+PHNwYW4gY2xhc3M9InRhZyI+c21kX3Nob3J0X3VybDwvc3Bh
bj4gcGx1Z2luPC9hPiBkZXZlbG9wZWQgYnkgU3RlZiBEYXdzb24uPC9wPgoKCTxoMiBjbGFz
cz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX2FydGljbGUiPlR3ZWV0aW5nIGFydGljbGVz
PC9oMj4KCgk8cD5CeSBkZWZhdWx0IGFyY190d2l0dGVyIHdpbGwgcG9zdCBhbiB1cGRhdGUg
dG8gVHdpdHRlciBpbmNsdWRpbmcgYSBzaG9ydGVuZWQgPHNwYW4gY2xhc3M9ImNhcHMiPlVS
TDwvc3Bhbj4gdG8geW91ciBhcnRpY2xlLiBPbmx5IGxpdmUgYW5kIGFjdGl2ZSBhcnRpY2xl
cyB3aWxsIGJlIHNlbnQgdG8gVHdpdHRlciwgPGk+aS5lLjwvaT4gYXJ0aWNsZXMgcG9zdGVk
IGluIHRoZSBmdXR1cmUgb3IgYXMgc3RpY2t5IGFydGljbGVzIHdpbGwgbm90IGJlIHNlbnQu
IElmIHlvdXIgYXJ0aWNsZSBpcyBzdWNjZXNzZnVsbHkgc3VibWl0dGVkIHRvIFR3aXR0ZXIg
dGhlIHVwZGF0ZSB3aWxsIGFwcGVhciBpbiBwbGFjZSBvZiB0aGUgVHdpdHRlciBvcHRpb24g
b24gdGhlIHJpZ2h0LWhhbmQtc2lkZSBvZiB0aGUgYXJ0aWNsZSBlZGl0IHNjcmVlbi48L3A+
CgoJPHA+VHdlZXRzIGFyZSBzZW50IGluIHRoZSBmb2xsb3dpbmcgZm9ybWF0OiA8ZW0+VHdl
ZXQgcHJlZml4PC9lbT4gPGVtPkFydGljbGUgdGl0bGU8L2VtPiA8ZW0+U2hvcnRlbmVkIDxz
cGFuIGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+PC9lbT4gPGVtPlR3ZWV0IHN1ZmZpeDwvZW0+
LiBZb3UgY2FuIGNoYW5nZSB0aGUgcHJlZml4IGFuZCBzdWZmaXggb24gYW4gYXJ0aWNsZS1i
eS1hcnRpY2xlIGJhc2lzIGJ5IGNoYW5naW5nIHRoZSB0d2VldCBvcHRpb25zIHVuZGVyICYj
ODIxNjtVcGRhdGUgVHdpdHRlciYjODIxNzsgb24gdGhlIGFydGljbGUgZWRpdG9yIHNjcmVl
bi4gVGhlIGRlZmF1bHQgPGVtPlR3ZWV0IHByZWZpeDwvZW0+IGNhbiBiZSBzZXQgdW5kZXIg
dGhlIDxzcGFuIGNsYXNzPSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiBwcmVmZXJlbmNlcyBz
Y3JlZW4gKHRoZSBkZWZhdWx0IG9uIGluc3RhbGxhdGlvbiBpcyAmIzgyMjA7SnVzdCBwb3N0
ZWQ6JiM4MjIxOykuPC9wPgoKCTxwPlBsZWFzZSBub3RlIHRoYXQgb25jZSBhbiBhcnRpY2xl
IGhhcyBiZWVuIHR3ZWV0ZWQgdGhlIHR3ZWV0IGNhbm5vdCBiZSBlZGl0ZWQuPC9wPgoKCTxo
MiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX2FkbWluIj5UaGUgVHdpdHRlciB0
YWI8L2gyPgoKCTxwPlVuZGVyIHRoZSBFeHRlbnNpb25zIHRhYiAodGhpcyBjYW4gYmUgY2hh
bmdlZCBmcm9tIHRoZSBwbHVnaW4mIzgyMTc7cyBwcmVmZXJlbmNlIHBhZ2UpIGEgbmV3IFR3
aXR0ZXIgdGFiIHNob3VsZCBhcHBlYXIgb25jZSB5b3UgaGF2ZSBjb25uZWN0ZWQgeW91ciBz
aXRlIHRvIHlvdXIgVHdpdHRlciBhY2NvdW50LiBGcm9tIGhlcmUgeW91IHdpbGwgYmUgYWJs
ZSB0byBzdWJtaXQgbmV3IFR3aXR0ZXIgdXBkYXRlcywgdmlldyBiYXNpYyBhY2NvdW50IHN0
YXRpc3RpY3MsIGFuZCBjaGVjayBvdXQgeW91ciByZWNlbnQgdXBkYXRlcyAoaW5jbHVkaW5n
IHRoZSBvcHRpb24gdG8gZGVsZXRlIHlvdXIgdHdlZXRzKS48L3A+IjtzOjQ6ImNvZGUiO3M6
NzY5ODM6Imdsb2JhbCAkcHJlZnMsJHR4cGNmZywkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXks
JGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKJGFyY190d2l0dGVyID0gYXJyYXkoKTsK
CiRhcmNfdHdpdHRlcl9jb25zdW1lcktleSA9ICduS2NYc2x3elpoQmQwa2ZLTWV0blBBJzsK
JGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0ID0gJ0M2blNQQ0wzZWVIR1RCaEtDZ3dkOW9j
bGN1RDBzckI4V1ZrZlhRWUM1NCc7CgphZGRfcHJpdnMoJ3BsdWdpbl9wcmVmcy5hcmNfdHdp
dHRlcicsJzEsMicpOwpyZWdpc3Rlcl9jYWxsYmFjaygnYXJjX3R3aXR0ZXJfaW5zdGFsbCcs
J3BsdWdpbl9saWZlY3ljbGUuYXJjX3R3aXR0ZXInLCAnaW5zdGFsbGVkJyk7CnJlZ2lzdGVy
X2NhbGxiYWNrKCdhcmNfdHdpdHRlcl91bmluc3RhbGwnLCdwbHVnaW5fbGlmZWN5Y2xlLmFy
Y190d2l0dGVyJywgJ2RlbGV0ZWQnKTsKcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY190d2l0dGVy
X3ByZWZzJywncGx1Z2luX3ByZWZzLmFyY190d2l0dGVyJyk7CgovKgogKiBTZXR1cCBpbml0
aWFsIHByZWZlcmVuY2VzIGlmIG5vdCBpbiB0aGUgdHhwX3ByZWZzIHRhYmxlLgogKi8KaWYg
KCFpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSkpCiAgICBzZXRfcHJlZignYXJj
X3R3aXR0ZXJfdXNlcicsICcnLCAnYXJjX3R3aXR0ZXInLCAxLCAndGV4dF9pbnB1dCcpOwpp
ZiAoIWlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfcHJlZml4J10pKQogIHNldF9wcmVmKCdh
cmNfdHdpdHRlcl9wcmVmaXgnLCdKdXN0IHBvc3RlZDonLCAnYXJjX3R3aXR0ZXInLCAyLCAn
dGV4dF9pbnB1dCcpOwppZiAoIWlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfc3VmZml4J10p
KQogIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9zdWZmaXgnLCcnLCAnYXJjX3R3aXR0ZXInLCAy
LCAndGV4dF9pbnB1dCcpOwppZiAoIWlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfY2FjaGVf
ZGlyJ10pKQogIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9jYWNoZV9kaXInLCR0eHBjZmdbJ3R4
cGF0aCddLiRwcmVmc1sndGVtcGRpciddLCAnYXJjX3R3aXR0ZXInLCAxLCAndGV4dF9pbnB1
dCcpOwppZiAoIWlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCddKSkK
ICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCcsIDEsICdhcmNfdHdpdHRl
cicsIDIsICd5ZXNub1JhZGlvJyk7CmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl91
cmxfbWV0aG9kJ10pKQogIHNldF9wcmVmKCdhcmNfdHdpdHRlcl91cmxfbWV0aG9kJywgJ3Rp
bnl1cmwnLCAnYXJjX3R3aXR0ZXInLCAyLAogICAgJ2FyY190d2l0dGVyX3VybF9tZXRob2Rf
c2VsZWN0Jyk7CmlmICghaXNzZXQoJHByZWZzWydhcmNfc2hvcnRfdXJsJ10pKQogIHNldF9w
cmVmKCdhcmNfc2hvcnRfdXJsJywgMCwgJ2FyY190d2l0dGVyJywgMiwgJ3llc25vUmFkaW8n
KTsKaWYgKCFpc3NldCgkcHJlZnNbJ2FyY19zaG9ydF9zaXRlX3VybCddKSkKICBzZXRfcHJl
ZignYXJjX3Nob3J0X3NpdGVfdXJsJywgJHByZWZzWydzaXRldXJsJ10sICdhcmNfdHdpdHRl
cicsIDIsICd0ZXh0X2lucHV0Jyk7Ci8vIE1ha2Ugc3VyZSB0aGF0IHRoZSBUd2l0dGVyIHRh
YiBoYXMgYmVlbiBkZWZpbmVkCmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl90YWIn
XSkpIHsKICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfdGFiJywgJ2V4dGVuc2lvbnMnLCAnYXJj
X3R3aXR0ZXInLCAyLAogICAgJ2FyY190d2l0dGVyX3RhYl9zZWxlY3QnKTsKICAgICRwcmVm
c1snYXJjX3R3aXR0ZXJfdGFiJ10gPSAnZXh0ZW5zaW9ucyc7Cn0KCi8vIENoZWNrIGlmIGFy
Y19zaG9ydF91cmwgaXMgZW5hYmxlZAppZiAoKGlzc2V0KCRwcmVmc1snYXJjX3Nob3J0X3Vy
bCddKSYmJHByZWZzWydhcmNfc2hvcnRfdXJsJ10pCnx8IChpc3NldCgkcHJlZnNbJ2FyY19z
aG9ydF91cmxfbWV0aG9kJ10pJiYkcHJlZnNbJ2FyY190d2l0dGVyX3VybF9tZXRob2QnXT09
J2FyY190d2l0dGVyJykpIHsKICByZWdpc3Rlcl9jYWxsYmFjaygnYXJjX3Nob3J0X3VybF9y
ZWRpcmVjdCcsICd0eHBfZGllJywgNDA0KTsKfQoKaWYgKEB0eHBpbnRlcmZhY2UgPT0gJ2Fk
bWluJykgewogICAgcmVnaXN0ZXJfY2FsbGJhY2soJ19hcmNfdHdpdHRlcl9hdXRvX2VuYWJs
ZScsICdwbHVnaW5fbGlmZWN5Y2xlLmFyY190d2l0dGVyJywgJ2luc3RhbGxlZCcpOwogICAg
aWYgKCFlbXB0eSgkcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSkKICAgICAgICAmJiAhZW1w
dHkoJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlbiddKQogICAgICAgICYmICFlbXB0
eSgkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuU2VjcmV0J10pICkgewoKICAgICAg
ICBpZiAoJHByZWZzWydhcmNfdHdpdHRlcl90YWInXSkgewogICAgICAgICAgICBhZGRfcHJp
dnMoJ2FyY19hZG1pbl90d2l0dGVyJywgJzEsMiwzLDQnKTsKICAgICAgICAgICAgcmVnaXN0
ZXJfdGFiKCRwcmVmc1snYXJjX3R3aXR0ZXJfdGFiJ10sICdhcmNfYWRtaW5fdHdpdHRlcics
ICdUd2l0dGVyJyk7CiAgICAgICAgICAgIHJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfYWRtaW5f
dHdpdHRlcicsICdhcmNfYWRtaW5fdHdpdHRlcicpOwogICAgICAgIH0KCiAgICAgICAgcmVn
aXN0ZXJfY2FsbGJhY2soJ2FyY19hcnRpY2xlX3R3ZWV0JywgJ3BpbmcnKTsKICAgICAgICBy
ZWdpc3Rlcl9jYWxsYmFjaygnYXJjX2FydGljbGVfdHdlZXQnLCAnYXJ0aWNsZV9zYXZlZCcp
OwogICAgICAgIHJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfYXJ0aWNsZV90d2VldCcsICdhcnRp
Y2xlX3Bvc3RlZCcpOwogICAgICAgIHJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfYXBwZW5kX3R3
aXR0ZXInLCAnYXJ0aWNsZV91aScsICdzdGF0dXMnKTsKICAgIH0KfQoKLyoKICAgIFB1Ymxp
Yy1zaWRlIGZ1bmN0aW9ucwogICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoqLwoKZnVuY3Rpb24gYXJjX3R3aXR0
ZXIoJGF0dHMpCnsKICBnbG9iYWwgJHByZWZzLCRhcmNfdHdpdHRlcl9jb25zdW1lcktleSwg
JGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKICBleHRyYWN0KGxBdHRzKGFycmF5KAog
ICAgJ3VzZXInICAgICAgPT4gJHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10sCiAgICAncGFz
c3dvcmQnICA9PiAnJywKICAgICd0aW1lbGluZScgID0+ICd1c2VyJywKICAgICdsaW1pdCcg
ICAgID0+ICcxMCcsCiAgICAnZmV0Y2gnICAgICA9PiAwLAogICAgJ3JldHdlZXRzJyAgPT4g
ZmFsc2UsCiAgICAncmVwbGllcycgICA9PiB0cnVlLAogICAgJ2RhdGVmb3JtYXQnPT4gJHBy
ZWZzWydhcmNoaXZlX2RhdGVmb3JtYXQnXSwKICAgICdjYWNoaW5nJyAgID0+ICcxJywKICAg
ICdjYWNoZV9kaXInID0+ICRwcmVmc1snYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJ10sCiAgICAn
Y2FjaGVfdGltZSc9PiAnNScsCiAgICAnbGFiZWwnICAgICA9PiAnJywKICAgICdsYWJlbHRh
ZycgID0+ICcnLAogICAgJ2JyZWFrJyAgICAgPT4gJ2xpJywKICAgICd3cmFwdGFnJyAgID0+
ICcnLAogICAgJ2NsYXNzJyAgICAgPT4gX19GVU5DVElPTl9fLAogICAgJ2NsYXNzX3Bvc3Rl
ZCcgPT4gX19GVU5DVElPTl9fLictcG9zdGVkJwogICAgKSwkYXR0cykpOwoKICAkdHdpdCA9
IG5ldyBhcmNfdHdpdHRlcigkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAg
LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNj
ZXNzVG9rZW4nXQogICAgICAgICAgICAsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9r
ZW5TZWNyZXQnXSk7CgogIGlmICgkY2FjaGluZykgeyAgLy8gdHVybiBvbiBjYWNoaW5nLCBy
ZWNvbW1lbmRlZCAoZGVmYXVsdCkKICAgICR0d2l0LT5zZXRDYWNoaW5nKHRydWUpOwogICAg
JHR3aXQtPmNhY2hlRGlyKCRjYWNoZV9kaXIpOwogICAgJHR3aXQtPmNhY2hlVGltZSgkY2Fj
aGVfdGltZSk7CiAgfSBlbHNlIHsgIC8vIHR1cm4gb2ZmIGNhY2hpbmcsIG5vdCByZWNvbW1l
bmRlZCBvdGhlciB0aGFuIGZvciB0ZXN0aW5nCiAgICAkdHdpdC0+c2V0Q2FjaGluZyhmYWxz
ZSk7CiAgfQoKICBzd2l0Y2ggKCR0aW1lbGluZSkgewogICAgY2FzZSAnaG9tZSc6IGNhc2Ug
J2ZyaWVuZHMnOgogICAgICAkdGltZWxpbmUgPSAnc3RhdHVzZXMvZnJpZW5kc190aW1lbGlu
ZSc7IGJyZWFrOwogICAgY2FzZSAnbWVudGlvbnMnOgogICAgICAkdGltZWxpbmUgPSAnc3Rh
dHVzZXMvbWVudGlvbnMnOyBicmVhazsKICAgIGNhc2UgJ3VzZXInOiBkZWZhdWx0OiAkdGlt
ZWxpbmUgPSAnc3RhdHVzZXMvdXNlcl90aW1lbGluZSc7CiAgfQoKICAvLyBDaGVjayB0aGF0
IHRoZSBmZXRjaCAoVHdpdHRlcidzIGNvdW50IGF0dHJpYnV0ZSkgaXMgc2V0IGNvcnJlY3Rs
eQogICRmZXRjaCA9ICghJGZldGNoIHx8ICRmZXRjaDwkbGltaXQpID8gJGxpbWl0IDogJGZl
dGNoOwoKICAkb3V0ID0gYXJyYXkoKTsKICAkdHdlZXRzID0gJHR3aXQtPmdldCgkdGltZWxp
bmUsIGFycmF5KAogICAgICAnc2NyZWVuX25hbWUnPT4kdXNlciwKICAgICAgJ2NvdW50Jz0+
JGZldGNoLAogICAgICAnaW5jbHVkZV9ydHMnPT4kcmV0d2VldHMsCiAgICAgICdleGNsdWRl
X3JlcGxpZXMnPT4hJHJlcGxpZXMKICAgICkpOwoKICBpZiAoJHR3ZWV0cykgewogICAgLy8g
QXBwbHkgdGhlIGRpc3BsYXkgbGltaXQgdG8gdGhlIHJldHVybmVkIHR3ZWV0cwogICAgJHR3
ZWV0cyA9IGFycmF5X3NsaWNlKCR0d2VldHMsIDAsICRsaW1pdCk7CiAgICBmb3JlYWNoICgk
dHdlZXRzIGFzICR0d2VldCkgewogICAgICAkdGltZSA9IHN0cnRvdGltZShodG1sZW50aXRp
ZXMoJHR3ZWV0LT5jcmVhdGVkX2F0KSk7CiAgICAgICRkYXRlID0gc2FmZV9zdHJmdGltZSgk
ZGF0ZWZvcm1hdCwkdGltZSk7CiAgICAgICRvdXRbXSA9IGFyY19Ud2l0dGVyOjptYWtlTGlu
a3MoaHRtbGVudGl0aWVzKCR0d2VldC0+dGV4dCwgRU5UX1FVT1RFUywnVVRGLTgnKSkKICAg
ICAgICAuJyAnLnRhZyhodG1sZW50aXRpZXMoJGRhdGUpLCdzcGFuJywnIGNsYXNzPSInLiRj
bGFzc19wb3N0ZWQuJyInKTsKICAgIH0KICB9CgogICAgcmV0dXJuIGRvTGFiZWwoJGxhYmVs
LCAkbGFiZWx0YWcpLmRvV3JhcCgkb3V0LCAkd3JhcHRhZywgJGJyZWFrLCAkY2xhc3MpOwoK
fQoKZnVuY3Rpb24gYXJjX3R3aXR0ZXJfc2VhcmNoKCRhdHRzKQp7CiAgICBnbG9iYWwgJHBy
ZWZzLCRhcmNfdHdpdHRlcl9jb25zdW1lcktleSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2Vj
cmV0OwoKICAgIGV4dHJhY3QobEF0dHMoYXJyYXkoCiAgICAgICAgJ3VzZXInICAgICAgPT4g
JHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10sCiAgICAgICAgJ3NlYXJjaCcgICAgPT4gJycs
CiAgICAgICAgJ2hhc2h0YWdzJyAgPT4gJycsCiAgICAgICAgJ3VzZXInICAgICAgPT4gJycs
CiAgICAgICAgJ3JlcGx5JyAgICAgPT4gJycsCiAgICAgICAgJ21lbnRpb24nICAgPT4gJycs
CiAgICAgICAgJ2xpbWl0JyAgICAgPT4gJzEwJywKICAgICAgICAnbGFuZycgICAgICA9PiAn
JywKICAgICAgICAnZGF0ZWZvcm1hdCc9PiAkcHJlZnNbJ2FyY2hpdmVfZGF0ZWZvcm1hdCdd
LAogICAgICAgICdjYWNoaW5nJyAgID0+ICcxJywKICAgICAgICAnY2FjaGVfZGlyJyA9PiAk
cHJlZnNbJ2FyY190d2l0dGVyX2NhY2hlX2RpciddLAogICAgICAgICdjYWNoZV90aW1lJz0+
ICc1JywKICAgICAgICAnbGFiZWwnICAgICA9PiAnJywKICAgICAgICAnbGFiZWx0YWcnICA9
PiAnJywKICAgICAgICAnYnJlYWsnICAgICA9PiAnbGknLAogICAgICAgICd3cmFwdGFnJyAg
ID0+ICcnLAogICAgICAgICdjbGFzcycgICAgID0+IF9fRlVOQ1RJT05fXywKICAgICAgICAn
Y2xhc3NfcG9zdGVkJyA9PiBfX0ZVTkNUSU9OX18uJy1wb3N0ZWQnLAogICAgICAgICdjbGFz
c191c2VyJyAgID0+IF9fRlVOQ1RJT05fXy4nLXVzZXInCiAgICApLCRhdHRzKSk7CgogICAg
ICAgICR0d2l0ID0gbmV3IGFyY190d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQog
ICAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQsICRwcmVmc1snYXJjX3R3
aXR0ZXJfYWNjZXNzVG9rZW4nXQogICAgICAgICAgLCAkcHJlZnNbJ2FyY190d2l0dGVyX2Fj
Y2Vzc1Rva2VuU2VjcmV0J10pOwoKICAgICAgICBpZiAoJGNhY2hpbmcpIHsgIC8vIHR1cm4g
b24gY2FjaGluZywgcmVjb21tZW5kZWQgKGRlZmF1bHQpCiAgICAgICAgICAgICR0d2l0LT5z
ZXRDYWNoaW5nKHRydWUpOwogICAgICAgICAgICAkdHdpdC0+Y2FjaGVEaXIoJGNhY2hlX2Rp
cik7CiAgICAgICAgICAgICR0d2l0LT5jYWNoZVRpbWUoJGNhY2hlX3RpbWUpOwogICAgICAg
IH0gZWxzZSB7ICAvLyB0dXJuIG9mZiBjYWNoaW5nLCBub3QgcmVjb21tZW5kZWQgb3RoZXIg
dGhhbiBmb3IgdGVzdGluZwogICAgICAgICAgICAkdHdpdC0+c2V0Q2FjaGluZyhmYWxzZSk7
CiAgICAgICAgfQoKICAgICAgICAvLyBjb25zdHJ1Y3Qgc2VhcmNoIHF1ZXJ5CiAgICAgICAg
aWYgKCFlbXB0eSgkc2VhcmNoKSkgewogICAgICAgICAgICAkdGVybXMgPSBleHBsb2RlKCcs
Jywkc2VhcmNoKTsgJHRlcm1zID0gYXJyYXlfbWFwKCd0cmltJywkdGVybXMpOwogICAgICAg
ICAgICAkc2VhcmNoID0gaW1wbG9kZSgnICcsJHRlcm1zKTsKICAgICAgICB9CiAgICAgICAg
aWYgKCRoYXNodGFncykgewogICAgICAgICAgICAkaGFzaGVzID0gZXhwbG9kZSgnLCcsJGhh
c2h0YWdzKTsgJGhhc2hlcyA9IGFycmF5X21hcCgndHJpbScsJGhhc2hlcyk7CiAgICAgICAg
ICAgICRzZWFyY2guPSAoKCRzZWFyY2gpPycgJzonJykuJyMnLmltcGxvZGUoJyAjJywkaGFz
aGVzKTsKICAgICAgICB9CiAgICAgICAgaWYgKCRyZXBseSkgewogICAgICAgICAgICAkc2Vh
cmNoLj0gKCgkc2VhcmNoKT8nICc6JycpLid0bzonLnRyaW0oJHJlcGx5KTsKICAgICAgICB9
CiAgICAgICAgaWYgKCR1c2VyKSB7CiAgICAgICAgICAgICRzZWFyY2guPSAoKCRzZWFyY2gp
PycgJzonJykuJ2Zyb206Jy50cmltKCR1c2VyKTsKICAgICAgICB9CiAgICAgICAgaWYgKCRt
ZW50aW9uKSB7CiAgICAgICAgICAgICRzZWFyY2guPSAoKCRzZWFyY2gpPycgJzonJykuJ0An
LnRyaW0oJG1lbnRpb24pOwogICAgICAgIH0KCiAgICAgICAgaWYgKGVtcHR5KCRzZWFyY2gp
KSB7CiAgICAgICAgICAgIHJldHVybiAnJzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAg
ICAkc2VhcmNoID0gdXJsZW5jb2RlKCRzZWFyY2gpOwogICAgICAgIH0KCiAgICAgICAgJG91
dCA9IGFycmF5KCk7CiAgICAgICAgJHJlc3VsdHMgPSAkdHdpdC0+Z2V0KCdzZWFyY2gvdHdl
ZXRzJwogICAgICAgICAgICAsIGFycmF5KCdxJz0+JHNlYXJjaCwnY291bnQnPT4kbGltaXQs
J2xhbmcnPT4kbGFuZykpOwoKICAgICAgICAkdHdlZXRzID0gJHJlc3VsdHMtPnN0YXR1c2Vz
OwogICAgICAgIGlmICgkdHdlZXRzKSB7IGZvcmVhY2ggKCR0d2VldHMgYXMgJHR3ZWV0KSB7
CiAgICAgICAgICAgIC8vIHByZWdfbWF0Y2goIi8oLiopIFwoKC4qKVwpLyIsJHR3ZWV0LT51
c2VyLT5zY3JlZW5fbmFtZSwkbWF0Y2hlcyk7CiAgICAgICAgICAgIC8vIGxpc3QoJGF1dGhv
ciwkdW5hbWUsJG5hbWUpID0gJG1hdGNoZXM7CiAgICAgICAgICAgICR1bmFtZSA9ICR0d2Vl
dC0+dXNlci0+c2NyZWVuX25hbWU7CiAgICAgICAgICAgICRuYW1lID0gJHR3ZWV0LT51c2Vy
LT5uYW1lOwogICAgICAgICAgICAkdGltZSA9IHN0cnRvdGltZShodG1sZW50aXRpZXMoJHR3
ZWV0LT5jcmVhdGVkX2F0KSk7CiAgICAgICAgICAgICRkYXRlID0gc2FmZV9zdHJmdGltZSgk
ZGF0ZWZvcm1hdCwkdGltZSk7CiAgICAgICAgICAgICR0ZXh0ID0gJHR3ZWV0LT50ZXh0Owog
ICAgICAgICAgICAkb3V0W10gPSB0YWcoaHJlZihodG1sZW50aXRpZXMoJHVuYW1lKSwnaHR0
cDovL3R3aXR0ZXIuY29tLycgLiAkdHdlZXQtPnVzZXItPnNjcmVlbl9uYW1lLAogICAgICAg
ICAgICAgICAgJyB0aXRsZT0iJy5odG1sZW50aXRpZXMoJG5hbWUpLiciJykuJzogJywnc3Bh
bicKICAgICAgICAgICAgICAgICAgICAsJyBjbGFzcz0iJy4kY2xhc3NfdXNlci4nIicpCiAg
ICAgICAgICAgICAgICAuYXJjX1R3aXR0ZXI6Om1ha2VMaW5rcyhodG1sZW50aXRpZXMoJHRl
eHQsIEVOVF9RVU9URVMsJ1VURi04JykpCiAgICAgICAgICAgICAgICAuJyAnLnRhZyhodG1s
ZW50aXRpZXMoJGRhdGUpLCdzcGFuJwogICAgICAgICAgICAgICAgICAgICwnIGNsYXNzPSIn
LiRjbGFzc19wb3N0ZWQuJyInKTsKICAgICAgICB9IHJldHVybiBkb0xhYmVsKCRsYWJlbCwg
JGxhYmVsdGFnKQogICAgICAgICAgICAuZG9XcmFwKCRvdXQsICR3cmFwdGFnLCAkYnJlYWss
ICRjbGFzcyk7IH0KCn0KCmZ1bmN0aW9uIGFyY190d2l0dGVyX3R3ZWV0KCRhdHRzKSB7CiAg
ICBnbG9iYWwgJHRoaXNhcnRpY2xlOwoKICAgIGV4dHJhY3QobEF0dHMoYXJyYXkoCiAgICAg
ICdpZCcgICAgICAgID0+ICR0aGlzYXJ0aWNsZVsndGhpc2lkJ10sCiAgICAgICdpbmNsdWRl
X3VybCcgICA9PiB0cnVlCiAgICApLCRhdHRzKSk7CgogICAgaWYgKCRpZCkgewogICAgICAv
LyBGZXRjaCBhcmNfdHdpdHRlciBzdHVmZiB0byBidWlsZCB0d2VldCBmcm9tCiAgICAgICR0
d2VldCA9ICgkaW5jbHVkZV91cmwpID8gc2FmZV9yb3coInR3ZWV0IiwgJ2FyY190d2l0dGVy
JywgImFydGljbGVfaWQ9eyRpZH0iKQogICAgICAgIDogc2FmZV9yb3coIlJFUExBQ0UodHdl
ZXQsQ09OQ0FUKCcgJyx0aW55dXJsKSwnJykgQVMgdHdlZXQiCiAgICAgICAgICAsICdhcmNf
dHdpdHRlcicsICJhcnRpY2xlX2lkPXskaWR9Iik7CiAgICB9CgogICAgaWYgKCR0d2VldFsn
dHdlZXQnXSkgewogICAgICByZXR1cm4gYXJjX1R3aXR0ZXI6Om1ha2VMaW5rcygKICAgICAg
ICBodG1sZW50aXRpZXMoJHR3ZWV0Wyd0d2VldCddLCBFTlRfUVVPVEVTLCdVVEYtOCcpKTsK
ICAgIH0KfQoKZnVuY3Rpb24gYXJjX3R3aXR0ZXJfdHdlZXRfdXJsKCRhdHRzLCAkdGhpbmc9
bnVsbCkgewogICAgZ2xvYmFsICR0aGlzYXJ0aWNsZSwkcHJlZnM7CgogICAgZXh0cmFjdChs
QXR0cyhhcnJheSgKICAgICAgJ2lkJyAgICAgID0+ICR0aGlzYXJ0aWNsZVsndGhpc2lkJ10s
CiAgICAgICd0aXRsZScgICA9PiAnJywKICAgICAgJ2NsYXNzJyAgID0+ICcnCiAgICApLCRh
dHRzKSk7CgogICAgaWYgKCRpZCkgewogICAgICAvLyBGZXRjaCBhcmNfdHdpdHRlciBzdHVm
ZiB0byBidWlsZCB0d2VldCBmcm9tCiAgICAgICR0d2VldCA9IHNhZmVfcm93KCJ0d2VldF9p
ZCIKICAgICAgICAsICdhcmNfdHdpdHRlcicsICJhcnRpY2xlX2lkPXskaWR9Iik7CiAgICB9
CgogICAgaWYgKCR0d2VldFsndHdlZXRfaWQnXSkgewogICAgICAkdXJsID0gImh0dHA6Ly90
d2l0dGVyLmNvbS8iLiRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLiIvc3RhdHVzLyIuJHR3
ZWV0Wyd0d2VldF9pZCddOwogICAgICBpZiAoJHRoaW5nPT09bnVsbCkgewogICAgICAgIHJl
dHVybiAkdXJsOwogICAgICB9CiAgICAgIHJldHVybiBocmVmKHBhcnNlKCR0aGluZyksICR1
cmwsCiAgICAgICAgKCR0aXRsZSA/ICcgdGl0bGU9IicuJHRpdGxlLiciJyA6ICcnKQogICAg
ICAgIC4oJGNsYXNzID8gJyBjbGFzcz0iJy4kY2xhc3MuJyInIDogJycpKTsKICAgIH0KfQoK
ZnVuY3Rpb24gYXJjX3R3aXR0ZXJfdGlueXVybCgkYXR0cywgJHRoaW5nPW51bGwpIHsKICAg
IGdsb2JhbCAkdGhpc2FydGljbGU7CgogICAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICAg
J2lkJyAgICAgID0+ICR0aGlzYXJ0aWNsZVsndGhpc2lkJ10sCiAgICAgICd0aXRsZScgICA9
PiAnJywKICAgICAgJ2NsYXNzJyAgID0+ICcnCiAgICApLCRhdHRzKSk7CgogICAgaWYgKCRp
ZCkgewogICAgICAvLyBGZXRjaCBhcmNfdHdpdHRlciBzdHVmZiB0byBidWlsZCB0d2VldCBm
cm9tCiAgICAgICR0d2VldCA9IHNhZmVfcm93KCJ0aW55dXJsIgogICAgICAgICwgJ2FyY190
d2l0dGVyJywgImFydGljbGVfaWQ9eyRpZH0iKTsKICAgIH0KCiAgICBpZiAoJHR3ZWV0Wyd0
aW55dXJsJ10pIHsKICAgICAgaWYgKCR0aGluZz09PW51bGwpIHsKICAgICAgICByZXR1cm4g
JHR3ZWV0Wyd0aW55dXJsJ107CiAgICAgIH0KCiAgICAgIHJldHVybiBocmVmKHBhcnNlKCR0
aGluZyksICR0d2VldFsndGlueXVybCddLAogICAgICAgICgkdGl0bGUgPyAnIHRpdGxlPSIn
LiR0aXRsZS4nIicgOiAnJykKICAgICAgICAuKCRjbGFzcyA/ICcgY2xhc3M9IicuJGNsYXNz
LiciJyA6ICcnKSk7CiAgICB9Cn0KCi8qCiAqIFB1YmxpYyB0YWcgZm9yIG91dHB1dHRpbmcg
d2lkZ2V0IEpTCiAqLwpmdW5jdGlvbiBhcmNfdHdpdHRlcl93aWRnZXRfanMoJGF0dHMpCnsK
ICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAgICdvcHRpbWlzZScgPT4gZmFsc2UKICAg
ICksJGF0dHMpKTsKCiAgcmV0dXJuIF9hcmNfdHdpdHRlcl93aWRnZXRfanMoJG9wdGltaXNl
KTsKfQoKZnVuY3Rpb24gX2FyY190d2l0dGVyX3dpZGdldF9qcygkb3B0aW1pc2U9dHJ1ZSkK
ewogIGdsb2JhbCAkYXJjX3R3aXR0ZXI7CgogIC8vIENoZWNrIGlmIHdpZGdldCBKUyBoYXMg
YWxyZWFkeSBiZWVuIG91dHB1dAogIGlmICgkYXJjX3R3aXR0ZXJbJ3dpZGdldF9qcyddKSBy
ZXR1cm47CgogIGlmICgkb3B0aW1pc2U9PWZhbHNlKSB7CiAgICByZXR1cm4gJzxzY3JpcHQg
c3JjPSJodHRwOi8vcGxhdGZvcm0udHdpdHRlci5jb20vd2lkZ2V0cy5qcyIgdHlwZT0idGV4
dC9qYXZhc2NyaXB0Ij48L3NjcmlwdD4nOwogIH0KCiAgJGpzID0gPDw8SlMKPHNjcmlwdCB0
eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPgooZnVuY3Rpb24oKSB7CiAgaWYgKHdpbmRvdy5fX3R3
aXR0ZXJJbnRlbnRIYW5kbGVyKSByZXR1cm47CiAgdmFyIGludGVudFJlZ2V4ID0gL3R3aXR0
ZXJcLmNvbShcOlxkezIsNH0pP1wvaW50ZW50XC8oXHcrKS8sCiAgICAgIHdpbmRvd09wdGlv
bnMgPSAnc2Nyb2xsYmFycz15ZXMscmVzaXphYmxlPXllcyx0b29sYmFyPW5vLGxvY2F0aW9u
PXllcycsCiAgICAgIHdpZHRoID0gNTUwLAogICAgICBoZWlnaHQgPSA0MjAsCiAgICAgIHdp
bkhlaWdodCA9IHNjcmVlbi5oZWlnaHQsCiAgICAgIHdpbldpZHRoID0gc2NyZWVuLndpZHRo
OwoKICBmdW5jdGlvbiBoYW5kbGVJbnRlbnQoZSkgewogICAgZSA9IGUgfHwgd2luZG93LmV2
ZW50OwogICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudCwKICAgICAg
ICBtLCBsZWZ0LCB0b3A7CgogICAgd2hpbGUgKHRhcmdldCAmJiB0YXJnZXQubm9kZU5hbWUu
dG9Mb3dlckNhc2UoKSAhPT0gJ2EnKSB7CiAgICAgIHRhcmdldCA9IHRhcmdldC5wYXJlbnRO
b2RlOwogICAgfQoKICAgIGlmICh0YXJnZXQgJiYgdGFyZ2V0Lm5vZGVOYW1lLnRvTG93ZXJD
YXNlKCkgPT09ICdhJyAmJiB0YXJnZXQuaHJlZikgewogICAgICBtID0gdGFyZ2V0LmhyZWYu
bWF0Y2goaW50ZW50UmVnZXgpOwogICAgICBpZiAobSkgewogICAgICAgIGxlZnQgPSBNYXRo
LnJvdW5kKCh3aW5XaWR0aCAvIDIpIC0gKHdpZHRoIC8gMikpOwogICAgICAgIHRvcCA9IDA7
CgogICAgICAgIGlmICh3aW5IZWlnaHQgPiBoZWlnaHQpIHsKICAgICAgICAgIHRvcCA9IE1h
dGgucm91bmQoKHdpbkhlaWdodCAvIDIpIC0gKGhlaWdodCAvIDIpKTsKICAgICAgICB9Cgog
ICAgICAgIHdpbmRvdy5vcGVuKHRhcmdldC5ocmVmLCAnaW50ZW50Jywgd2luZG93T3B0aW9u
cyArICcsd2lkdGg9JyArIHdpZHRoICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICcsaGVpZ2h0PScgKyBoZWlnaHQgKyAnLGxlZnQ9JyArIGxlZnQgKyAn
LHRvcD0nICsgdG9wKTsKICAgICAgICBlLnJldHVyblZhbHVlID0gZmFsc2U7CiAgICAgICAg
ZS5wcmV2ZW50RGVmYXVsdCAmJiBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgIH0KICAgIH0K
ICB9CgogIGlmIChkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKSB7CiAgICBkb2N1bWVudC5h
ZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZUludGVudCwgZmFsc2UpOwogIH0gZWxz
ZSBpZiAoZG9jdW1lbnQuYXR0YWNoRXZlbnQpIHsKICAgIGRvY3VtZW50LmF0dGFjaEV2ZW50
KCdvbmNsaWNrJywgaGFuZGxlSW50ZW50KTsKICB9CiAgd2luZG93Ll9fdHdpdHRlckludGVu
dEhhbmRsZXIgPSB0cnVlOwp9KCkpOwo8L3NjcmlwdD4KSlM7CiAgJGFyY190d2l0dGVyWyd3
aWRnZXRfanMnXSA9IHRydWU7CiAgcmV0dXJuICRqczsKfQoKLy8gRGVwcmVjYXRlZCBhcmNf
dHdpdHRlcl9yZXR3ZWV0IHRhZywgdXNlIGFyY190d2l0dGVyX3R3ZWV0X2J1dHRvbiBpbnN0
ZWFkCmZ1bmN0aW9uIGFyY190d2l0dGVyX3JldHdlZXQoJGF0dHMsICR0aGluZz1udWxsKQp7
CiAgcmV0dXJuIGFyY190d2l0dGVyX3R3ZWV0X2J1dHRvbigkYXR0cywgJHRoaW5nPW51bGwp
Owp9CmZ1bmN0aW9uIGFyY190d2l0dGVyX3R3ZWV0X2J1dHRvbigkYXR0cywgJHRoaW5nPW51
bGwpCnsKICAgIGdsb2JhbCAkcHJlZnMsJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCAkYXJj
X3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CiAgICBnbG9iYWwgJHRoaXNhcnRpY2xlOwoKICAg
IGV4dHJhY3QobEF0dHMoYXJyYXkoCiAgICAgICAgJ3VzZXInICAgICAgICA9PiAkcHJlZnNb
J2FyY190d2l0dGVyX3VzZXInXSwgLy8gdmlhIHVzZXIgYWNjb3VudAogICAgICAgICd1cmwn
ICAgICAgICAgPT4gJycsCiAgICAgICAgJ3RleHQnICAgICAgICA9PiAnJywKICAgICAgICAn
Zm9sbG93MScgICAgID0+ICcnLAogICAgICAgICdmb2xsb3cyJyAgICAgPT4gJycsCiAgICAg
ICAgJ2xhbmcnICAgICAgICA9PiAnJywKICAgICAgICAnY291bnQnICAgICAgID0+ICdob3Jp
em9udGFsJywKICAgICAgICAnaW5jbHVkZV9qcycgID0+IHRydWUsCiAgICAgICAgJ29wdGlt
aXNlX2pzJyA9PiBmYWxzZSwKICAgICAgICAnd3JhcHRhZycgICAgID0+ICcnLAogICAgICAg
ICdjbGFzcycgICAgICAgPT4gJ3R3aXR0ZXItc2hhcmUtYnV0dG9uJwogICAgKSwkYXR0cykp
OwoKICAgICRxID0gJyc7IC8vIHF1ZXJ5IHN0cmluZwoKICAgIGlmICgkaWQ9JHRoaXNhcnRp
Y2xlWyd0aGlzaWQnXSkgewogICAgICAvLyBGZXRjaCBhcmNfdHdpdHRlciBzdHVmZiB0byBi
dWlsZCB0d2VldCBmcm9tCiAgICAgICRyb3cgPSBzYWZlX3JvdygiUkVQTEFDRSh0d2VldCxD
T05DQVQoJyAnLHRpbnl1cmwpLCcnKSBBUyB0d2VldCx0aW55dXJsIgogICAgICAgICwgJ2Fy
Y190d2l0dGVyJywgImFydGljbGVfaWQ9eyRpZH0iKTsKCiAgICAgIGlmICgkdXJsPT0nJykg
ewogICAgICAgICR1cmwgPSAoJHVybCkgPyAkdXJsIDogcGVybWxpbmt1cmwoJHRoaXNhcnRp
Y2xlKTsKICAgICAgICAkcSA9ICd1cmw9Jy51cmxlbmNvZGUoJHVybCk7CiAgICAgIH0KICAg
ICAgaWYgKCR0ZXh0PT0nJykgewogICAgICAgICR0ZXh0ID0gKCRyb3dbJ3R3ZWV0J10pID8g
JHJvd1sndHdlZXQnXSA6ICR0aGlzYXJ0aWNsZVsndGl0bGUnXTsKICAgICAgfQogICAgICAk
cSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLid0ZXh0PScudXJsZW5jb2RlKCR0ZXh0KTsKICAg
IH0KICAgIGlmICgkdXNlcikgewogICAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLid2
aWE9Jy51cmxlbmNvZGUoJHVzZXIpOwogICAgfQogICAgaWYgKCRmb2xsb3cxJiYkZm9sbG93
MikgewogICAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLidyZWxhdGVkPScudXJsZW5j
b2RlKCRmb2xsb3cxLic6Jy4kZm9sbG93Mik7CiAgICB9IGVsc2VpZiAoJGZvbGxvdzF8fCRm
b2xsb3cyKSB7CiAgICAgICRxIC49ICgkcSA/ICcmYW1wOycgOiAnJykuJ3JlbGF0ZWQ9Jy51
cmxlbmNvZGUoJGZvbGxvdzEuJGZvbGxvdzIpOwogICAgfQoKICAgIHN3aXRjaCAoJGxhbmcp
IHsKICAgICAgY2FzZSAnZnInOiBicmVhazsgY2FzZSAnZGUnOiBicmVhazsgY2FzZSAnZXMn
OiBicmVhazsgY2FzZSAnanAnOiBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICAkbGFu
ZyA9ICdlbic7CiAgICB9CiAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLidsYW5nPScu
dXJsZW5jb2RlKCRsYW5nKTsKCiAgICBzd2l0Y2ggKCRjb3VudCkgewogICAgICBjYXNlICdu
b25lJzogYnJlYWs7IGNhc2UgJ3ZlcnRpY2FsJzogYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAg
ICAgICAgJGNvdW50ID0gJ2hvcml6b250YWwnOwogICAgfQogICAgJHEgLj0gKCRxID8gJyZh
bXA7JyA6ICcnKS4nY291bnQ9Jy51cmxlbmNvZGUoJGNvdW50KTsKCiAgICAkdGhpbmcgPSAo
JHRoaW5nPT09bnVsbCkgPyAnVHdlZXQnIDogcGFyc2UoJHRoaW5nKTsKCiAgICAkaHRtbCA9
IGhyZWYoJHRoaW5nLCdodHRwOi8vdHdpdHRlci5jb20vc2hhcmU/Jy4kcQogICAgICAsICcg
Y2xhc3M9IicuJGNsYXNzLiciJyk7CgogICAgJGpzID0gKCRpbmNsdWRlX2pzKSA/IF9hcmNf
dHdpdHRlcl93aWRnZXRfanMoJG9wdGltaXNlX2pzP3RydWU6ZmFsc2UpIDogJyc7CgogICAg
cmV0dXJuICRqcy4kaHRtbDsKfQoKLyoKICogVHdpdHRlciBGb2xsb3cgYnV0dG9uCiAqLwpm
dW5jdGlvbiBhcmNfdHdpdHRlcl9mb2xsb3dfYnV0dG9uKCRhdHRzLCAkdGhpbmc9bnVsbCkK
ewogICAgZ2xvYmFsICRwcmVmcywkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksICRhcmNfdHdp
dHRlcl9jb25zdW1lclNlY3JldDsKICAgIGdsb2JhbCAkdGhpc2FydGljbGU7CgogICAgZXh0
cmFjdChsQXR0cyhhcnJheSgKICAgICAgICAndXNlcicgICAgICAgID0+ICRwcmVmc1snYXJj
X3R3aXR0ZXJfdXNlciddLCAvLyB2aWEgdXNlciBhY2NvdW50CiAgICAgICAgJ2xhbmcnICAg
ICAgICA9PiAnJywKICAgICAgICAnY291bnQnICAgICAgID0+IHRydWUsCiAgICAgICAgJ2lu
Y2x1ZGVfanMnICA9PiB0cnVlLAogICAgICAgICdvcHRpbWlzZV9qcycgPT4gZmFsc2UsCiAg
ICAgICAgJ2NsYXNzJyAgICAgICA9PiAndHdpdHRlci1mb2xsb3ctYnV0dG9uJwogICAgKSwk
YXR0cykpOwoKICAgICRhdHRzID0gJyc7IC8vIGRhdGEgYXR0cmlidXRlcwoKICAgIHN3aXRj
aCAoJGxhbmcpIHsKICAgICAgY2FzZSAnZnInOiBicmVhazsgY2FzZSAnZGUnOiBicmVhazsg
Y2FzZSAnZXMnOiBicmVhazsgY2FzZSAnanAnOiBicmVhazsKICAgICAgZGVmYXVsdDoKICAg
ICAgICAkbGFuZyA9ICdlbic7CiAgICB9CiAgICAkYXR0cyAuPSAnIGRhdGEtbGFuZz0iJy51
cmxlbmNvZGUoJGxhbmcpLiciJzsKCiAgICAkYXR0cyAuPSAnIGRhdGEtc2hvdy1jb3VudD0i
Jy4oJGNvdW50Pyd0cnVlJzonZmFsc2UnKS4nIic7CgogICAgJHRoaW5nID0gKCR0aGluZz09
PW51bGwpID8gJ0ZvbGxvdyBAJy4kdXNlciA6IHBhcnNlKCR0aGluZyk7CgogICAgJGh0bWwg
PSBocmVmKCR0aGluZywnaHR0cDovL3R3aXR0ZXIuY29tLycudXJsZW5jb2RlKCR1c2VyKQog
ICAgICAsICcgY2xhc3M9IicuJGNsYXNzLiciJy4kYXR0cyk7CgogICAgJGpzID0gKCRpbmNs
dWRlX2pzKSA/IF9hcmNfdHdpdHRlcl93aWRnZXRfanMoJG9wdGltaXNlX2pzP3RydWU6ZmFs
c2UpIDogJyc7CgogICAgcmV0dXJuICRqcy4kaHRtbDsKfQoKLyoKICAgIEFkbWluLXNpZGUg
ZnVuY3Rpb25zCiAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09CiovCgovLyBJbnN0YWxsYXRpb24gZnVuY3Rpb24g
LSBidWlsZHMgTXlTUUwgdGFibGUKZnVuY3Rpb24gYXJjX3R3aXR0ZXJfaW5zdGFsbCgpCnsK
CiAgICAvLyBGb3IgZmlyc3QgaW5zdGFsbCwgY3JlYXRlIHRhYmxlIGZvciB0d2VldHMKICAg
ICRzcWwgPSAiQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgIi5QRlguImFyY190d2l0dGVy
ICI7CiAgICAkc3FsLj0gIihhcmNfdHdpdHRlcmlkIElOVEVHRVIgQVVUT19JTkNSRU1FTlQg
UFJJTUFSWSBLRVksCiAgICAgICAgYXJ0aWNsZV9pZCBJTlRFR0VSKDExKSwKICAgICAgICB0
d2VldF9pZCBCSUdJTlQoMjApLAogICAgICAgIHR3ZWV0IFZBUkNIQVIoMTQwKSwKICAgICAg
ICB0aW55dXJsIFZBUkNIQVIoMzApKTsiOwoKICAgIGlmICghc2FmZV9xdWVyeSgkc3FsKSkg
ewogICAgICAgIHJldHVybiAnRXJyb3IgLSB1bmFibGUgdG8gY3JlYXRlIGFyY190d2l0dGVy
IHRhYmxlJzsKICAgIH0KCn0KCi8vIFVuaW5zdGFsbCBmdW5jdGlvbiAtIGRlbGV0ZXMgTXlT
UUwgdGFibGUgYW5kIHJlbGF0ZWQgcHJlZmVyZW5jZXMKZnVuY3Rpb24gYXJjX3R3aXR0ZXJf
dW5pbnN0YWxsKCkKewoKICAgICRzcWwgPSAiRFJPUCBUQUJMRSBJRiBFWElTVFMgIi5QRlgu
ImFyY190d2l0dGVyOyI7CiAgICBpZiAoIXNhZmVfcXVlcnkoJHNxbCkpIHsKICAgICAgICBy
ZXR1cm4gJ0Vycm9yIC0gdW5hYmxlIHRvIGRlbGV0ZSBhcmNfdHdpdHRlciB0YWJsZSc7CiAg
ICB9CgogICAgJHNxbCA9ICJERUxFVEUgRlJPTSAgIi5QRlguInR4cF9wcmVmcyBXSEVSRSBl
dmVudD0nYXJjX3R3aXR0ZXInOyI7CiAgICBpZiAoIXNhZmVfcXVlcnkoJHNxbCkpIHsKICAg
ICAgICByZXR1cm4gJ0Vycm9yIC0gdW5hYmxlIHRvIGRlbGV0ZSBhcmNfdHdpdHRlciBwcmVm
ZXJlbmNlcyc7CiAgICB9Cgp9CmZ1bmN0aW9uIGFyY190d2l0dGVyX3VybF9tZXRob2Rfc2Vs
ZWN0KCRuYW1lLCAkdmFsKQp7CiAgICAkbWV0aG9kcyA9IGFycmF5KCd0aW55dXJsJyA9PiAn
VGlueXVybCcsCiAgICAgICdpc2dkJyA9PiAnSXMuZ2QnLAogICAgICAnYXJjX3R3aXR0ZXIn
ID0+ICdUWFAgVHdlZXQnLAogICAgICAnc21kJyA9PiAnc21kX3Nob3J0X3VybCcpOwogICAg
cmV0dXJuIHNlbGVjdElucHV0KCRuYW1lLCAkbWV0aG9kcywgJHZhbCwgJycsICcnLCAkbmFt
ZSk7Cn0KZnVuY3Rpb24gYXJjX3R3aXR0ZXJfdGFiX3NlbGVjdCgkbmFtZSwgJHZhbCkKewog
ICAgJHRhYnMgPSBhcnJheSgnY29udGVudCcgPT4gJ0NvbnRlbnQnLAogICAgICAgICdleHRl
bnNpb25zJyA9PiAnRXh0ZW5zaW9ucycsCiAgICAgICAgJycgPT4gJ0hpZGRlbicpOwogICAg
cmV0dXJuIHNlbGVjdElucHV0KCRuYW1lLCAkdGFicywgJHZhbCwgJycsICcnLCAkbmFtZSk7
Cn0KLy8gUHJvdmlkZSBpbnRlcmZhY2UgZm9yIHNldHRpbmcgcHJlZmVyZW5jZXMKZnVuY3Rp
b24gYXJjX3R3aXR0ZXJfcHJlZnMoJGV2ZW50LCRzdGVwKQp7CgogICAgZ2xvYmFsICRwcmVm
cywkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0
OwoKICAgICR1c2VyICAgICAgICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ107CiAg
ICAkcHJlZml4ICAgICAgICA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfcHJlZml4J107CiAgICAk
c3VmZml4ICAgICAgICA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfc3VmZml4J107CiAgICAkdHdl
ZXRfZGVmYXVsdCA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCddOwogICAg
JHVybF9tZXRob2QgICAgPSAkcHJlZnNbJ2FyY190d2l0dGVyX3VybF9tZXRob2QnXTsKICAg
ICRzaG9ydF91cmwgICAgID0gJHByZWZzWydhcmNfc2hvcnRfdXJsJ107CiAgICAkc2hvcnRf
c2l0ZV91cmw9ICRwcmVmc1snYXJjX3Nob3J0X3NpdGVfdXJsJ107CiAgICAkY2FjaGVfZGly
ICAgICA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJ107CiAgICAkdGFiICAgICAg
ICAgICA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfdGFiJ107CgogICAgc3dpdGNoICgkc3RlcCkg
ewogICAgICAgIGNhc2UgJ3ByZWZzX3NhdmUnOiBwYWdldG9wKCdUWFAgVHdlZXQnLCAnUHJl
ZmVyZW5jZXMgc2F2ZWQnKTsgYnJlYWs7CiAgICAgICAgY2FzZSAncmVnaXN0ZXInOiBwYWdl
dG9wKCdUWFAgVHdlZXQnLCdDb25uZWN0IHRvIFR3aXR0ZXInKTsgYnJlYWs7CiAgICAgICAg
Y2FzZSAndmFsaWRhdGUnOgogICAgICAgIGRlZmF1bHQ6IHBhZ2V0b3AoJ1RYUCBUd2VldCcp
OwogICAgfQoKICAgICRodG1sID0gJyc7CgogICAgaWYgKCRzdGVwPT0ncmVnaXN0ZXInKSB7
IC8vIE9BdXRoIHJlZ2lzdHJhdGlvbiBwcm9jZXNzCgogICAgICAgICR0d2l0ID0gbmV3IGFy
Y190d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleSwgJGFyY190d2l0dGVyX2NvbnN1
bWVyU2VjcmV0KTsKCiAgICAgICAgLy8gQnVpbGQgYSBjYWxsYmFjayBVUkwgZm9yIFR3aXR0
ZXIgdG8gcmV0dXJuIHRvIHRoZSBuZXh0IHN0YWdlCiAgICAgICAgJGNhbGxiYWNrVVJMID0g
JHR3aXQtPmNhbGxiYWNrVVJMKCRldmVudCwndmFsaWRhdGUnKTsKCiAgICAgICAgJHJlcXVl
c3QgPSAkdHdpdC0+Z2V0UmVxdWVzdFRva2VuKCRjYWxsYmFja1VSTCk7CiAgICAgICAgJHJl
cXVlc3RfdG9rZW4gPSAkcmVxdWVzdFsib2F1dGhfdG9rZW4iXTsKICAgICAgICAkcmVxdWVz
dF90b2tlbl9zZWNyZXQgPSAkcmVxdWVzdFsib2F1dGhfdG9rZW5fc2VjcmV0Il07CgogICAg
ICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9yZXF1ZXN0VG9rZW4nLCRyZXF1ZXN0X3Rva2Vu
LCAnYXJjX3R3aXR0ZXInLDIpOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9yZXF1
ZXN0VG9rZW5TZWNyZXQnLCRyZXF1ZXN0X3Rva2VuX3NlY3JldCwgJ2FyY190d2l0dGVyJywy
KTsKCiAgICAkaHRtbCA9ICI8ZGl2IGNsYXNzPSd0ZXh0LWNvbHVtbic+IgogICAgICAuIjxw
PiIuaHJlZignU2lnbi1pbiB0byBUd2l0dGVyJywgJHR3aXQtPmdldEF1dGhvcml6ZVVSTCgk
cmVxdWVzdCkpLiIgYW5kIGZvbGxvdyB0aGUgaW5zdHJ1Y3Rpb25zIHRvIGFsbG93IFRYUCBU
d2VldCB0byB1c2UgeW91ciBhY2NvdW50LiBJZiB5b3UgYXJlIGFscmVhZHkgc2lnbmVkIGlu
IHRvIFR3aXR0ZXIgdGhlbiB0aGF0IGFjY291bnQgd2lsbCBiZSBhc3NvY2lhdGVkIHdpdGgg
VFhQIFR3ZWV0IHNvIHlvdSBtYXkgbmVlZCB0byBzaWduIG91dCBmaXJzdCBpZiB5b3Ugd2Fu
dCB0byB1c2UgYSBkaWZmZXJlbnQgYWNjb3VudC48L3A+IgogICAgICAuIjwvZGl2PiI7Cgog
ICAgfSBlbHNlaWYgKCRzdGVwPT0ndmFsaWRhdGUnKSB7CiAgICAgICAgJHR3aXQgPSBuZXcg
YXJjX3R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAgICAgICAgICwgJGFy
Y190d2l0dGVyX2NvbnN1bWVyU2VjcmV0LCAkcHJlZnNbJ2FyY190d2l0dGVyX3JlcXVlc3RU
b2tlbiddCiAgICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRlcl9yZXF1ZXN0VG9rZW5T
ZWNyZXQnXSk7CiAgICAgICAgLy8gQXNrIFR3aXR0ZXIgZm9yIGFuIGFjY2VzcyB0b2tlbiAo
YW5kIGFuIGFjY2VzcyB0b2tlbiBzZWNyZXQpCiAgICAgICAgJHJlcXVlc3QgPSAkdHdpdC0+
Z2V0QWNjZXNzVG9rZW4oIGdwcygnb2F1dGhfdmVyaWZpZXInKSApOwogICAgICAgICRhY2Nl
c3NfdG9rZW4gPSAkcmVxdWVzdFsnb2F1dGhfdG9rZW4nXTsKICAgICAgICAkYWNjZXNzX3Rv
a2VuX3NlY3JldCA9ICRyZXF1ZXN0WydvYXV0aF90b2tlbl9zZWNyZXQnXTsKICAgICAgICAk
dXNlciA9ICRyZXF1ZXN0WydzY3JlZW5fbmFtZSddOwogICAgICAgIC8vIFN0b3JlIHRoZSBh
Y2Nlc3MgdG9rZW4gYW5kIHNlY3JldAogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9h
Y2Nlc3NUb2tlbicsJGFjY2Vzc190b2tlbiwgJ2FyY190d2l0dGVyJywyKTsKICAgICAgICBz
ZXRfcHJlZignYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnLCRhY2Nlc3NfdG9rZW5f
c2VjcmV0CiAgICAgICAgICAgICwgJ2FyY190d2l0dGVyJywyKTsKICAgICAgICBzZXRfcHJl
ZignYXJjX3R3aXR0ZXJfdXNlcicsJHVzZXIpOwogICAgICAgICRwcmVmc1snYXJjX3R3aXR0
ZXJfYWNjZXNzVG9rZW4nXSA9ICRhY2Nlc3NfdG9rZW47CiAgICAgICAgJHByZWZzWydhcmNf
dHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCddID0gJGFjY2Vzc190b2tlbl9zZWNyZXQ7CiAg
ICAgICAgdW5zZXQoJHR3aXQpOwogICAgfQoKICAgIGlmICgkc3RlcD09InByZWZzX3NhdmUi
KSB7CiAgICAgICAgJHByZWZpeCA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9wcmVmaXgnKSk7
CiAgICAgICAgJHN1ZmZpeCA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9zdWZmaXgnKSk7CiAg
ICAgICAgJHR3ZWV0X2RlZmF1bHQgPSBncHMoJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQn
KTsKICAgICAgICAkdXJsX21ldGhvZCA9IGdwcygnYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCcp
OwogICAgICAgICRzaG9ydF91cmwgPSBncHMoJ2FyY19zaG9ydF91cmwnKTsKICAgICAgICAk
c2hvcnRfc2l0ZV91cmwgPSBncHMoJ2FyY19zaG9ydF9zaXRlX3VybCcpOwogICAgICAgICRj
YWNoZV9kaXIgPSBncHMoJ2FyY190d2l0dGVyX2NhY2hlX2RpcicpOwogICAgICAgICR0YWIg
PSBncHMoJ2FyY190d2l0dGVyX3RhYicpOwogICAgICAgIGlmIChzdHJsZW4oJHByZWZpeCk8
PTIwKSB7CiAgICAgICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9wcmVmaXgnLCRwcmVm
aXgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICRwcmVmaXggPSAkcHJlZnNbJ2Fy
Y190d2l0dGVyX3ByZWZpeCddOwogICAgICAgIH0KICAgICAgICBpZiAoc3RybGVuKCRzdWZm
aXgpPD0yMCkgewogICAgICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfc3VmZml4Jywk
c3VmZml4KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAkc3VmZml4ID0gJHByZWZz
WydhcmNfdHdpdHRlcl9zdWZmaXgnXTsKICAgICAgICB9CiAgICAgICAgJHR3ZWV0X2RlZmF1
bHQgPSAoJHR3ZWV0X2RlZmF1bHQpID8gMSA6IDA7CiAgICAgICAgJHNob3J0X3VybCA9ICgk
c2hvcnRfdXJsKSA/IDEgOiAwOwogICAgICAgIGlmICghJHNob3J0X3NpdGVfdXJsKSAkc2hv
cnRfc2l0ZV91cmwgPSAkcHJlZnNbJ3NpdGV1cmwnXTsKICAgICAgICBzZXRfcHJlZignYXJj
X3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCcsJHR3ZWV0X2RlZmF1bHQpOwogICAgICAgIHNldF9w
cmVmKCdhcmNfc2hvcnRfdXJsJywkc2hvcnRfdXJsKTsKICAgICAgICBzZXRfcHJlZignYXJj
X3R3aXR0ZXJfdXJsX21ldGhvZCcsJHVybF9tZXRob2QpOwogICAgICAgIHNldF9wcmVmKCdh
cmNfc2hvcnRfc2l0ZV91cmwnLCRzaG9ydF9zaXRlX3VybCk7CiAgICAgICAgc2V0X3ByZWYo
J2FyY190d2l0dGVyX2NhY2hlX2RpcicsJGNhY2hlX2Rpcik7CiAgICAgICAgc2V0X3ByZWYo
J2FyY190d2l0dGVyX3RhYicsJHRhYik7CiAgICB9CgogICAgaWYgKCAkc3RlcCE9J3JlZ2lz
dGVyJyApIHsKICAgICAgICBpZiAoIGlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNz
VG9rZW4nXSkKICAgICAgICAmJiBpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rv
a2VuU2VjcmV0J10pICkgewogICAgICAgICAgICAkdHdpdCA9IG5ldyBhcmNfdHdpdHRlcigk
YXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgICAgICwgJGFyY190d2l0dGVy
X2NvbnN1bWVyU2VjcmV0LCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJ10KICAg
ICAgICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCdd
KTsKICAgICAgICAgICAgJHJlZ2lzdGVyVVJMID0gJHR3aXQtPmNhbGxiYWNrVVJMKCRldmVu
dCwncmVnaXN0ZXInKTsKCiAgICAgICAgICAgIC8vIERlZmluZSB0aGUgZmllbGRzIHJlYWR5
IHRvIGJ1aWxkIHRoZSBmb3JtCiAgICAgICAgICAgICRmaWVsZHMgPSBhcnJheSgKICAgICAg
ICAnVHdlZXQgU2V0dGluZ3MnID0+IGFycmF5KAogICAgICAgICAgJ2FyY190d2l0dGVyX3By
ZWZpeCcgPT4gYXJyYXkoCiAgICAgICAgICAgICdsYWJlbCcgPT4gJ1R3ZWV0IHByZWZpeCcs
CiAgICAgICAgICAgICd2YWx1ZScgPT4gJHByZWZpeAogICAgICAgICAgKSwKICAgICAgICAg
ICdhcmNfdHdpdHRlcl9zdWZmaXgnID0+IGFycmF5KAogICAgICAgICAgICAnbGFiZWwnID0+
ICdUd2VldCBzdWZmaXgnLAogICAgICAgICAgICAndmFsdWUnID0+ICRwcmVmaXgKICAgICAg
ICAgICksCiAgICAgICAgICAnYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCcgPT4gYXJyYXko
CiAgICAgICAgICAgICdsYWJlbCcgPT4gJ1R3ZWV0IGFydGljbGVzIGJ5IGRlZmF1bHQnLAog
ICAgICAgICAgICAndHlwZScgPT4gJ3llc25vUmFkaW8nLAogICAgICAgICAgICAndmFsdWUn
ID0+ICR0d2VldF9kZWZhdWx0CiAgICAgICAgICApLAogICAgICAgICAgJ2FyY190d2l0dGVy
X3VybF9tZXRob2QnID0+IGFycmF5KAogICAgICAgICAgICAnbGFiZWwnID0+ICdVUkwgc2hv
cnRuZXInLAogICAgICAgICAgICAndHlwZScgPT4gJ2FyY190d2l0dGVyX3VybF9tZXRob2Rf
c2VsZWN0JywKICAgICAgICAgICAgJ3ZhbHVlJyA9PiAkdXJsX21ldGhvZAogICAgICAgICAg
KQogICAgICAgICksCiAgICAgICAgJ1RYUCBUd2VldCBzaG9ydCBVUkwnID0+IGFycmF5KAog
ICAgICAgICAgJ2FyY19zaG9ydF91cmwnID0+IGFycmF5KAogICAgICAgICAgICAnbGFiZWwn
ID0+ICdFbmFibGUgVFhQIFR3ZWV0IHNob3J0IFVSTCByZWRpcmVjdCcsCiAgICAgICAgICAg
ICd0eXBlJyA9PiAneWVzbm9SYWRpbycsCiAgICAgICAgICAgICd2YWx1ZScgPT4gJHNob3J0
X3VybAogICAgICAgICAgKSwKICAgICAgICAgICdhcmNfc2hvcnRfc2l0ZV91cmwnID0+IGFy
cmF5KAogICAgICAgICAgICAnbGFiZWwnID0+ICdUWFAgVHdlZXQgc2hvcnQgc2l0ZSBVUkwn
LAogICAgICAgICAgICAndmFsdWUnID0+ICRzaG9ydF9zaXRlX3VybAogICAgICAgICAgKQog
ICAgICAgICksCiAgICAgICAgJ1R3aXR0ZXIgVGFiJyA9PiBhcnJheSgKICAgICAgICAgICdh
cmNfdHdpdHRlcl90YWInID0+IGFycmF5KAogICAgICAgICAgICAnbGFiZWwnID0+ICdMb2Nh
dGlvbiBvZiB0YWInLAogICAgICAgICAgICAndHlwZScgPT4gJ2FyY190d2l0dGVyX3RhYl9z
ZWxlY3QnLAogICAgICAgICAgICAndmFsdWUnID0+ICR0YWIKICAgICAgICAgICkKICAgICAg
ICApLAogICAgICAgICdDYWNoZScgPT4gYXJyYXkoCiAgICAgICAgICAnYXJjX3R3aXR0ZXJf
Y2FjaGVfZGlyJyA9PiBhcnJheSgKICAgICAgICAgICAgJ2xhYmVsJyA9PiAnQ2FjaGUgZGly
ZWN0b3J5JywKICAgICAgICAgICAgJ3ZhbHVlJyA9PiAkY2FjaGVfZGlyCiAgICAgICAgICAp
CiAgICAgICAgKQogICAgICAgICAgICApOwoKICAgICAgICAgICAgJGZvcm0gPSAiPGgyPlR3
aXR0ZXIgYWNjb3VudCBkZXRhaWxzPC9oMj4iCiAgICAgICAgLiI8cD48c3BhbiBjbGFzcz0n
ZWRpdC1sYWJlbCc+VHdpdHRlciB1c2VybmFtZTwvc3Bhbj4iCiAgICAgICAgLiI8c3BhbiBj
bGFzcz0nZWRpdC12YWx1ZSc+IgogICAgICAgIC4oJHByZWZzWydhcmNfdHdpdHRlcl91c2Vy
J10gPyAkdXNlci4nICgnLmhyZWYoJ1JlLWNvbm5lY3QnLCRyZWdpc3RlclVSTCkuJyknIDog
JzxlbT51bmtub3duPC9lbT4nLmhyZWYoJ0Nvbm5lY3QgdG8gVHdpdHRlcicsJHJlZ2lzdGVy
VVJMKSkKICAgICAgICAgICAgICAgIC4iPC9zcGFuPjwvcD4iOwoKICAgICAgICAgICAgJGZv
cm0gLj0gX2FyY190d2l0dGVyX2Zvcm1fYnVpbGRlcigkZmllbGRzKTsKCiAgICAgICAgICAg
ICRmb3JtIC49IHNJbnB1dCgncHJlZnNfc2F2ZScpLm4uZUlucHV0KCdwbHVnaW5fcHJlZnMu
YXJjX3R3aXR0ZXInKTsKCiAgICAgICRmb3JtIC49ICc8cD4nLmZJbnB1dCgnc3VibWl0Jywg
J1N1Ym1pdCcsIGdUeHQoJ3NhdmVfYnV0dG9uJyksICdwdWJsaXNoJykuJzwvcD4nOwoKICAg
ICAgJGh0bWwgPSAiPGgxIGNsYXNzPSd0eHAtaGVhZGluZyc+VFhQIFR3ZWV0PC9oMT4iCiAg
ICAgICAgLiI8cCBjbGFzcz0nbmF2LXRlcnRpYXJ5Jz4iCiAgICAgICAgLiI8YSBocmVmPScu
Lz9ldmVudD1hcmNfYWRtaW5fdHdpdHRlcicgY2xhc3M9J25hdmxpbmsnPlR3aXR0ZXI8L2E+
PGEgaHJlZj0nLi8/ZXZlbnQ9cGx1Z2luX3ByZWZzLmFyY190d2l0dGVyJyBjbGFzcz0nbmF2
bGluay1hY3RpdmUnPk9wdGlvbnM8L2E+IgogICAgICAgIC4iPC9wPiI7CgogICAgICAkaHRt
bCAuPSBmb3JtKCI8ZGl2IGNsYXNzPSdwbHVnaW4tY29sdW1uJz4iLiRmb3JtLiI8L2Rpdj4i
LCAiIGNsYXNzPSdlZGl0LWZvcm0nIik7CgogICAgICAgIH0gZWxzZWlmICggJHN0ZXAhPSdy
ZWdpc3RlcicgKSB7CgogICAgICAgICAgICAkcmVnaXN0ZXJVUkwgPSBhcmNfdHdpdHRlcjo6
Y2FsbGJhY2tVUkwoJGV2ZW50LCdyZWdpc3RlcicpOwoKICAgICAgICAgICAgJGZvcm0gPSAi
PGgyPlR3aXR0ZXIgYWNjb3VudCBkZXRhaWxzPC9oMj4iCiAgICAgICAgLiI8c3BhbiBjbGFz
cz0nZWRpdC1sYWJlbCc+VHdpdHRlciB1c2VybmFtZTwvc3Bhbj4iCiAgICAgICAgLiI8c3Bh
biBjbGFzcz0nZWRpdC12YWx1ZSc+PGVtPnVua25vd248L2VtPiAmbWRhc2g7ICIKICAgICAg
ICAuaHJlZignQ29ubmVjdCB0byBUd2l0dGVyJywkcmVnaXN0ZXJVUkwpCiAgICAgICAgICAg
ICAgICAuIjwvc3Bhbj4iOwoKICAgICAgJGh0bWwgPSBmb3JtKCI8ZGl2IGNsYXNzPSdwbHVn
aW4tY29sdW1uJz4iLiRmb3JtLiI8L2Rpdj4iLCAiIGNsYXNzPSdlZGl0LWZvcm0nIik7Cgog
ICAgICAgIH0KICAgIH0KCiAgICAvLyBTZXQgalF1ZXJ5IGZvciBzd2l0Y2hpbmcgb24vb2Zm
IHJlbGV2YW50IGFyY19zaG9ydF91cmwgZmllbGRzCiAgICAkanMgPSA8PDxKUwo8c2NyaXB0
IGxhbmd1YWdlPSJqYXZhc2NyaXB0IiB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPgokKGRvY3Vt
ZW50KS5yZWFkeShmdW5jdGlvbigpewogIHZhciBvbm9mZiA9ICQoJy5hcmNfc2hvcnRfdXJs
Jyk7CiAgdmFyIGFyY19zaG9ydF91cmxfb2ZmID0gJCgnI2FyY19zaG9ydF91cmwtYXJjX3No
b3J0X3VybC0wJyk7CiAgdmFyIHVybCA9ICQoJy5hcmNfc2hvcnRfc2l0ZV91cmwnKTsKICB2
YXIgdXJsX21ldGhvZCA9ICQoJ3NlbGVjdFtuYW1lPSJhcmNfdHdpdHRlcl91cmxfbWV0aG9k
Il0nKTsKCiAgaWYgKGFyY19zaG9ydF91cmxfb2ZmLmF0dHIoJ2NoZWNrZWQnKT09J2NoZWNr
ZWQnICYmICQoJ29wdGlvbjpzZWxlY3RlZCcsIHVybF9tZXRob2QpLnZhbCgpIT0nYXJjX3R3
aXR0ZXInKSB7CiAgICB1cmwuaGlkZSgpOwogIH0KICAkKCdpbnB1dCcsIG9ub2ZmKS5jaGFu
Z2UoZnVuY3Rpb24oKXsKICAgIGlmICgkKCdvcHRpb246c2VsZWN0ZWQnLCB1cmxfbWV0aG9k
KS52YWwoKSE9J2FyY190d2l0dGVyJykgewogICAgICBhcmNfc2hvcnRfdXJsX29mZi5hdHRy
KCdjaGVja2VkJyk9PSdjaGVja2VkJyA/IHVybC5oaWRlKCkgOiB1cmwuc2hvdygpOwogICAg
fQogIH0pOwoKICBpZiAoJCgnb3B0aW9uOnNlbGVjdGVkJywgdXJsX21ldGhvZCkudmFsKCk9
PSdhcmNfdHdpdHRlcicpIHsKICAgIG9ub2ZmLmhpZGUoKTsgdXJsLnNob3coKTsKICB9CiAg
dXJsX21ldGhvZC5jaGFuZ2UoZnVuY3Rpb24oKXsKICAgIGlmICgkKCdvcHRpb246c2VsZWN0
ZWQnLCB1cmxfbWV0aG9kKS52YWwoKT09J2FyY190d2l0dGVyJykgewogICAgICBvbm9mZi50
b2dnbGUoKTsgdXJsLnNob3coKTsKICAgIH0gZWxzZSB7CiAgICAgIG9ub2ZmLnRvZ2dsZSgp
OwogICAgICBhcmNfc2hvcnRfdXJsX29mZi5hdHRyKCdjaGVja2VkJyk9PSdjaGVja2VkJyA/
IHVybC5oaWRlKCkgOiB1cmwuc2hvdygpOwogICAgfQogIH0pCn0pOwo8L3NjcmlwdD4KSlM7
CgogICAgZWNobyAkanMuJGh0bWw7Cn0KCmZ1bmN0aW9uIF9hcmNfdHdpdHRlcl9mb3JtX2J1
aWxkZXIoJGZpZWxkcykgewoKICAkZm9ybSA9ICcnOwoKICBmb3JlYWNoICgkZmllbGRzIGFz
ICRmayA9PiAkZnYpIHsKCiAgICAkZm9ybSAuPSAoJGZrKSA/ICI8aDI+JGZrPC9oMj4iIDog
Jyc7CgogICAgZm9yZWFjaCAoJGZ2IGFzICRrID0+ICR2KSB7CgogICAgICAkdHlwZSA9IGlz
c2V0KCR2Wyd0eXBlJ10pID8gJHZbJ3R5cGUnXSA6ICd0ZXh0JzsKCiAgICAgICRmb3JtIC49
ICI8cCBjbGFzcz0nJGsnPiIKICAgICAgICAuIjxzcGFuIGNsYXNzPSdlZGl0LWxhYmVsJz48
bGFiZWwgZm9yPSckayc+Ii4kdlsnbGFiZWwnXS4iPC9sYWJlbD48L3NwYW4+IjsKCiAgICAg
IHN3aXRjaCAoJHR5cGUpICB7CgogICAgICAgIGNhc2UgJ3RleHRhcmVhJzoKCiAgICAgICAg
ICAkZm9ybSAuPSB0ZXh0X2FyZWEoJGssICc1MCcsICc1NTAnLCAkdlsndmFsdWUnXSwgJGsp
OwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgJ3llc25vUmFkaW8nOgoKICAgICAg
ICAgICRmb3JtIC49ICI8c3BhbiBjbGFzcz0nZWRpdC12YWx1ZSc+Ii55ZXNub1JhZGlvKCRr
LCAkdlsndmFsdWUnXSwgJycsICRrKS4iPC9zcGFuPiI7CiAgICAgICAgICBicmVhazsKCiAg
ICAgICAgY2FzZSAnYXJjX3R3aXR0ZXJfdGFiX3NlbGVjdCc6CgogICAgICAgICAgJGZvcm0g
Lj0gIjxzcGFuIGNsYXNzPSdlZGl0LXZhbHVlJz4iLmFyY190d2l0dGVyX3RhYl9zZWxlY3Qo
JGssICR2Wyd2YWx1ZSddKS4iPC9zcGFuPiI7CiAgICAgICAgICBicmVhazsKCiAgICAgICAg
Y2FzZSAnYXJjX3R3aXR0ZXJfdXJsX21ldGhvZF9zZWxlY3QnOgoKICAgICAgICAgICRmb3Jt
IC49ICI8c3BhbiBjbGFzcz0nZWRpdC12YWx1ZSc+Ii5hcmNfdHdpdHRlcl91cmxfbWV0aG9k
X3NlbGVjdCgkaywgJHZbJ3ZhbHVlJ10pLiI8L3NwYW4+IjsKICAgICAgICAgIGJyZWFrOwoK
ICAgICAgICBkZWZhdWx0OgoKICAgICAgICAgICRmb3JtIC49ICI8c3BhbiBjbGFzcz0nZWRp
dC12YWx1ZSc+Ii5mSW5wdXQoJ3RleHQnLCRrLCR2Wyd2YWx1ZSddLCcnLCcnLCcnLCcnLCcn
LCRrKS4iPC9zcGFuPiI7CiAgICAgICAgICBicmVhazsKCiAgICAgIH0KCiAgICAgICRmb3Jt
IC49ICI8L3A+IjsKICAgIH0KCiAgfQoKICByZXR1cm4gJGZvcm07Cn0KCi8vIEFkZCBUd2l0
dGVyIHRhYiB0byBUZXh0cGF0dGVybgpmdW5jdGlvbiBhcmNfYWRtaW5fdHdpdHRlcigkZXZl
bnQsJHN0ZXApCnsKICAgIGdsb2JhbCAkcHJlZnMsICRhcmNfdHdpdHRlcl9jb25zdW1lcktl
eSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKICAgICR0d2l0ID0gbmV3IGFyY190
d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAgICAsICRhcmNfdHdp
dHRlcl9jb25zdW1lclNlY3JldCwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlbidd
CiAgICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCdd
KTsKCiAgICAkdHdpdC0+Y2FjaGVEaXIoJHByZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9kaXIn
XSk7CgogICAgJGRhdGEgPSAkdHdpdC0+Z2V0KCd1c2Vycy9zaG93JwogICAgICAgICwgYXJy
YXkoJ3NjcmVlbl9uYW1lJz0+JHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10pKTsKICAgICR0
d2l0dGVyVXNlciA9ICRkYXRhOwogICAgJHR3aXR0ZXJVc2VyVVJMID0gJ2h0dHA6Ly93d3cu
dHdpdHRlci5jb20vJy4kdHdpdHRlclVzZXItPnNjcmVlbl9uYW1lOwoKICAgIGlmICgkc3Rl
cD09InR3ZWV0IikgeyAvLyBwb3N0IGFuIHVwZGF0ZSB0byBUd2l0dGVyCgogICAgICAgIC8v
IGZldGNoIGFuZCBjbGVhbiBtZXNzYWdlCiAgICAgICAgJG1lc3NhZ2UgPSBzdHJpcF90YWdz
KGdwcygnbWVzc2FnZScpKTsKICAgICAgICAkY291bnQgPSBzdHJsZW4oJG1lc3NhZ2UpOwoK
ICAgICAgICBpZiAoJGNvdW50PD0xNDAgJiYgJGNvdW50PjApIHsgLy8gcG9zdCB1cGRhdGUK
ICAgICAgICAgICAgJHJlc3VsdCA9ICR0d2l0LT5wb3N0KCdzdGF0dXNlcy91cGRhdGUnLCBh
cnJheSgnc3RhdHVzJyA9PiAkbWVzc2FnZSkpOwogICAgICAgIH0gZWxzZSB7IC8vIG1lc3Nh
Z2UgdG9vIGxvbmcsIEphdmFTY3JpcHQgaW50ZXJmYWNlIHNob3VsZCBwcmV2ZW50IHRoaXMK
ICAgICAgICAgICAgJHJlc3VsdCA9IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgcGFnZXRv
cCgnVHdpdHRlcicsCiAgICAgICAgICAgICgoJHJlc3VsdCE9ZmFsc2UpPydUd2l0dGVyIHVw
ZGF0ZWQnOidFcnJvciB1cGRhdGluZyBUd2l0dGVyJykpOwoKICAgIH0gZWxzZWlmICgkc3Rl
cD09ImRlbGV0ZSIpIHsgLy8gZGVsZXRlIGFuIHVwZGF0ZSBmcm9tIFR3aXR0ZXIKCiAgICAg
ICAgJGlkID0gc3RyaXBfdGFncyhncHMoJ2lkJykpOwogICAgICAgIGlmICgkaWQpIHsKICAg
ICAgICAgICAgJHR3aXQtPmRlbGV0ZSgnc3RhdHVzZXMvZGVzdHJveScuJGlkKTsKICAgICAg
ICAgICAgc2FmZV9kZWxldGUoJ2FyY190d2l0dGVyJywidHdlZXRfaWQgPSAkaWQiKTsKICAg
ICAgICB9CgogICAgICAgIHBhZ2V0b3AoJ1R3aXR0ZXInLCdUd2l0dGVyIHVwZGF0ZWQnKTsK
CiAgICB9IGVsc2UgewoKICAgICAgICBwYWdldG9wKCdUd2l0dGVyJyk7CgogICAgfQoKICAg
IC8vIFByZXBhcmUgSmF2YVNjcmlwdCB0byBjcmVhdGUgVHdpdHRlciB1cGRhdGUgaW50ZXJm
YWNlCgogICAgJGpzID0gJzxzY3JpcHQgbGFuZ3VhZ2U9ImphdmFzY3JpcHQiIHR5cGU9InRl
eHQvamF2YXNjcmlwdCI+JzsKICAgICRqcy49IDw8PEpTCiAgICAkKGRvY3VtZW50KS5yZWFk
eShmdW5jdGlvbigpewogICAgdmFyIGNvdW50ZXIgPSAkKCc8c3Bhbj4nLCB7CiAgICAgICAg
J3RleHQnIDogJzE0MCcsCiAgICAgICAgJ2lkJyA6ICd0d2VldGNvdW50JwogICAgICB9KTsK
ICAgICQoJy5tZXNzYWdlJykuYXBwZW5kKGNvdW50ZXIpOwogICAgICAgICAgICB2YXIgY291
bnRlclN0eWxlID0gJ2ZvbnQtd2VpZ2h0OmJvbGQ7cGFkZGluZy1sZWZ0Oi41ZW07Zm9udC1z
aXplOjJlbTtsaW5lLWhlaWdodDoxLjJlbTsnOwogICAgICAgICAgICAkKCcjdHdlZXRjb3Vu
dCcpLmF0dHIoJ3N0eWxlJywgY291bnRlclN0eWxlKydjb2xvcjojY2NjOycpOwogICAgICAg
ICAgICAkKCcjbWVzc2FnZScpLmtleXVwKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAg
dmFyIGNvdW50ID0gMTQwLSQoJyNtZXNzYWdlJykudmFsKCkubGVuZ3RoOwogICAgICAgICAg
ICAgICAgJCgnI3R3ZWV0Y291bnQnKS5odG1sKGNvdW50KycnKTsgLy8gaGFjayB0byBmb3Jj
ZSBvdXRwdXQgb2YgMAogICAgICAgICAgICAgICAgaWYgKGNvdW50PDApIHsKICAgICAgICAg
ICAgICAgICAgICAkKCdpbnB1dC5wdWJsaXNoJykucHJvcCgnZGlzYWJsZWQnLCAnZGlzYWJs
ZWQnKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJCgn
aW5wdXQucHVibGlzaCcpLnByb3AoJ2Rpc2FibGVkJywgJycpOwogICAgICAgICAgICAgICAg
fQogICAgICAgICAgICAgICAgaWYgKGNvdW50PDApIHsKICAgICAgICAgICAgICAgICAgICAk
KCcjdHdlZXRjb3VudCcpLmF0dHIoJ3N0eWxlJywgY291bnRlclN0eWxlKydjb2xvcjojZjAw
OycpOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb3VudDwxMCkgewogICAgICAgICAg
ICAgICAgICAgICQoJyN0d2VldGNvdW50JykuYXR0cignc3R5bGUnLCBjb3VudGVyU3R5bGUr
J2NvbG9yOiMwMDA7Jyk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAg
ICAgICAgICQoJyN0d2VldGNvdW50JykuYXR0cignc3R5bGUnLCBjb3VudGVyU3R5bGUrJ2Nv
bG9yOiNjY2M7Jyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAg
fSk7CkpTOwogICAgJGpzLj0gIjwvc2NyaXB0PiI7CgogICAgJG91dCA9ICcnOwogICAgJHR3
ZWV0cyA9ICR0d2l0LT5nZXQoJ3N0YXR1c2VzL3VzZXJfdGltZWxpbmUnCiAgICAgICAgLCBh
cnJheSgnc2NyZWVuX25hbWUnPT4kcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSwnY291bnQn
PT4yNSkpOwogICAgaWYgKCR0d2VldHMpIGZvcmVhY2ggKCR0d2VldHMgYXMgJHR3ZWV0KSB7
CiAgICAgICAgJHRpbWUgPSBzdHJ0b3RpbWUoaHRtbGVudGl0aWVzKCR0d2VldC0+Y3JlYXRl
ZF9hdCkpOwogICAgICAgICRkYXRlID0gc2FmZV9zdHJmdGltZSgkcHJlZnNbJ2FyY2hpdmVf
ZGF0ZWZvcm1hdCddLCR0aW1lKTsKICAgICAgICAkb3V0Lj0gdHIodGQoJGRhdGUsJ3NwYW4n
KQogICAgICAgICAgICAudGQoYXJjX1R3aXR0ZXI6Om1ha2VMaW5rcyhodG1sZW50aXRpZXMo
JHR3ZWV0LT50ZXh0CiAgICAgICAgICAgICAgICAsIEVOVF9RVU9URVMsJ1VURi04JykpKQog
ICAgICAgICAgICAudGQoZExpbmsoJ2FyY19hZG1pbl90d2l0dGVyJywnZGVsZXRlJywnaWQn
LCR0d2VldC0+aWQsJycpKQogICAgICAgICAgICApOwogICAgfQoKICAgICRmaWVsZHMgPSBh
cnJheSgKICAgICcnID0+IGFycmF5KAogICAgICAnbWVzc2FnZScgPT4gYXJyYXkoCiAgICAg
ICAgJ2xhYmVsJyA9PiAnVXBkYXRlIFR3aXR0ZXInLAogICAgICAgICd0eXBlJyA9PiAndGV4
dGFyZWEnLAogICAgICAgICd2YWx1ZScgPT4gJycKICAgICAgKQogICAgKQogICAgKTsKCiAg
ICAkcHJvZmlsZSA9ICc8aW1nIHNyYz0iJy4kdHdpdHRlclVzZXItPnByb2ZpbGVfaW1hZ2Vf
dXJsLiciIGFsdD0iVHdpdHRlciBhdmF0YXIiIHN0eWxlPSJmbG9hdDpsZWZ0OyBtYXJnaW4t
cmlnaHQ6IDFlbSIgLz4nCiAgICAuZ3JhZihocmVmKCR0d2l0dGVyVXNlci0+bmFtZSwkdHdp
dHRlclVzZXJVUkwpLCcgc3R5bGU9ImZvbnQtc2l6ZToxLjJlbTtmb250LXdlaWdodDpib2xk
OyInKQogICAgLmdyYWYoaHJlZigkdHdpdHRlclVzZXItPmZyaWVuZHNfY291bnQuJyBmb2xs
b3dpbmcnLCR0d2l0dGVyVXNlclVSTC4nL2ZvbGxvd2luZycpCiAgICAuJywgJy5ocmVmKCR0
d2l0dGVyVXNlci0+Zm9sbG93ZXJzX2NvdW50LicgZm9sbG93ZXJzJywkdHdpdHRlclVzZXJV
UkwuJy9mb2xsb3dlcnMnKQogICAgLicsICcuaHJlZigkdHdpdHRlclVzZXItPnN0YXR1c2Vz
X2NvdW50LicgdXBkYXRlcycsJHR3aXR0ZXJVc2VyVVJMKSk7CgogICAgJGZvcm0gPSBfYXJj
X3R3aXR0ZXJfZm9ybV9idWlsZGVyKCRmaWVsZHMpCiAgICAuZUlucHV0KCdhcmNfYWRtaW5f
dHdpdHRlcicpCiAgICAuc0lucHV0KCd0d2VldCcpOwogICRmb3JtIC49ICc8cD4nLmZJbnB1
dCgnc3VibWl0JywgJ1N1Ym1pdCcsIGdUeHQoJ1VwZGF0ZScpLCAncHVibGlzaCcpLic8L3A+
JzsKCiAgJGh0bWwgPSAiPGgxIGNsYXNzPSd0eHAtaGVhZGluZyc+VFhQIFR3ZWV0PC9oMT4i
CiAgICAuIjxwIGNsYXNzPSduYXYtdGVydGlhcnknPiIKICAgIC4iPGEgaHJlZj0nLi8/ZXZl
bnQ9YXJjX2FkbWluX3R3aXR0ZXInIGNsYXNzPSduYXZsaW5rLWFjdGl2ZSc+VHdpdHRlcjwv
YT48YSBocmVmPScuLz9ldmVudD1wbHVnaW5fcHJlZnMuYXJjX3R3aXR0ZXInIGNsYXNzPSdu
YXZsaW5rJz5PcHRpb25zPC9hPiIKICAgIC4iPC9wPiI7CgogICAgJGh0bWwgLj0gIjxkaXYg
Y2xhc3M9J3RleHQtY29sdW1uJz4iLiRwcm9maWxlLiI8L2Rpdj4iCiAgICAuIjxiciBzdHls
ZT0nY2xlYXI6Ym90aCcgLz4iCiAgICAuZm9ybSgiPGRpdiBjbGFzcz0ncGx1Z2luLWNvbHVt
bic+Ii4kZm9ybS4iPC9kaXY+Ii5icik7CgogICAgLy8gQXR0YWNoIHJlY2VudCBUd2l0dGVy
IHVwZGF0ZXMKCiAgICAkaHRtbC49ICI8ZGl2IGNsYXNzPSd0eHAtbGlzdHRhYmxlcyc+Igog
ICAgLnN0YXJ0VGFibGUoJ2FyY190d2l0dGVyX3RpbWVsaW5lJywnJywndHhwLWxpc3QnKS4k
b3V0LmVuZFRhYmxlKCkKICAgIC4iPC9kaXY+IjsKCiAgICAvLyBPdXRwdXQgSmF2YVNjcmlw
dCBhbmQgSFRNTAoKICAgIGVjaG8gJGpzLiRodG1sOwp9CgovLyBBZGQgVHdpdHRlciBvcHRp
b25zIHRvIGFydGljbGUgYXJ0aWNsZSBzY3JlZW4KZnVuY3Rpb24gYXJjX2FwcGVuZF90d2l0
dGVyKCRldmVudCwgJHN0ZXAsICRkYXRhLCAkcnMxKQp7CiAgICBnbG9iYWwgJHByZWZzLCAk
YXJjX3R3aXR0ZXIsICRhcHBfbW9kZTsKCiAgICAkcHJlZml4ID0gdHJpbShncHMoJ2FyY190
d2l0dGVyX3ByZWZpeCcpKTsKICAgICRwcmVmaXggPSAoJHByZWZpeCkgPyAkcHJlZml4IDog
JHByZWZzWydhcmNfdHdpdHRlcl9wcmVmaXgnXTsKICAgICRzdWZmaXggPSB0cmltKGdwcygn
YXJjX3R3aXR0ZXJfc3VmZml4JykpOwogICAgJHN1ZmZpeCA9ICgkc3VmZml4KSA/ICRzdWZm
aXggOiAkcHJlZnNbJ2FyY190d2l0dGVyX3N1ZmZpeCddOwoKICAgIGlmICgkcnMxWydJRCdd
KSB7CiAgICAgICAgJHNxbCA9ICJTRUxFQ1QgdHdlZXRfaWQsdHdlZXQgRlJPTSAiLlBGWC4i
YXJjX3R3aXR0ZXIgV0hFUkUgYXJ0aWNsZV9pZD0iLiRyczFbJ0lEJ10uIjsiOwogICAgICAg
ICRyczIgPSBzYWZlX3F1ZXJ5KCRzcWwpOyAkcnMyID0gbmV4dFJvdygkcnMyKTsKICAgIH0g
ZWxzZSB7IC8vIG5ldyBhcnRpY2xlCiAgICAgICAgJHJzMiA9ICcnOwogICAgfQoKICAgIGlm
ICgkYXBwX21vZGUgPT0gJ2FzeW5jJykKICAgIHsKICAgICBzZW5kX3NjcmlwdF9yZXNwb25z
ZSgnJCgiI2FyY190d2l0dGVyIikucmVtb3ZlKCk7Jyk7CiAgICB9CgogICAgaWYgKCRyczFb
J0lEJ10gJiYgJHJzMlsndHdlZXRfaWQnXSkgewogICAgICAgICRjb250ZW50ID0gdGFnKGFy
Y19Ud2l0dGVyOjptYWtlTGlua3MoJHJzMlsndHdlZXQnXSksJ3AnKTsKICAgICAgICByZXR1
cm4gJGRhdGEuZmllbGRzZXQoJGNvbnRlbnQsICdUd2l0dGVyIHVwZGF0ZScsICdhcmNfdHdp
dHRlcicpOwogICAgfSBlbHNlIHsKICAgICAgICAkdmFyID0gZ3BzKCdhcmNfdHdlZXRfdGhp
cycpOwogICAgICAgICR2YXIgPSAoJHJzMVsnSUQnXSYmISR2YXIpID8gMCA6ICRwcmVmc1sn
YXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCddOwogICAgICAgICRjb250ZW50ICA9IHRhZyh5
ZXNub1JhZGlvKCdhcmNfdHdlZXRfdGhpcycsICR2YXIsICcnLCAnYXJjX3R3ZWV0X3RoaXMn
KSwncCcpOwogICAgICAgICRjb250ZW50IC49IHRhZyhocmVmKCdPcHRpb25zJywnI2FyY190
d2l0dGVyX29wdGlvbnMnLCAnIG9uY2xpY2s9IiQoXCcjYXJjX3R3aXR0ZXJfb3B0aW9uc1wn
KS50b2dnbGUoKTsgcmV0dXJuIGZhbHNlOyInKSwncCcsJyBzdHlsZT0ibWFyZ2luLXRvcDo1
cHg7IicpOwogICAgICAgICRjb250ZW50IC49IHRhZyh0YWcodGFnKCdUd2VldCBwcmVmaXgn
LCdsYWJlbCcsICcgZm9yPSJhcmNfdHdpdHRlcl9wcmVmaXgiJykKICAgICAgICAgICAgLmZJ
bnB1dCgndGV4dCcsJ2FyY190d2l0dGVyX3ByZWZpeCcsJHByZWZpeCwnZWRpdCcsJycsJycs
JzIyJywnJywnYXJjX3R3aXR0ZXJfcHJlZml4JyksJ3AnKQogICAgICAgICAgICAudGFnKHRh
ZygnVHdlZXQgc3VmZml4IChlZyAjaGFzaHRhZ3MpJywnbGFiZWwnLCAnIGZvcj0iYXJjX3R3
aXR0ZXJfc3VmZml4IicpCiAgICAgICAgICAgIC5mSW5wdXQoJ3RleHQnLCdhcmNfdHdpdHRl
cl9zdWZmaXgnLCRzdWZmaXgsJ2VkaXQnLCcnLCcnLCcyMicsJycsJ2FyY190d2l0dGVyX3N1
ZmZpeCcpLCdwJykKICAgICAgICAgICAgLCdkaXYnLCcgaWQ9ImFyY190d2l0dGVyX29wdGlv
bnMiIGNsYXNzPSJ0b2dnbGUiIHN0eWxlPSJkaXNwbGF5Om5vbmUiJyk7CiAgICAgICAgaWYg
KGlzc2V0KCRhcmNfdHdpdHRlclsnZXJyb3InXSkpIHsKICAgICAgICAgICAgJGNvbnRlbnQg
Lj0gJzxwPicuJGFyY190d2l0dGVyWydlcnJvciddLic8L3A+JzsKICAgICAgICB9CiAgICAg
ICAgcmV0dXJuICRkYXRhLmZpZWxkc2V0KCRjb250ZW50LCAnVXBkYXRlIFR3aXR0ZXInLCAn
YXJjX3R3aXR0ZXInKTsKICAgIH0KCn0KCi8vIFVwZGF0ZSBUd2l0dGVyIHdpdGggcG9zdGVk
IGFydGljbGUKZnVuY3Rpb24gYXJjX2FydGljbGVfdHdlZXQoJGV2ZW50LCRzdGVwKQp7CiAg
ICBnbG9iYWwgJHByZWZzLCAkYXJjX3R3aXR0ZXIsICRhcmNfdHdpdHRlcl9jb25zdW1lcktl
eQogICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKICAgICRhcnRpY2xl
X2lkID0gZW1wdHkoJEdMT0JBTFNbJ0lEJ10pID8gZ3BzKCdJRCcpIDogJEdMT0JBTFNbJ0lE
J107CiAgICBpZiAoIWVtcHR5KCRhcnRpY2xlX2lkKSkgewoKICAgICAgICBpbmNsdWRlX29u
Y2UgdHhwYXRoLicvcHVibGlzaC90YWdoYW5kbGVycy5waHAnOwoKICAgICAgICAkYXJ0aWNs
ZSA9IHNhZmVfcm93KCJJRCwgVGl0bGUsIFNlY3Rpb24sIFBvc3RlZCIsICd0ZXh0cGF0dGVy
bicsCiAgICAgICAgICAgICJJRD17JGFydGljbGVfaWR9IEFORCBTdGF0dXM9NCBBTkQgbm93
KCk+PVBvc3RlZCIpOwoKICAgICAgICBpZiAoJGFydGljbGUgJiYgZ3BzKCdhcmNfdHdlZXRf
dGhpcycpKSB7IC8vIHR3ZWV0IGFydGljbGUKCiAgICAgICAgICAgIC8vIE5lZWQgdG8gbWFu
dWFsbHkgdXBkYXRlIHRoZSAnVVJMIG9ubHkgdGl0bGUnIGJlZm9yZSBidWlsZGluZyB0aGUK
ICAgICAgICAgICAgLy8gVVJMCiAgICAgICAgICAgICRhcnRpY2xlWyd1cmxfdGl0bGUnXSA9
IGdwcygndXJsX3RpdGxlJyk7CiAgICAgICAgICAgIC8vIE1ha2Ugc2hvcnQgVVJMCiAgICAg
ICAgICAgICR1cmwgPSBwZXJtbGlua3VybCgkYXJ0aWNsZSk7CiAgICAgICAgICAgICRzaG9y
dF91cmwgPSBhcmNfc2hvcnRlbl91cmwoJHVybCwkcHJlZnNbJ2FyY190d2l0dGVyX3VybF9t
ZXRob2QnXSwKICAgICAgICAgICAgICAgIGFycmF5KCdpZCc9PiRhcnRpY2xlX2lkKSk7Cgog
ICAgICAgICAgICBpZiAoISRzaG9ydF91cmwpIHsgLy8gRmFpbGVkIHRvIG9idGFpbiBhIHNo
b3J0ZW5lZCBVUkwsIGRvIG5vdCB0d2VldCEKICAgICAgICAgICAgICAgICRhcmNfdHdpdHRl
clsnZXJyb3InXSA9ICdVbmFibGUgdG8gb2J0YWluIGEgc2hvcnQgVVJMIGZvciB0aGlzIGFy
dGljbGUuJzsKCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0K
CiAgICAgICAgICAgIC8vIENvbnN0cnVjdCBUd2l0dGVyIHVwZGF0ZQogICAgICAgICAgICAk
cHJlZml4ICA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9wcmVmaXgnKSk7CiAgICAgICAgICAg
ICRwcmVfbGVuID0gc3RybGVuKCRwcmVmaXgpOwogICAgICAgICAgICAkcHJlZml4ICA9ICgk
cHJlZml4ICYmICRwcmVfbGVuPD0yMCkgPyAkcHJlZml4LicgJyA6ICcnOwogICAgICAgICAg
ICAkc3VmZml4ICA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9zdWZmaXgnKSk7CiAgICAgICAg
ICAgICRzdWZfbGVuID0gc3RybGVuKCRzdWZmaXgpOwogICAgICAgICAgICAkc3VmZml4ICA9
ICgkc3VmZml4ICYmICRzdWZfbGVuPD00MCkgPyAnICcuJHN1ZmZpeCA6ICcnOwogICAgICAg
ICAgICAkdXJsX2xlbiA9IHN0cmxlbigkc2hvcnRfdXJsKSsxOyAvLyBjb3VudCBVUkwgbGVu
Z3RoICsgMSBmb3IgcHJlZml4ZWQgc3BhY2UKICAgICAgICAgICAgaWYgKCRwcmVmaXgpICRw
cmVfbGVuICs9IDE7CiAgICAgICAgICAgIGlmICgkc3VmZml4KSAkc3VmX2xlbiArPSAxOwog
ICAgICAgICAgICBpZiAoKHN0cmxlbigkYXJ0aWNsZVsnVGl0bGUnXSkrJHVybF9sZW4rJHBy
ZV9sZW4rJHN1Zl9sZW4pPjE0MCkgewogICAgICAgICAgICAgICAgJGFydGljbGVbJ1RpdGxl
J10gPSBzdWJzdHIoJGFydGljbGVbJ1RpdGxlJ10sMCwxMzUtJHVybF9sZW4tJHByZV9sZW4t
JHN1Zl9sZW4pLicuLi4nOwogICAgICAgICAgICB9CiAgICAgICAgICAgICR0d2VldCA9ICRw
cmVmaXguJGFydGljbGVbJ1RpdGxlJ10uIiAiLiRzaG9ydF91cmwuJHN1ZmZpeDsKCiAgICAg
ICAgICAgIC8vIFVwZGF0ZSBUd2l0dGVyCiAgICAgICAgICAgICR0d2l0ID0gbmV3IGFyY190
d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAgICAgICAgLCAkYXJj
X3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9r
ZW4nXQogICAgICAgICAgICAgICAgLCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2Vu
U2VjcmV0J10pOwogICAgICAgICAgICAkcmVzdWx0ID0gJHR3aXQtPnBvc3QoJ3N0YXR1c2Vz
L3VwZGF0ZScsIGFycmF5KCdzdGF0dXMnID0+ICR0d2VldCkpOwoKICAgICAgICAgICAgJHR3
ZWV0X2lkID0gKGlzX29iamVjdCgkcmVzdWx0KSkgPyAkcmVzdWx0WzBdLT5pZCA6IDA7Cgog
ICAgICAgICAgICBpZiAoJHR3ZWV0X2lkKSB7CgogICAgICAgICAgICAgICAgJHR3ZWV0ID0g
YWRkc2xhc2hlcygkdHdlZXQpOwoKICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSBhcmNfdHdp
dHRlciB0YWJsZSB3aXRoIHR3ZWV0CiAgICAgICAgICAgICAgICAkc3FsID0gIklOU0VSVCBJ
TlRPICIuUEZYLiJhcmNfdHdpdHRlciAoYXJ0aWNsZV9pZCx0d2VldF9pZCx0d2VldCx0aW55
dXJsKSAiOwogICAgICAgICAgICAgICAgJHNxbC49ICJWQUxVRVMoJGFydGljbGVfaWQsJHR3
ZWV0X2lkLFwiJHR3ZWV0XCIsJyRzaG9ydF91cmwnKTsiOwogICAgICAgICAgICAgICAgc2Fm
ZV9xdWVyeSgkc3FsKTsKCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICAgICAg
ICAgIH0gZWxzZSB7CgogICAgICAgICAgICAgICAgJGFyY190d2l0dGVyWydlcnJvciddID0g
J1R3aXR0ZXIgcmVzcG9uc2U6ICcKICAgICAgICAgICAgICAgICAgICAuJHR3aXQtPmh0dHBf
Y29kZTsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgICAgIH0KCiAg
ICAgICAgfQoKICAgIH0KCiAgICByZXR1cm4gZmFsc2U7Cgp9CgovKgogKiBTaG9ydGVuIFVS
THMgdXNpbmcgdmFyaW91cyBtZXRob2RzCiAqLwoKZnVuY3Rpb24gYXJjX3Nob3J0ZW5fdXJs
KCR1cmwsICRtZXRob2Q9JycsICRhdHRzPWFycmF5KCkpCnsKICBnbG9iYWwgJHByZWZzOwoK
ICAkY2ggPSBjdXJsX2luaXQoKTsKICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfSEVBREVS
LCAwKTsKICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUkVUVVJOVFJBTlNGRVIsIHRydWUp
OwogIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9USU1FT1VULCAxMCk7CgogIHN3aXRjaCAo
JG1ldGhvZCkgewogICAgY2FzZSAnc21kJzogLy8gY3JlYXRlIGEgc2hvcnRlbmVkIFVSTCB1
c2luZyBTTUQgU2hvcnQgVVJMCiAgICAgIHJldHVybiAoJGF0dHNbJ2lkJ10pID8gaHUuJGF0
dHNbJ2lkJ10gOiBmYWxzZTsgYnJlYWs7CiAgICBjYXNlICdhcmNfdHdpdHRlcic6IC8vIG5h
dGl2ZSBVUkwgc2hvcnRlbmluZwoKICAgICAgcmV0dXJuICgkYXR0c1snaWQnXSkgPyBQUk9U
T0NPTC4kcHJlZnNbJ2FyY19zaG9ydF9zaXRlX3VybCddLicvJy4kYXR0c1snaWQnXSA6IGZh
bHNlOwogICAgICBicmVhazsKCiAgICBjYXNlICdpc2dkJzoKCiAgICAgICR1ID0gJ2h0dHA6
Ly9pcy5nZC9hcGkucGhwP2xvbmd1cmw9Jy51cmxlbmNvZGUoJHVybCk7CiAgICAgIGN1cmxf
c2V0b3B0KCRjaCwgQ1VSTE9QVF9VUkwsICR1KTsKCiAgICAgICR0aW55dXJsID0gY3VybF9l
eGVjKCRjaCk7CiAgICAgIGlmICgkdGlueXVybCE9J0Vycm9yJyAmJiAkdGlueXVybCE9Jycp
IHsKICAgICAgICByZXR1cm4gJHRpbnl1cmw7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdHJp
Z2dlcl9lcnJvcignYXJjX3R3aXR0ZXIgZmFpbGVkIHRvIGdldCBhIGlzLmdkIFVSTCBmb3Ig
JwogICAgICAgICAgICAuJHVybCxFX1VTRVJfV0FSTklORyk7CiAgICAgIH0KICAgICAgYnJl
YWs7CgogICAgY2FzZSAndGlueXVybCc6IGRlZmF1bHQ6IC8vIGNyZWF0ZSBhIHNob3J0ZW5l
ZCBVUkwgdXNpbmcgVGlueVVSTAoKICAgICAgJHUgPSAnaHR0cDovL3Rpbnl1cmwuY29tL2Fw
aS1jcmVhdGUucGhwP3VybD0nLnVybGVuY29kZSgkdXJsKTsKICAgICAgY3VybF9zZXRvcHQo
JGNoLCBDVVJMT1BUX1VSTCwgJHUpOwogICAgICAkdGlueXVybCA9IGN1cmxfZXhlYygkY2gp
OwogICAgICBpZiAoJHRpbnl1cmwhPSdFcnJvcicgJiYgJHRpbnl1cmwhPScnKSB7CiAgICAg
ICAgcmV0dXJuICR0aW55dXJsOwogICAgICB9IGVsc2UgewogICAgICAgIHRyaWdnZXJfZXJy
b3IoJ2FyY190d2l0dGVyIGZhaWxlZCB0byBnZXQgYSBUaW55VVJMIGZvciAnLiR1cmwsRV9V
U0VSX1dBUk5JTkcpOwogICAgICB9CgogIH0KCiAgcmV0dXJuIGZhbHNlOyAvLyBmYWlsCgp9
CgovKgogKiBTaG9ydGVuZWQgVVJMIHJlZGlyZWN0IGJhc2VkIG9uIHNtZF9zaG9ydF91cmwK
ICovCmZ1bmN0aW9uIGFyY19zaG9ydF91cmxfcmVkaXJlY3QoJGV2ZW50LCAkc3RlcCkgewog
IGdsb2JhbCAkcHJlZnM7CgogICRoYXZlX2lkID0gMDsKCiAgLy8gQ2hlY2sgaWYgdGhlcmUg
aXMgYW4gYXZhaWxhYmxlIHNob3J0IHNpdGUgdXJsIGFuZCBpZiBpdCBpcyBiZWluZyB1c2Vk
IGluCiAgLy8gdGhpcyBpbnN0YW5jZQogICRzaG9ydF9zaXRlX3VybCA9ICRwcmVmc1snYXJj
X3Nob3J0X3NpdGVfdXJsJ107CiAgaWYgKCRzaG9ydF9zaXRlX3VybCkgewogICAgJHNob3J0
X3NpdGVfdXJsID0gUFJPVE9DT0wuJHNob3J0X3NpdGVfdXJsLicvJzsKICAgICR1cmxfcGFy
dHMgPSBwYXJzZV91cmwoJHNob3J0X3NpdGVfdXJsKTsKICAgICRyZSA9ICcjXicuJHVybF9w
YXJ0c1sncGF0aCddLicoWzAtOV0uKikjJzsKICAgICRoYXZlX2lkID0gcHJlZ19tYXRjaCgk
cmUsICRfU0VSVkVSWydSRVFVRVNUX1VSSSddLCAkbSk7CiAgfQoKICAvLyBGYWxsIGJhY2sg
dG8gc3RhbmRhcmQgc2l0ZSB1cmwgKHNtZF9zaG9ydF91cmwgYmVoYXZpb3VyKQogIGlmICgk
aGF2ZV9pZCkgewogICAgJHVybF9wYXJ0cyA9IHBhcnNlX3VybChodSk7CiAgICAkcmUgPSAn
I14nLiR1cmxfcGFydHNbJ3BhdGgnXS4nKFswLTldLiopIyc7CiAgICAkaGF2ZV9pZCA9IHBy
ZWdfbWF0Y2goJHJlLCAkX1NFUlZFUlsnUkVRVUVTVF9VUkknXSwgJG0pOwogIH0KCiAgLy8g
RG8gdGhlIHJlZGlyZWN0IGlmIHdlJ3ZlIGdvdCBhbiBhcnRpY2xlIGlkCiAgaWYgKCRoYXZl
X2lkKSB7CiAgICAkaWQgPSAkbVsxXTsKICAgICRwZXJtbGluayA9IHBlcm1saW5rdXJsX2lk
KCRpZCk7CgogICAgaWYgKCRwZXJtbGluaykgewogICAgICBvYl9lbmRfY2xlYW4oKTsKCiAg
ICAgIC8vIFN0dXBpZCwgb3ZlciB0aGUgdG9wIGhlYWRlciBzZXR0aW5nIGZvciBJRQogICAg
ICBoZWFkZXIoIlN0YXR1czogMzAxIik7CiAgICAgIGhlYWRlcigiSFRUUC8xLjAgMzAxIE1v
dmVkIFBlcm1hbmVudGx5Iik7CiAgICAgIGhlYWRlcigiTG9jYXRpb246ICIuJHBlcm1saW5r
LCBUUlVFLCAzMDEpOwoKICAgICAgLy8gSW4gY2FzZSB0aGUgaGVhZGVyKCkgbWV0aG9kIGZh
aWxzLCBmYWxsIGJhY2sgb24gYSBjbGFzc2ljIHJlZGlyZWN0CiAgICAgIGVjaG8gJzxodG1s
PjxoZWFkPjxNRVRBIEhUVFAtRVFVSVY9IlJlZnJlc2giIENPTlRFTlQ9IjA7VVJMPScKICAg
ICAgICAuJHBlcm1saW5rLiciPjwvaGVhZD48Ym9keT48L2JvZHk+PC9odG1sPic7CiAgICAg
IGRpZSgpOwogICAgfQogIH0KCn0KCi8vIEF1dG8gZW5hYmxlIHBsdWdpbiBvbiBpbnN0YWxs
IChvcmlnaW5hbCBpZGVhIGJ5IE1pY2hhZWwgTWFuZnJlKQpmdW5jdGlvbiBfYXJjX3R3aXR0
ZXJfYXV0b19lbmFibGUoJGV2ZW50LCAkc3RlcCwgJHByZWZpeD0nYXJjX3R3aXR0ZXInKQp7
CiAgJHBsdWdpbiA9IHN1YnN0cigkZXZlbnQsIHN0cmxlbigncGx1Z2luX2xpZmVjeWNsZS4n
KSk7CiAgaWYgKHN0cm5jbXAoJHBsdWdpbiwgJHByZWZpeCwgc3RybGVuKCRwcmVmaXgpKSA9
PSAwKQogIHsKICAgIHNhZmVfdXBkYXRlKCd0eHBfcGx1Z2luJywgInN0YXR1cyA9IDEiLCAi
bmFtZSA9ICciIC4gZG9TbGFzaCgkcGx1Z2luKSAuICInIik7CiAgfQp9CgovKgogKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKgoqLwoKY2xhc3MgYXJjX3R3aXR0ZXIgZXh0ZW5kcyBUd2l0
dGVyT0F1dGggewogICAgLy8gQ2FjaGluZyB2YXJpYWJsZXMKICAgIHByaXZhdGUgJF9jYWNo
ZSA9IHRydWU7CiAgICBwcml2YXRlICRfY2FjaGVfZGlyID0gJy4vdG1wJzsKICAgIHByaXZh
dGUgJF9jYWNoZV90aW1lID0gMTgwMDsgLy8gMzAgbWludXRlIGNhY2hlCgogICAgZnVuY3Rp
b24gX19jb25zdHJ1Y3QoJGNvbnN1bWVyX2tleSwgJGNvbnN1bWVyX3NlY3JldCwgJG9hdXRo
X3Rva2VuID0gTlVMTAogICAgICAgICwgJG9hdXRoX3Rva2VuX3NlY3JldCA9IE5VTEwpCiAg
ICB7CiAgICAgICAgcGFyZW50OjpfX2NvbnN0cnVjdCgkY29uc3VtZXJfa2V5LCAkY29uc3Vt
ZXJfc2VjcmV0LCAkb2F1dGhfdG9rZW4KICAgICAgICAgICAgLCAkb2F1dGhfdG9rZW5fc2Vj
cmV0KTsKICAgICAgICAkdGhpcy0+Zm9ybWF0ID0gJ2pzb24nOwogICAgICAgICR0aGlzLT50
aW1lb3V0ID0gMTU7CiAgICAgICAgJHRoaXMtPmNvbm5lY3R0aW1lb3V0ID0gMTU7CiAgICB9
CgogICAgcHVibGljIGZ1bmN0aW9uIGNhbGxiYWNrVVJMKCRldmVudCwkc3RlcCkKICAgIHsK
ICAgICAgICByZXR1cm4gcHJlZ19yZXBsYWNlKCcvXD8uKi8nLCAnJyxQUk9UT0NPTC4kX1NF
UlZFUlsnU0VSVkVSX05BTUUnXS4kX1NFUlZFUlsnUkVRVUVTVF9VUkknXSkKICAgICAgICAg
IC4nP2V2ZW50PScuJGV2ZW50LicmYW1wO3N0ZXA9Jy4kc3RlcDsKICAgIH0KCiAgICAvLyBj
cmVhdGUgVHdpdHRlciBhbmQgZXh0ZXJuYWwgbGlua3MgaW4gdGV4dAogICAgcHVibGljIHN0
YXRpYyBmdW5jdGlvbiBtYWtlTGlua3MoJHRleHQpCiAgICB7CiAgICAgICAgJHVybCA9ICcv
XGIoaHR0cHxodHRwc3xmdHApOlwvXC8oW0EtWjAtOV1bQS1aMC05Xy1dKig/OlwuW0EtWjAt
OV1bQS1aMC05Xy1dKikrKTo/KFxkKyk/XC8/KFtcL1x3K1wuXSspXGIvaSc7CiAgICAgICAg
JHRleHQgPSBwcmVnX3JlcGxhY2UoJHVybCwgIjxhIGhyZWY9JyQwJyByZWw9J2V4dGVybmFs
Jz4kMDwvYT4iLCAkdGV4dCk7CiAgICAgICAgJHVybCA9ICcvXGIoXnxccyl3d3cuKFthLXpf
QS1aMC05XSspKChcLlthLXpdKykrKVxiL2knOwogICAgICAgICR0ZXh0ID0gcHJlZ19yZXBs
YWNlKCR1cmwsICI8YSBocmVmPSdodHRwOi8vd3d3LiQyJDMnIHJlbD0nZXh0ZXJuYWwnPnd3
dy4kMiQzPC9hPiIsICR0ZXh0KTsKICAgICAgICAkdGV4dCA9IHByZWdfcmVwbGFjZSgiLyhe
fFxzKS4/QChbYS16X0EtWjAtOV0rKS8iLAogICAgICAgICAgICAiJDFAPGEgaHJlZj0naHR0
cDovL3R3aXR0ZXIuY29tLyQyJyByZWw9J2V4dGVybmFsJz4kMjwvYT4iLCR0ZXh0KTsKICAg
ICAgICAkdGV4dCA9IHByZWdfcmVwbGFjZSgiLyhefFxzKShcIyhbYS16X0EtWjAtOTpfLV0r
KSkvIiwKICAgICAgICAgICAgIiQxPGEgaHJlZj0naHR0cDovL3R3aXR0ZXIuY29tL3NlYXJj
aD9xPSUyMyQzJyByZWw9J2V4dGVybmFsJz4kMjwvYT4iLCR0ZXh0KTsKICAgICAgICByZXR1
cm4gJHRleHQ7CiAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBnZXQoJHVybCwgJHBhcmFtcyA9
IGFycmF5KCkpCiAgICB7CiAgICAgICAgJGFwaV91cmwgPSBtZDUoJHVybC51cmxlbmNvZGUo
c2VyaWFsaXplKCRwYXJhbXMpKSk7CiAgICAgICAgJGRhdGEgPSAnJzsKCiAgICAgICAgaWYg
KCR0aGlzLT5fY2FjaGUpIHsgLy8gY2hlY2sgZm9yIGNhY2hlZCBqc29uCgogICAgICAgICAg
ICAkZGF0YSA9ICR0aGlzLT5fcmV0cmlldmVDYWNoZSgkYXBpX3VybCk7CgogICAgICAgIH0K
ICAgICAgICBpZiAoZW1wdHkoJGRhdGEpKSB7CiAgICAgICAgICAgICRkYXRhID0gcGFyZW50
OjpnZXQoJHVybCwgJHBhcmFtcyk7IC8vIGRhdGEgYWxyZWFkeSBqc29uX2RlY29kZSdkCiAg
ICAgICAgICAgIGlmICgkdGhpcy0+aHR0cF9jb2RlPT09MjAwICYmICRlbmNvZGVkX2RhdGE9
anNvbl9lbmNvZGUoJGRhdGEpKSB7IC8vIHNhdmUgY2FjaGUKICAgICAgICAgICAgICAgICRm
aWxlID0gJHRoaXMtPl9jYWNoZV9kaXIuJy8nLiRhcGlfdXJsOwogICAgICAgICAgICAgICAg
ZmlsZV9wdXRfY29udGVudHMoJGZpbGUsJGVuY29kZWRfZGF0YSxMT0NLX0VYKTsKICAgICAg
ICAgICAgICAgIHJldHVybiAkZGF0YTsKICAgICAgICAgICAgfSBlbHNlIHsgLy8gZmFpbGVk
IHRvIHJldHJpZXZlIGRhdGEgZnJvbSBUd2l0dGVyCgogICAgICAgICAgICAgICAgaWYgKCR0
aGlzLT5fY2FjaGUpIHsgLy8gYXR0ZW1wdCB0byBmb3JjZSBjYWNoZWQganNvbiByZXR1cm4K
CiAgICAgICAgICAgICAgICAgICAgJGRhdGEgPSAkdGhpcy0+X3JldHJpZXZlQ2FjaGUoJGFw
aV91cmwsdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKCRkYXRhKSByZXR1cm4ganNv
bl9kZWNvZGUoJGRhdGEpOwoKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBy
ZXR1cm4gZmFsc2U7CgogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsgLy8gcmV0dXJu
IGNhY2hlZCBqc29uCiAgICAgICAgICAgIHJldHVybiBqc29uX2RlY29kZSgkZGF0YSk7CiAg
ICAgICAgfQogICAgfSAvL2VuZCBnZXQoKQoKICAgIGZ1bmN0aW9uIHBvc3QoJHVybCwgJHBh
cmFtcyA9IGFycmF5KCkpCiAgICB7CiAgICAgICAgJGRhdGEgPSBwYXJlbnQ6OnBvc3QoJHVy
bCwkcGFyYW1zKTsKICAgICAgICByZXR1cm4gJGRhdGE7CiAgICB9CgogICAgZnVuY3Rpb24g
ZGVsZXRlKCR1cmwsICRwYXJhbXMgPSBhcnJheSgpKQogICAgewogICAgICAgICRkYXRhID0g
cGFyZW50OjpkZWxldGUoJHVybCwkcGFyYW1zKTsKICAgICAgICByZXR1cm4gJGRhdGE7CiAg
ICB9CgogICAgLy8gQ2FjaGUgbWV0aG9kcwoKICAgIHB1YmxpYyBmdW5jdGlvbiBzZXRDYWNo
aW5nKCRjYWNoZT10cnVlKQogICAgewogICAgICAgICR0aGlzLT5fY2FjaGUgPSAoJGNhY2hl
KSA/IHRydWUgOiBmYWxzZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwdWJs
aWMgZnVuY3Rpb24gY2FjaGVEaXIoJGxvYykKICAgIHsKICAgICAgICAkdGhpcy0+X2NhY2hl
X2RpciA9ICRsb2M7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHVibGljIGZ1
bmN0aW9uIGNhY2hlVGltZSgkbWlucykKICAgIHsKICAgICAgICAkdGhpcy0+X2NhY2hlX3Rp
bWUgPSAkbWlucyo2MDsgLy8gY29udmVydCBtaW51dGVzIGludG8gc2Vjb25kcwogICAgICAg
IHJldHVybiB0cnVlOwogICAgfQoKICAgIHByaXZhdGUgZnVuY3Rpb24gX3JldHJpZXZlQ2Fj
aGUoJHVybCwkb3ZlcmlkZV90aW1lb3V0PWZhbHNlKQogICAgewogICAgICAgICRmaWxlID0g
JHRoaXMtPl9jYWNoZV9kaXIuJy8nLiR1cmw7CiAgICAgICAgaWYgKGZpbGVfZXhpc3RzKCRm
aWxlKSkgewoKICAgICAgICAgICAgJGRpZmYgPSB0aW1lKCkgLSBmaWxlbXRpbWUoJGZpbGUp
OwogICAgICAgICAgICBpZiAoJG92ZXJpZGVfdGltZW91dCB8fCAkZGlmZiA8ICR0aGlzLT5f
Y2FjaGVfdGltZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGZpbGVfZ2V0X2NvbnRlbnRz
KCRmaWxlKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJldHVybiBm
YWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1
cm4gZmFsc2U7CiAgICAgICAgfQogICAgfQp9CgovKgogKiBBYnJhaGFtIFdpbGxpYW1zIChh
YnJhaGFtQGFicmFoLmFtKSBodHRwOi8vYWJyYWguYW0KICoKICogVGhlIGZpcnN0IFBIUCBM
aWJyYXJ5IHRvIHN1cHBvcnQgT0F1dGggZm9yIFR3aXR0ZXIncyBSRVNUIEFQSS4KICovCgov
KioKICogVHdpdHRlciBPQXV0aCBjbGFzcwogKi8KY2xhc3MgVHdpdHRlck9BdXRoIHsKICAv
KiBDb250YWlucyB0aGUgbGFzdCBIVFRQIHN0YXR1cyBjb2RlIHJldHVybmVkLiAqLwogIHB1
YmxpYyAkaHR0cF9jb2RlOwogIC8qIENvbnRhaW5zIHRoZSBsYXN0IEFQSSBjYWxsLiAqLwog
IHB1YmxpYyAkdXJsOwogIC8qIFNldCB1cCB0aGUgQVBJIHJvb3QgVVJMLiAqLwogIHB1Ymxp
YyAkaG9zdCA9ICJodHRwczovL2FwaS50d2l0dGVyLmNvbS8xLjEvIjsKICAvKiBTZXQgdGlt
ZW91dCBkZWZhdWx0LiAqLwogIHB1YmxpYyAkdGltZW91dCA9IDMwOwogIC8qIFNldCBjb25u
ZWN0IHRpbWVvdXQuICovCiAgcHVibGljICRjb25uZWN0dGltZW91dCA9IDMwOwogIC8qIFZl
cmlmeSBTU0wgQ2VydC4gKi8KICBwdWJsaWMgJHNzbF92ZXJpZnlwZWVyID0gRkFMU0U7CiAg
LyogUmVzcG9ucyBmb3JtYXQuICovCiAgcHVibGljICRmb3JtYXQgPSAnanNvbic7CiAgLyog
RGVjb2RlIHJldHVybmVkIGpzb24gZGF0YS4gKi8KICBwdWJsaWMgJGRlY29kZV9qc29uID0g
VFJVRTsKICAvKiBDb250YWlucyB0aGUgbGFzdCBIVFRQIGhlYWRlcnMgcmV0dXJuZWQuICov
CiAgcHVibGljICRodHRwX2luZm87CiAgLyogU2V0IHRoZSB1c2VyYWduZXQuICovCiAgcHVi
bGljICR1c2VyYWdlbnQgPSAnVHdpdHRlck9BdXRoIHYwLjIuMC1iZXRhMic7CiAgLyogSW1t
ZWRpYXRlbHkgcmV0cnkgdGhlIEFQSSBjYWxsIGlmIHRoZSByZXNwb25zZSB3YXMgbm90IHN1
Y2Nlc3NmdWwuICovCiAgLy9wdWJsaWMgJHJldHJ5ID0gVFJVRTsKCiAgLyoqCiAgICogU2V0
IEFQSSBVUkxTCiAgICovCiAgZnVuY3Rpb24gYWNjZXNzVG9rZW5VUkwoKSAgeyByZXR1cm4g
J2h0dHBzOi8vYXBpLnR3aXR0ZXIuY29tL29hdXRoL2FjY2Vzc190b2tlbic7IH0KICBmdW5j
dGlvbiBhdXRoZW50aWNhdGVVUkwoKSB7IHJldHVybiAnaHR0cHM6Ly9hcGkudHdpdHRlci5j
b20vb2F1dGgvYXV0aGVudGljYXRlJzsgfQogIGZ1bmN0aW9uIGF1dGhvcml6ZVVSTCgpICAg
IHsgcmV0dXJuICdodHRwczovL2FwaS50d2l0dGVyLmNvbS9vYXV0aC9hdXRob3JpemUnOyB9
CiAgZnVuY3Rpb24gcmVxdWVzdFRva2VuVVJMKCkgeyByZXR1cm4gJ2h0dHBzOi8vYXBpLnR3
aXR0ZXIuY29tL29hdXRoL3JlcXVlc3RfdG9rZW4nOyB9CgogIC8qKgogICAqIERlYnVnIGhl
bHBlcnMKICAgKi8KICBmdW5jdGlvbiBsYXN0U3RhdHVzQ29kZSgpIHsgcmV0dXJuICR0aGlz
LT5odHRwX3N0YXR1czsgfQogIGZ1bmN0aW9uIGxhc3RBUElDYWxsKCkgeyByZXR1cm4gJHRo
aXMtPmxhc3RfYXBpX2NhbGw7IH0KCiAgLyoqCiAgICogY29uc3RydWN0IFR3aXR0ZXJPQXV0
aCBvYmplY3QKICAgKi8KICBmdW5jdGlvbiBfX2NvbnN0cnVjdCgkY29uc3VtZXJfa2V5LCAk
Y29uc3VtZXJfc2VjcmV0LCAkb2F1dGhfdG9rZW4gPSBOVUxMLCAkb2F1dGhfdG9rZW5fc2Vj
cmV0ID0gTlVMTCkgewogICAgJHRoaXMtPnNoYTFfbWV0aG9kID0gbmV3IE9BdXRoU2lnbmF0
dXJlTWV0aG9kX0hNQUNfU0hBMSgpOwogICAgJHRoaXMtPmNvbnN1bWVyID0gbmV3IE9BdXRo
Q29uc3VtZXIoJGNvbnN1bWVyX2tleSwgJGNvbnN1bWVyX3NlY3JldCk7CiAgICBpZiAoIWVt
cHR5KCRvYXV0aF90b2tlbikgJiYgIWVtcHR5KCRvYXV0aF90b2tlbl9zZWNyZXQpKSB7CiAg
ICAgICR0aGlzLT50b2tlbiA9IG5ldyBPQXV0aENvbnN1bWVyKCRvYXV0aF90b2tlbiwgJG9h
dXRoX3Rva2VuX3NlY3JldCk7CiAgICB9IGVsc2UgewogICAgICAkdGhpcy0+dG9rZW4gPSBO
VUxMOwogICAgfQogIH0KCgogIC8qKgogICAqIEdldCBhIHJlcXVlc3RfdG9rZW4gZnJvbSBU
d2l0dGVyCiAgICoKICAgKiBAcmV0dXJucyBhIGtleS92YWx1ZSBhcnJheSBjb250YWluaW5n
IG9hdXRoX3Rva2VuIGFuZCBvYXV0aF90b2tlbl9zZWNyZXQKICAgKi8KICBmdW5jdGlvbiBn
ZXRSZXF1ZXN0VG9rZW4oJG9hdXRoX2NhbGxiYWNrKSB7CiAgICAkcGFyYW1ldGVycyA9IGFy
cmF5KCk7CiAgICAkcGFyYW1ldGVyc1snb2F1dGhfY2FsbGJhY2snXSA9ICRvYXV0aF9jYWxs
YmFjazsKICAgICRyZXF1ZXN0ID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgkdGhpcy0+cmVxdWVz
dFRva2VuVVJMKCksICdHRVQnLCAkcGFyYW1ldGVycyk7CiAgICAkdG9rZW4gPSBPQXV0aFV0
aWw6OnBhcnNlX3BhcmFtZXRlcnMoJHJlcXVlc3QpOwogICAgJHRoaXMtPnRva2VuID0gbmV3
IE9BdXRoQ29uc3VtZXIoJHRva2VuWydvYXV0aF90b2tlbiddLCAkdG9rZW5bJ29hdXRoX3Rv
a2VuX3NlY3JldCddKTsKICAgIHJldHVybiAkdG9rZW47CiAgfQoKICAvKioKICAgKiBHZXQg
dGhlIGF1dGhvcml6ZSBVUkwKICAgKgogICAqIEByZXR1cm5zIGEgc3RyaW5nCiAgICovCiAg
ZnVuY3Rpb24gZ2V0QXV0aG9yaXplVVJMKCR0b2tlbiwgJHNpZ25faW5fd2l0aF90d2l0dGVy
ID0gVFJVRSkgewogICAgaWYgKGlzX2FycmF5KCR0b2tlbikpIHsKICAgICAgJHRva2VuID0g
JHRva2VuWydvYXV0aF90b2tlbiddOwogICAgfQogICAgaWYgKGVtcHR5KCRzaWduX2luX3dp
dGhfdHdpdHRlcikpIHsKICAgICAgcmV0dXJuICR0aGlzLT5hdXRob3JpemVVUkwoKSAuICI/
b2F1dGhfdG9rZW49eyR0b2tlbn0iOwogICAgfSBlbHNlIHsKICAgICAgIHJldHVybiAkdGhp
cy0+YXV0aGVudGljYXRlVVJMKCkgLiAiP29hdXRoX3Rva2VuPXskdG9rZW59IjsKICAgIH0K
ICB9CgogIC8qKgogICAqIEV4Y2hhbmdlIHJlcXVlc3QgdG9rZW4gYW5kIHNlY3JldCBmb3Ig
YW4gYWNjZXNzIHRva2VuIGFuZAogICAqIHNlY3JldCwgdG8gc2lnbiBBUEkgY2FsbHMuCiAg
ICoKICAgKiBAcmV0dXJucyBhcnJheSgib2F1dGhfdG9rZW4iID0+ICJ0aGUtYWNjZXNzLXRv
a2VuIiwKICAgKiAgICAgICAgICAgICAgICAib2F1dGhfdG9rZW5fc2VjcmV0IiA9PiAidGhl
LWFjY2Vzcy1zZWNyZXQiLAogICAqICAgICAgICAgICAgICAgICJ1c2VyX2lkIiA9PiAiOTQz
Njk5MiIsCiAgICogICAgICAgICAgICAgICAgInNjcmVlbl9uYW1lIiA9PiAiYWJyYWhhbSIp
CiAgICovCiAgZnVuY3Rpb24gZ2V0QWNjZXNzVG9rZW4oJG9hdXRoX3ZlcmlmaWVyKSB7CiAg
ICAkcGFyYW1ldGVycyA9IGFycmF5KCk7CiAgICAkcGFyYW1ldGVyc1snb2F1dGhfdmVyaWZp
ZXInXSA9ICRvYXV0aF92ZXJpZmllcjsKICAgICRyZXF1ZXN0ID0gJHRoaXMtPm9BdXRoUmVx
dWVzdCgkdGhpcy0+YWNjZXNzVG9rZW5VUkwoKSwgJ0dFVCcsICRwYXJhbWV0ZXJzKTsKICAg
ICR0b2tlbiA9IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVycygkcmVxdWVzdCk7CiAgICAk
dGhpcy0+dG9rZW4gPSBuZXcgT0F1dGhDb25zdW1lcigkdG9rZW5bJ29hdXRoX3Rva2VuJ10s
ICR0b2tlblsnb2F1dGhfdG9rZW5fc2VjcmV0J10pOwogICAgcmV0dXJuICR0b2tlbjsKICB9
CgogIC8qKgogICAqIE9uZSB0aW1lIGV4Y2hhbmdlIG9mIHVzZXJuYW1lIGFuZCBwYXNzd29y
ZCBmb3IgYWNjZXNzIHRva2VuIGFuZCBzZWNyZXQuCiAgICoKICAgKiBAcmV0dXJucyBhcnJh
eSgib2F1dGhfdG9rZW4iID0+ICJ0aGUtYWNjZXNzLXRva2VuIiwKICAgKiAgICAgICAgICAg
ICAgICAib2F1dGhfdG9rZW5fc2VjcmV0IiA9PiAidGhlLWFjY2Vzcy1zZWNyZXQiLAogICAq
ICAgICAgICAgICAgICAgICJ1c2VyX2lkIiA9PiAiOTQzNjk5MiIsCiAgICogICAgICAgICAg
ICAgICAgInNjcmVlbl9uYW1lIiA9PiAiYWJyYWhhbSIsCiAgICogICAgICAgICAgICAgICAg
InhfYXV0aF9leHBpcmVzIiA9PiAiMCIpCiAgICovCiAgZnVuY3Rpb24gZ2V0WEF1dGhUb2tl
bigkdXNlcm5hbWUsICRwYXNzd29yZCkgewogICAgJHBhcmFtZXRlcnMgPSBhcnJheSgpOwog
ICAgJHBhcmFtZXRlcnNbJ3hfYXV0aF91c2VybmFtZSddID0gJHVzZXJuYW1lOwogICAgJHBh
cmFtZXRlcnNbJ3hfYXV0aF9wYXNzd29yZCddID0gJHBhc3N3b3JkOwogICAgJHBhcmFtZXRl
cnNbJ3hfYXV0aF9tb2RlJ10gPSAnY2xpZW50X2F1dGgnOwogICAgJHJlcXVlc3QgPSAkdGhp
cy0+b0F1dGhSZXF1ZXN0KCR0aGlzLT5hY2Nlc3NUb2tlblVSTCgpLCAnUE9TVCcsICRwYXJh
bWV0ZXJzKTsKICAgICR0b2tlbiA9IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVycygkcmVx
dWVzdCk7CiAgICAkdGhpcy0+dG9rZW4gPSBuZXcgT0F1dGhDb25zdW1lcigkdG9rZW5bJ29h
dXRoX3Rva2VuJ10sICR0b2tlblsnb2F1dGhfdG9rZW5fc2VjcmV0J10pOwogICAgcmV0dXJu
ICR0b2tlbjsKICB9CgogIC8qKgogICAqIEdFVCB3cmFwcGVyIGZvciBvQXV0aFJlcXVlc3Qu
CiAgICovCiAgZnVuY3Rpb24gZ2V0KCR1cmwsICRwYXJhbWV0ZXJzID0gYXJyYXkoKSkgewog
ICAgJHJlc3BvbnNlID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgkdXJsLCAnR0VUJywgJHBhcmFt
ZXRlcnMpOwogICAgaWYgKCR0aGlzLT5mb3JtYXQgPT09ICdqc29uJyAmJiAkdGhpcy0+ZGVj
b2RlX2pzb24pIHsKICAgICAgcmV0dXJuIGpzb25fZGVjb2RlKCRyZXNwb25zZSk7CiAgICB9
CiAgICByZXR1cm4gJHJlc3BvbnNlOwogIH0KCiAgLyoqCiAgICogUE9TVCB3cmFwcGVyIGZv
ciBvQXV0aFJlcXVlc3QuCiAgICovCiAgZnVuY3Rpb24gcG9zdCgkdXJsLCAkcGFyYW1ldGVy
cyA9IGFycmF5KCkpIHsKICAgICRyZXNwb25zZSA9ICR0aGlzLT5vQXV0aFJlcXVlc3QoJHVy
bCwgJ1BPU1QnLCAkcGFyYW1ldGVycyk7CiAgICBpZiAoJHRoaXMtPmZvcm1hdCA9PT0gJ2pz
b24nICYmICR0aGlzLT5kZWNvZGVfanNvbikgewogICAgICByZXR1cm4ganNvbl9kZWNvZGUo
JHJlc3BvbnNlKTsKICAgIH0KICAgIHJldHVybiAkcmVzcG9uc2U7CiAgfQoKICAvKioKICAg
KiBERUxFVEUgd3JhcHBlciBmb3Igb0F1dGhSZXFldXN0LgogICAqLwogIGZ1bmN0aW9uIGRl
bGV0ZSgkdXJsLCAkcGFyYW1ldGVycyA9IGFycmF5KCkpIHsKICAgICRyZXNwb25zZSA9ICR0
aGlzLT5vQXV0aFJlcXVlc3QoJHVybCwgJ0RFTEVURScsICRwYXJhbWV0ZXJzKTsKICAgIGlm
ICgkdGhpcy0+Zm9ybWF0ID09PSAnanNvbicgJiYgJHRoaXMtPmRlY29kZV9qc29uKSB7CiAg
ICAgIHJldHVybiBqc29uX2RlY29kZSgkcmVzcG9uc2UpOwogICAgfQogICAgcmV0dXJuICRy
ZXNwb25zZTsKICB9CgogIC8qKgogICAqIEZvcm1hdCBhbmQgc2lnbiBhbiBPQXV0aCAvIEFQ
SSByZXF1ZXN0CiAgICovCiAgZnVuY3Rpb24gb0F1dGhSZXF1ZXN0KCR1cmwsICRtZXRob2Qs
ICRwYXJhbWV0ZXJzKSB7CiAgICBpZiAoc3RycnBvcygkdXJsLCAnaHR0cHM6Ly8nKSAhPT0g
MCAmJiBzdHJycG9zKCR1cmwsICdodHRwOi8vJykgIT09IDApIHsKICAgICAgJHVybCA9ICJ7
JHRoaXMtPmhvc3R9eyR1cmx9LnskdGhpcy0+Zm9ybWF0fSI7CiAgICB9CiAgICAkcmVxdWVz
dCA9IE9BdXRoUmVxdWVzdDo6ZnJvbV9jb25zdW1lcl9hbmRfdG9rZW4oJHRoaXMtPmNvbnN1
bWVyLCAkdGhpcy0+dG9rZW4sICRtZXRob2QsICR1cmwsICRwYXJhbWV0ZXJzKTsKICAgICRy
ZXF1ZXN0LT5zaWduX3JlcXVlc3QoJHRoaXMtPnNoYTFfbWV0aG9kLCAkdGhpcy0+Y29uc3Vt
ZXIsICR0aGlzLT50b2tlbik7CiAgICBzd2l0Y2ggKCRtZXRob2QpIHsKICAgIGNhc2UgJ0dF
VCc6CiAgICAgIHJldHVybiAkdGhpcy0+aHR0cCgkcmVxdWVzdC0+dG9fdXJsKCksICdHRVQn
KTsKICAgIGRlZmF1bHQ6CiAgICAgIHJldHVybiAkdGhpcy0+aHR0cCgkcmVxdWVzdC0+Z2V0
X25vcm1hbGl6ZWRfaHR0cF91cmwoKSwgJG1ldGhvZCwgJHJlcXVlc3QtPnRvX3Bvc3RkYXRh
KCkpOwogICAgfQogIH0KCiAgLyoqCiAgICogTWFrZSBhbiBIVFRQIHJlcXVlc3QKICAgKgog
ICAqIEByZXR1cm4gQVBJIHJlc3VsdHMKICAgKi8KICBmdW5jdGlvbiBodHRwKCR1cmwsICRt
ZXRob2QsICRwb3N0ZmllbGRzID0gTlVMTCkgewogICAgJHRoaXMtPmh0dHBfaW5mbyA9IGFy
cmF5KCk7CiAgICAkY2kgPSBjdXJsX2luaXQoKTsKICAgIC8qIEN1cmwgc2V0dGluZ3MgKi8K
ICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9VU0VSQUdFTlQsICR0aGlzLT51c2VyYWdl
bnQpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX0NPTk5FQ1RUSU1FT1VULCAkdGhp
cy0+Y29ubmVjdHRpbWVvdXQpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX1RJTUVP
VVQsICR0aGlzLT50aW1lb3V0KTsKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9SRVRV
Uk5UUkFOU0ZFUiwgVFJVRSk7CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfSFRUUEhF
QURFUiwgYXJyYXkoJ0V4cGVjdDonKSk7CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRf
U1NMX1ZFUklGWVBFRVIsICR0aGlzLT5zc2xfdmVyaWZ5cGVlcik7CiAgICBjdXJsX3NldG9w
dCgkY2ksIENVUkxPUFRfSEVBREVSRlVOQ1RJT04sIGFycmF5KCR0aGlzLCAnZ2V0SGVhZGVy
JykpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX0hFQURFUiwgRkFMU0UpOwoKICAg
IHN3aXRjaCAoJG1ldGhvZCkgewogICAgICBjYXNlICdQT1NUJzoKICAgICAgICBjdXJsX3Nl
dG9wdCgkY2ksIENVUkxPUFRfUE9TVCwgVFJVRSk7CiAgICAgICAgaWYgKCFlbXB0eSgkcG9z
dGZpZWxkcykpIHsKICAgICAgICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9QT1NURklF
TERTLCAkcG9zdGZpZWxkcyk7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICBjYXNl
ICdERUxFVEUnOgogICAgICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9DVVNUT01SRVFV
RVNULCAnREVMRVRFJyk7CiAgICAgICAgaWYgKCFlbXB0eSgkcG9zdGZpZWxkcykpIHsKICAg
ICAgICAgICR1cmwgPSAieyR1cmx9P3skcG9zdGZpZWxkc30iOwogICAgICAgIH0KICAgIH0K
CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfVVJMLCAkdXJsKTsKICAgICRyZXNwb25z
ZSA9IGN1cmxfZXhlYygkY2kpOwogICAgJHRoaXMtPmh0dHBfY29kZSA9IGN1cmxfZ2V0aW5m
bygkY2ksIENVUkxJTkZPX0hUVFBfQ09ERSk7CiAgICAkdGhpcy0+aHR0cF9pbmZvID0gYXJy
YXlfbWVyZ2UoJHRoaXMtPmh0dHBfaW5mbywgY3VybF9nZXRpbmZvKCRjaSkpOwogICAgJHRo
aXMtPnVybCA9ICR1cmw7CiAgICBjdXJsX2Nsb3NlICgkY2kpOwogICAgcmV0dXJuICRyZXNw
b25zZTsKICB9CgogIC8qKgogICAqIEdldCB0aGUgaGVhZGVyIGluZm8gdG8gc3RvcmUuCiAg
ICovCiAgZnVuY3Rpb24gZ2V0SGVhZGVyKCRjaCwgJGhlYWRlcikgewogICAgJGkgPSBzdHJw
b3MoJGhlYWRlciwgJzonKTsKICAgIGlmICghZW1wdHkoJGkpKSB7CiAgICAgICRrZXkgPSBz
dHJfcmVwbGFjZSgnLScsICdfJywgc3RydG9sb3dlcihzdWJzdHIoJGhlYWRlciwgMCwgJGkp
KSk7CiAgICAgICR2YWx1ZSA9IHRyaW0oc3Vic3RyKCRoZWFkZXIsICRpICsgMikpOwogICAg
ICAkdGhpcy0+aHR0cF9oZWFkZXJbJGtleV0gPSAkdmFsdWU7CiAgICB9CiAgICByZXR1cm4g
c3RybGVuKCRoZWFkZXIpOwogIH0KfQovKiBHZW5lcmljIGV4Y2VwdGlvbiBjbGFzcwogKi8K
aWYgKCFjbGFzc19leGlzdHMoJ09BdXRoRXhjZXB0aW9uJykpIHsKICBjbGFzcyBPQXV0aEV4
Y2VwdGlvbiBleHRlbmRzIEV4Y2VwdGlvbiB7CiAgICAvLyBwYXNzCiAgfQp9CgpjbGFzcyBP
QXV0aENvbnN1bWVyIHsKICBwdWJsaWMgJGtleTsKICBwdWJsaWMgJHNlY3JldDsKCiAgZnVu
Y3Rpb24gX19jb25zdHJ1Y3QoJGtleSwgJHNlY3JldCwgJGNhbGxiYWNrX3VybD1OVUxMKSB7
CiAgICAkdGhpcy0+a2V5ID0gJGtleTsKICAgICR0aGlzLT5zZWNyZXQgPSAkc2VjcmV0Owog
ICAgJHRoaXMtPmNhbGxiYWNrX3VybCA9ICRjYWxsYmFja191cmw7CiAgfQoKICBmdW5jdGlv
biBfX3RvU3RyaW5nKCkgewogICAgcmV0dXJuICJPQXV0aENvbnN1bWVyW2tleT0kdGhpcy0+
a2V5LHNlY3JldD0kdGhpcy0+c2VjcmV0XSI7CiAgfQp9CgpjbGFzcyBPQXV0aFRva2VuIHsK
ICAvLyBhY2Nlc3MgdG9rZW5zIGFuZCByZXF1ZXN0IHRva2VucwogIHB1YmxpYyAka2V5Owog
IHB1YmxpYyAkc2VjcmV0OwoKICAvKioKICAgKiBrZXkgPSB0aGUgdG9rZW4KICAgKiBzZWNy
ZXQgPSB0aGUgdG9rZW4gc2VjcmV0CiAgICovCiAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGtl
eSwgJHNlY3JldCkgewogICAgJHRoaXMtPmtleSA9ICRrZXk7CiAgICAkdGhpcy0+c2VjcmV0
ID0gJHNlY3JldDsKICB9CgogIC8qKgogICAqIGdlbmVyYXRlcyB0aGUgYmFzaWMgc3RyaW5n
IHNlcmlhbGl6YXRpb24gb2YgYSB0b2tlbiB0aGF0IGEgc2VydmVyCiAgICogd291bGQgcmVz
cG9uZCB0byByZXF1ZXN0X3Rva2VuIGFuZCBhY2Nlc3NfdG9rZW4gY2FsbHMgd2l0aAogICAq
LwogIGZ1bmN0aW9uIHRvX3N0cmluZygpIHsKICAgIHJldHVybiAib2F1dGhfdG9rZW49IiAu
CiAgICAgICAgICAgT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NigkdGhpcy0+a2V5KSAu
CiAgICAgICAgICAgIiZvYXV0aF90b2tlbl9zZWNyZXQ9IiAuCiAgICAgICAgICAgT0F1dGhV
dGlsOjp1cmxlbmNvZGVfcmZjMzk4NigkdGhpcy0+c2VjcmV0KTsKICB9CgogIGZ1bmN0aW9u
IF9fdG9TdHJpbmcoKSB7CiAgICByZXR1cm4gJHRoaXMtPnRvX3N0cmluZygpOwogIH0KfQoK
LyoqCiAqIEEgY2xhc3MgZm9yIGltcGxlbWVudGluZyBhIFNpZ25hdHVyZSBNZXRob2QKICog
U2VlIHNlY3Rpb24gOSAoIlNpZ25pbmcgUmVxdWVzdHMiKSBpbiB0aGUgc3BlYwogKi8KYWJz
dHJhY3QgY2xhc3MgT0F1dGhTaWduYXR1cmVNZXRob2QgewogIC8qKgogICAqIE5lZWRzIHRv
IHJldHVybiB0aGUgbmFtZSBvZiB0aGUgU2lnbmF0dXJlIE1ldGhvZCAoaWUgSE1BQy1TSEEx
KQogICAqIEByZXR1cm4gc3RyaW5nCiAgICovCiAgYWJzdHJhY3QgcHVibGljIGZ1bmN0aW9u
IGdldF9uYW1lKCk7CgogIC8qKgogICAqIEJ1aWxkIHVwIHRoZSBzaWduYXR1cmUKICAgKiBO
T1RFOiBUaGUgb3V0cHV0IG9mIHRoaXMgZnVuY3Rpb24gTVVTVCBOT1QgYmUgdXJsZW5jb2Rl
ZC4KICAgKiB0aGUgZW5jb2RpbmcgaXMgaGFuZGxlZCBpbiBPQXV0aFJlcXVlc3Qgd2hlbiB0
aGUgZmluYWwKICAgKiByZXF1ZXN0IGlzIHNlcmlhbGl6ZWQKICAgKiBAcGFyYW0gT0F1dGhS
ZXF1ZXN0ICRyZXF1ZXN0CiAgICogQHBhcmFtIE9BdXRoQ29uc3VtZXIgJGNvbnN1bWVyCiAg
ICogQHBhcmFtIE9BdXRoVG9rZW4gJHRva2VuCiAgICogQHJldHVybiBzdHJpbmcKICAgKi8K
ICBhYnN0cmFjdCBwdWJsaWMgZnVuY3Rpb24gYnVpbGRfc2lnbmF0dXJlKCRyZXF1ZXN0LCAk
Y29uc3VtZXIsICR0b2tlbik7CgogIC8qKgogICAqIFZlcmlmaWVzIHRoYXQgYSBnaXZlbiBz
aWduYXR1cmUgaXMgY29ycmVjdAogICAqIEBwYXJhbSBPQXV0aFJlcXVlc3QgJHJlcXVlc3QK
ICAgKiBAcGFyYW0gT0F1dGhDb25zdW1lciAkY29uc3VtZXIKICAgKiBAcGFyYW0gT0F1dGhU
b2tlbiAkdG9rZW4KICAgKiBAcGFyYW0gc3RyaW5nICRzaWduYXR1cmUKICAgKiBAcmV0dXJu
IGJvb2wKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gY2hlY2tfc2lnbmF0dXJlKCRyZXF1ZXN0
LCAkY29uc3VtZXIsICR0b2tlbiwgJHNpZ25hdHVyZSkgewogICAgJGJ1aWx0ID0gJHRoaXMt
PmJ1aWxkX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pOwogICAgcmV0
dXJuICRidWlsdCA9PSAkc2lnbmF0dXJlOwogIH0KfQoKLyoqCiAqIFRoZSBITUFDLVNIQTEg
c2lnbmF0dXJlIG1ldGhvZCB1c2VzIHRoZSBITUFDLVNIQTEgc2lnbmF0dXJlIGFsZ29yaXRo
bSBhcyBkZWZpbmVkIGluIFtSRkMyMTA0XQogKiB3aGVyZSB0aGUgU2lnbmF0dXJlIEJhc2Ug
U3RyaW5nIGlzIHRoZSB0ZXh0IGFuZCB0aGUga2V5IGlzIHRoZSBjb25jYXRlbmF0ZWQgdmFs
dWVzIChlYWNoIGZpcnN0CiAqIGVuY29kZWQgcGVyIFBhcmFtZXRlciBFbmNvZGluZykgb2Yg
dGhlIENvbnN1bWVyIFNlY3JldCBhbmQgVG9rZW4gU2VjcmV0LCBzZXBhcmF0ZWQgYnkgYW4g
JyYnCiAqIGNoYXJhY3RlciAoQVNDSUkgY29kZSAzOCkgZXZlbiBpZiBlbXB0eS4KICogICAt
IENoYXB0ZXIgOS4yICgiSE1BQy1TSEExIikKICovCmNsYXNzIE9BdXRoU2lnbmF0dXJlTWV0
aG9kX0hNQUNfU0hBMSBleHRlbmRzIE9BdXRoU2lnbmF0dXJlTWV0aG9kIHsKICBmdW5jdGlv
biBnZXRfbmFtZSgpIHsKICAgIHJldHVybiAiSE1BQy1TSEExIjsKICB9CgogIHB1YmxpYyBm
dW5jdGlvbiBidWlsZF9zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKSB7
CiAgICAkYmFzZV9zdHJpbmcgPSAkcmVxdWVzdC0+Z2V0X3NpZ25hdHVyZV9iYXNlX3N0cmlu
ZygpOwogICAgJHJlcXVlc3QtPmJhc2Vfc3RyaW5nID0gJGJhc2Vfc3RyaW5nOwoKICAgICRr
ZXlfcGFydHMgPSBhcnJheSgKICAgICAgJGNvbnN1bWVyLT5zZWNyZXQsCiAgICAgICgkdG9r
ZW4pID8gJHRva2VuLT5zZWNyZXQgOiAiIgogICAgKTsKCiAgICAka2V5X3BhcnRzID0gT0F1
dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4Nigka2V5X3BhcnRzKTsKICAgICRrZXkgPSBpbXBs
b2RlKCcmJywgJGtleV9wYXJ0cyk7CgogICAgcmV0dXJuIGJhc2U2NF9lbmNvZGUoaGFzaF9o
bWFjKCdzaGExJywgJGJhc2Vfc3RyaW5nLCAka2V5LCB0cnVlKSk7CiAgfQp9CgovKioKICog
VGhlIFBMQUlOVEVYVCBtZXRob2QgZG9lcyBub3QgcHJvdmlkZSBhbnkgc2VjdXJpdHkgcHJv
dGVjdGlvbiBhbmQgU0hPVUxEIG9ubHkgYmUgdXNlZAogKiBvdmVyIGEgc2VjdXJlIGNoYW5u
ZWwgc3VjaCBhcyBIVFRQUy4gSXQgZG9lcyBub3QgdXNlIHRoZSBTaWduYXR1cmUgQmFzZSBT
dHJpbmcuCiAqICAgLSBDaGFwdGVyIDkuNCAoIlBMQUlOVEVYVCIpCiAqLwpjbGFzcyBPQXV0
aFNpZ25hdHVyZU1ldGhvZF9QTEFJTlRFWFQgZXh0ZW5kcyBPQXV0aFNpZ25hdHVyZU1ldGhv
ZCB7CiAgcHVibGljIGZ1bmN0aW9uIGdldF9uYW1lKCkgewogICAgcmV0dXJuICJQTEFJTlRF
WFQiOwogIH0KCiAgLyoqCiAgICogb2F1dGhfc2lnbmF0dXJlIGlzIHNldCB0byB0aGUgY29u
Y2F0ZW5hdGVkIGVuY29kZWQgdmFsdWVzIG9mIHRoZSBDb25zdW1lciBTZWNyZXQgYW5kCiAg
ICogVG9rZW4gU2VjcmV0LCBzZXBhcmF0ZWQgYnkgYSAnJicgY2hhcmFjdGVyIChBU0NJSSBj
b2RlIDM4KSwgZXZlbiBpZiBlaXRoZXIgc2VjcmV0IGlzCiAgICogZW1wdHkuIFRoZSByZXN1
bHQgTVVTVCBiZSBlbmNvZGVkIGFnYWluLgogICAqICAgLSBDaGFwdGVyIDkuNC4xICgiR2Vu
ZXJhdGluZyBTaWduYXR1cmVzIikKICAgKgogICAqIFBsZWFzZSBub3RlIHRoYXQgdGhlIHNl
Y29uZCBlbmNvZGluZyBNVVNUIE5PVCBoYXBwZW4gaW4gdGhlIFNpZ25hdHVyZU1ldGhvZCwg
YXMKICAgKiBPQXV0aFJlcXVlc3QgaGFuZGxlcyB0aGlzIQogICAqLwogIHB1YmxpYyBmdW5j
dGlvbiBidWlsZF9zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKSB7CiAg
ICAka2V5X3BhcnRzID0gYXJyYXkoCiAgICAgICRjb25zdW1lci0+c2VjcmV0LAogICAgICAo
JHRva2VuKSA/ICR0b2tlbi0+c2VjcmV0IDogIiIKICAgICk7CgogICAgJGtleV9wYXJ0cyA9
IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJGtleV9wYXJ0cyk7CiAgICAka2V5ID0g
aW1wbG9kZSgnJicsICRrZXlfcGFydHMpOwogICAgJHJlcXVlc3QtPmJhc2Vfc3RyaW5nID0g
JGtleTsKCiAgICByZXR1cm4gJGtleTsKICB9Cn0KCi8qKgogKiBUaGUgUlNBLVNIQTEgc2ln
bmF0dXJlIG1ldGhvZCB1c2VzIHRoZSBSU0FTU0EtUEtDUzEtdjFfNSBzaWduYXR1cmUgYWxn
b3JpdGhtIGFzIGRlZmluZWQgaW4KICogW1JGQzM0NDddIHNlY3Rpb24gOC4yIChtb3JlIHNp
bXBseSBrbm93biBhcyBQS0NTIzEpLCB1c2luZyBTSEEtMSBhcyB0aGUgaGFzaCBmdW5jdGlv
biBmb3IKICogRU1TQS1QS0NTMS12MV81LiBJdCBpcyBhc3N1bWVkIHRoYXQgdGhlIENvbnN1
bWVyIGhhcyBwcm92aWRlZCBpdHMgUlNBIHB1YmxpYyBrZXkgaW4gYQogKiB2ZXJpZmllZCB3
YXkgdG8gdGhlIFNlcnZpY2UgUHJvdmlkZXIsIGluIGEgbWFubmVyIHdoaWNoIGlzIGJleW9u
ZCB0aGUgc2NvcGUgb2YgdGhpcwogKiBzcGVjaWZpY2F0aW9uLgogKiAgIC0gQ2hhcHRlciA5
LjMgKCJSU0EtU0hBMSIpCiAqLwphYnN0cmFjdCBjbGFzcyBPQXV0aFNpZ25hdHVyZU1ldGhv
ZF9SU0FfU0hBMSBleHRlbmRzIE9BdXRoU2lnbmF0dXJlTWV0aG9kIHsKICBwdWJsaWMgZnVu
Y3Rpb24gZ2V0X25hbWUoKSB7CiAgICByZXR1cm4gIlJTQS1TSEExIjsKICB9CgogIC8vIFVw
IHRvIHRoZSBTUCB0byBpbXBsZW1lbnQgdGhpcyBsb29rdXAgb2Yga2V5cy4gUG9zc2libGUg
aWRlYXMgYXJlOgogIC8vICgxKSBkbyBhIGxvb2t1cCBpbiBhIHRhYmxlIG9mIHRydXN0ZWQg
Y2VydHMga2V5ZWQgb2ZmIG9mIGNvbnN1bWVyCiAgLy8gKDIpIGZldGNoIHZpYSBodHRwIHVz
aW5nIGEgdXJsIHByb3ZpZGVkIGJ5IHRoZSByZXF1ZXN0ZXIKICAvLyAoMykgc29tZSBzb3J0
IG9mIHNwZWNpZmljIGRpc2NvdmVyeSBjb2RlIGJhc2VkIG9uIHJlcXVlc3QKICAvLwogIC8v
IEVpdGhlciB3YXkgc2hvdWxkIHJldHVybiBhIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0
aGUgY2VydGlmaWNhdGUKICBwcm90ZWN0ZWQgYWJzdHJhY3QgZnVuY3Rpb24gZmV0Y2hfcHVi
bGljX2NlcnQoJiRyZXF1ZXN0KTsKCiAgLy8gVXAgdG8gdGhlIFNQIHRvIGltcGxlbWVudCB0
aGlzIGxvb2t1cCBvZiBrZXlzLiBQb3NzaWJsZSBpZGVhcyBhcmU6CiAgLy8gKDEpIGRvIGEg
bG9va3VwIGluIGEgdGFibGUgb2YgdHJ1c3RlZCBjZXJ0cyBrZXllZCBvZmYgb2YgY29uc3Vt
ZXIKICAvLwogIC8vIEVpdGhlciB3YXkgc2hvdWxkIHJldHVybiBhIHN0cmluZyByZXByZXNl
bnRhdGlvbiBvZiB0aGUgY2VydGlmaWNhdGUKICBwcm90ZWN0ZWQgYWJzdHJhY3QgZnVuY3Rp
b24gZmV0Y2hfcHJpdmF0ZV9jZXJ0KCYkcmVxdWVzdCk7CgogIHB1YmxpYyBmdW5jdGlvbiBi
dWlsZF9zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAkYmFz
ZV9zdHJpbmcgPSAkcmVxdWVzdC0+Z2V0X3NpZ25hdHVyZV9iYXNlX3N0cmluZygpOwogICAg
JHJlcXVlc3QtPmJhc2Vfc3RyaW5nID0gJGJhc2Vfc3RyaW5nOwoKICAgIC8vIEZldGNoIHRo
ZSBwcml2YXRlIGtleSBjZXJ0IGJhc2VkIG9uIHRoZSByZXF1ZXN0CiAgICAkY2VydCA9ICR0
aGlzLT5mZXRjaF9wcml2YXRlX2NlcnQoJHJlcXVlc3QpOwoKICAgIC8vIFB1bGwgdGhlIHBy
aXZhdGUga2V5IElEIGZyb20gdGhlIGNlcnRpZmljYXRlCiAgICAkcHJpdmF0ZWtleWlkID0g
b3BlbnNzbF9nZXRfcHJpdmF0ZWtleSgkY2VydCk7CgogICAgLy8gU2lnbiB1c2luZyB0aGUg
a2V5CiAgICAkb2sgPSBvcGVuc3NsX3NpZ24oJGJhc2Vfc3RyaW5nLCAkc2lnbmF0dXJlLCAk
cHJpdmF0ZWtleWlkKTsKCiAgICAvLyBSZWxlYXNlIHRoZSBrZXkgcmVzb3VyY2UKICAgIG9w
ZW5zc2xfZnJlZV9rZXkoJHByaXZhdGVrZXlpZCk7CgogICAgcmV0dXJuIGJhc2U2NF9lbmNv
ZGUoJHNpZ25hdHVyZSk7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gY2hlY2tfc2lnbmF0dXJl
KCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbiwgJHNpZ25hdHVyZSkgewogICAgJGRlY29k
ZWRfc2lnID0gYmFzZTY0X2RlY29kZSgkc2lnbmF0dXJlKTsKCiAgICAkYmFzZV9zdHJpbmcg
PSAkcmVxdWVzdC0+Z2V0X3NpZ25hdHVyZV9iYXNlX3N0cmluZygpOwoKICAgIC8vIEZldGNo
IHRoZSBwdWJsaWMga2V5IGNlcnQgYmFzZWQgb24gdGhlIHJlcXVlc3QKICAgICRjZXJ0ID0g
JHRoaXMtPmZldGNoX3B1YmxpY19jZXJ0KCRyZXF1ZXN0KTsKCiAgICAvLyBQdWxsIHRoZSBw
dWJsaWMga2V5IElEIGZyb20gdGhlIGNlcnRpZmljYXRlCiAgICAkcHVibGlja2V5aWQgPSBv
cGVuc3NsX2dldF9wdWJsaWNrZXkoJGNlcnQpOwoKICAgIC8vIENoZWNrIHRoZSBjb21wdXRl
ZCBzaWduYXR1cmUgYWdhaW5zdCB0aGUgb25lIHBhc3NlZCBpbiB0aGUgcXVlcnkKICAgICRv
ayA9IG9wZW5zc2xfdmVyaWZ5KCRiYXNlX3N0cmluZywgJGRlY29kZWRfc2lnLCAkcHVibGlj
a2V5aWQpOwoKICAgIC8vIFJlbGVhc2UgdGhlIGtleSByZXNvdXJjZQogICAgb3BlbnNzbF9m
cmVlX2tleSgkcHVibGlja2V5aWQpOwoKICAgIHJldHVybiAkb2sgPT0gMTsKICB9Cn0KCmNs
YXNzIE9BdXRoUmVxdWVzdCB7CiAgcHJpdmF0ZSAkcGFyYW1ldGVyczsKICBwcml2YXRlICRo
dHRwX21ldGhvZDsKICBwcml2YXRlICRodHRwX3VybDsKICAvLyBmb3IgZGVidWcgcHVycG9z
ZXMKICBwdWJsaWMgJGJhc2Vfc3RyaW5nOwogIHB1YmxpYyBzdGF0aWMgJHZlcnNpb24gPSAn
MS4wJzsKICBwdWJsaWMgc3RhdGljICRQT1NUX0lOUFVUID0gJ3BocDovL2lucHV0JzsKCiAg
ZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGh0dHBfbWV0aG9kLCAkaHR0cF91cmwsICRwYXJhbWV0
ZXJzPU5VTEwpIHsKICAgIEAkcGFyYW1ldGVycyBvciAkcGFyYW1ldGVycyA9IGFycmF5KCk7
CiAgICAkcGFyYW1ldGVycyA9IGFycmF5X21lcmdlKCBPQXV0aFV0aWw6OnBhcnNlX3BhcmFt
ZXRlcnMocGFyc2VfdXJsKCRodHRwX3VybCwgUEhQX1VSTF9RVUVSWSkpLCAkcGFyYW1ldGVy
cyk7CiAgICAkdGhpcy0+cGFyYW1ldGVycyA9ICRwYXJhbWV0ZXJzOwogICAgJHRoaXMtPmh0
dHBfbWV0aG9kID0gJGh0dHBfbWV0aG9kOwogICAgJHRoaXMtPmh0dHBfdXJsID0gJGh0dHBf
dXJsOwogIH0KCgogIC8qKgogICAqIGF0dGVtcHQgdG8gYnVpbGQgdXAgYSByZXF1ZXN0IGZy
b20gd2hhdCB3YXMgcGFzc2VkIHRvIHRoZSBzZXJ2ZXIKICAgKi8KICBwdWJsaWMgc3RhdGlj
IGZ1bmN0aW9uIGZyb21fcmVxdWVzdCgkaHR0cF9tZXRob2Q9TlVMTCwgJGh0dHBfdXJsPU5V
TEwsICRwYXJhbWV0ZXJzPU5VTEwpIHsKICAgICRzY2hlbWUgPSAoIWlzc2V0KCRfU0VSVkVS
WydIVFRQUyddKSB8fCAkX1NFUlZFUlsnSFRUUFMnXSAhPSAib24iKQogICAgICAgICAgICAg
ID8gJ2h0dHAnCiAgICAgICAgICAgICAgOiAnaHR0cHMnOwogICAgQCRodHRwX3VybCBvciAk
aHR0cF91cmwgPSAkc2NoZW1lIC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzov
LycgLiAkX1NFUlZFUlsnSFRUUF9IT1NUJ10gLgogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAnOicgLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkX1NFUlZFUlsnU0VS
VkVSX1BPUlQnXSAuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRfU0VSVkVSWydS
RVFVRVNUX1VSSSddOwogICAgQCRodHRwX21ldGhvZCBvciAkaHR0cF9tZXRob2QgPSAkX1NF
UlZFUlsnUkVRVUVTVF9NRVRIT0QnXTsKCiAgICAvLyBXZSB3ZXJlbid0IGhhbmRlZCBhbnkg
cGFyYW1ldGVycywgc28gbGV0J3MgZmluZCB0aGUgb25lcyByZWxldmFudCB0bwogICAgLy8g
dGhpcyByZXF1ZXN0LgogICAgLy8gSWYgeW91IHJ1biBYTUwtUlBDIG9yIHNpbWlsYXIgeW91
IHNob3VsZCB1c2UgdGhpcyB0byBwcm92aWRlIHlvdXIgb3duCiAgICAvLyBwYXJzZWQgcGFy
YW1ldGVyLWxpc3QKICAgIGlmICghJHBhcmFtZXRlcnMpIHsKICAgICAgLy8gRmluZCByZXF1
ZXN0IGhlYWRlcnMKICAgICAgJHJlcXVlc3RfaGVhZGVycyA9IE9BdXRoVXRpbDo6Z2V0X2hl
YWRlcnMoKTsKCiAgICAgIC8vIFBhcnNlIHRoZSBxdWVyeS1zdHJpbmcgdG8gZmluZCBHRVQg
cGFyYW1ldGVycwogICAgICAkcGFyYW1ldGVycyA9IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1l
dGVycygkX1NFUlZFUlsnUVVFUllfU1RSSU5HJ10pOwoKICAgICAgLy8gSXQncyBhIFBPU1Qg
cmVxdWVzdCBvZiB0aGUgcHJvcGVyIGNvbnRlbnQtdHlwZSwgc28gcGFyc2UgUE9TVAogICAg
ICAvLyBwYXJhbWV0ZXJzIGFuZCBhZGQgdGhvc2Ugb3ZlcnJpZGluZyBhbnkgZHVwbGljYXRl
cyBmcm9tIEdFVAogICAgICBpZiAoJGh0dHBfbWV0aG9kID09ICJQT1NUIgogICAgICAgICAg
JiYgQHN0cnN0cigkcmVxdWVzdF9oZWFkZXJzWyJDb250ZW50LVR5cGUiXSwKICAgICAgICAg
ICAgICAgICAgICAgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpCiAgICAg
ICAgICApIHsKICAgICAgICAkcG9zdF9kYXRhID0gT0F1dGhVdGlsOjpwYXJzZV9wYXJhbWV0
ZXJzKAogICAgICAgICAgZmlsZV9nZXRfY29udGVudHMoc2VsZjo6JFBPU1RfSU5QVVQpCiAg
ICAgICAgKTsKICAgICAgICAkcGFyYW1ldGVycyA9IGFycmF5X21lcmdlKCRwYXJhbWV0ZXJz
LCAkcG9zdF9kYXRhKTsKICAgICAgfQoKICAgICAgLy8gV2UgaGF2ZSBhIEF1dGhvcml6YXRp
b24taGVhZGVyIHdpdGggT0F1dGggZGF0YS4gUGFyc2UgdGhlIGhlYWRlcgogICAgICAvLyBh
bmQgYWRkIHRob3NlIG92ZXJyaWRpbmcgYW55IGR1cGxpY2F0ZXMgZnJvbSBHRVQgb3IgUE9T
VAogICAgICBpZiAoQHN1YnN0cigkcmVxdWVzdF9oZWFkZXJzWydBdXRob3JpemF0aW9uJ10s
IDAsIDYpID09ICJPQXV0aCAiKSB7CiAgICAgICAgJGhlYWRlcl9wYXJhbWV0ZXJzID0gT0F1
dGhVdGlsOjpzcGxpdF9oZWFkZXIoCiAgICAgICAgICAkcmVxdWVzdF9oZWFkZXJzWydBdXRo
b3JpemF0aW9uJ10KICAgICAgICApOwogICAgICAgICRwYXJhbWV0ZXJzID0gYXJyYXlfbWVy
Z2UoJHBhcmFtZXRlcnMsICRoZWFkZXJfcGFyYW1ldGVycyk7CiAgICAgIH0KCiAgICB9Cgog
ICAgcmV0dXJuIG5ldyBPQXV0aFJlcXVlc3QoJGh0dHBfbWV0aG9kLCAkaHR0cF91cmwsICRw
YXJhbWV0ZXJzKTsKICB9CgogIC8qKgogICAqIHByZXR0eSBtdWNoIGEgaGVscGVyIGZ1bmN0
aW9uIHRvIHNldCB1cCB0aGUgcmVxdWVzdAogICAqLwogIHB1YmxpYyBzdGF0aWMgZnVuY3Rp
b24gZnJvbV9jb25zdW1lcl9hbmRfdG9rZW4oJGNvbnN1bWVyLCAkdG9rZW4sICRodHRwX21l
dGhvZCwgJGh0dHBfdXJsLCAkcGFyYW1ldGVycz1OVUxMKSB7CiAgICBAJHBhcmFtZXRlcnMg
b3IgJHBhcmFtZXRlcnMgPSBhcnJheSgpOwogICAgJGRlZmF1bHRzID0gYXJyYXkoIm9hdXRo
X3ZlcnNpb24iID0+IE9BdXRoUmVxdWVzdDo6JHZlcnNpb24sCiAgICAgICAgICAgICAgICAg
ICAgICAib2F1dGhfbm9uY2UiID0+IE9BdXRoUmVxdWVzdDo6Z2VuZXJhdGVfbm9uY2UoKSwK
ICAgICAgICAgICAgICAgICAgICAgICJvYXV0aF90aW1lc3RhbXAiID0+IE9BdXRoUmVxdWVz
dDo6Z2VuZXJhdGVfdGltZXN0YW1wKCksCiAgICAgICAgICAgICAgICAgICAgICAib2F1dGhf
Y29uc3VtZXJfa2V5IiA9PiAkY29uc3VtZXItPmtleSk7CiAgICBpZiAoJHRva2VuKQogICAg
ICAkZGVmYXVsdHNbJ29hdXRoX3Rva2VuJ10gPSAkdG9rZW4tPmtleTsKCiAgICAkcGFyYW1l
dGVycyA9IGFycmF5X21lcmdlKCRkZWZhdWx0cywgJHBhcmFtZXRlcnMpOwoKICAgIHJldHVy
biBuZXcgT0F1dGhSZXF1ZXN0KCRodHRwX21ldGhvZCwgJGh0dHBfdXJsLCAkcGFyYW1ldGVy
cyk7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gc2V0X3BhcmFtZXRlcigkbmFtZSwgJHZhbHVl
LCAkYWxsb3dfZHVwbGljYXRlcyA9IHRydWUpIHsKICAgIGlmICgkYWxsb3dfZHVwbGljYXRl
cyAmJiBpc3NldCgkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0pKSB7CiAgICAgIC8vIFdlIGhh
dmUgYWxyZWFkeSBhZGRlZCBwYXJhbWV0ZXIocykgd2l0aCB0aGlzIG5hbWUsIHNvIGFkZCB0
byB0aGUgbGlzdAogICAgICBpZiAoaXNfc2NhbGFyKCR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1l
XSkpIHsKICAgICAgICAvLyBUaGlzIGlzIHRoZSBmaXJzdCBkdXBsaWNhdGUsIHNvIHRyYW5z
Zm9ybSBzY2FsYXIgKHN0cmluZykKICAgICAgICAvLyBpbnRvIGFuIGFycmF5IHNvIHdlIGNh
biBhZGQgdGhlIGR1cGxpY2F0ZXMKICAgICAgICAkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0g
PSBhcnJheSgkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0pOwogICAgICB9CgogICAgICAkdGhp
cy0+cGFyYW1ldGVyc1skbmFtZV1bXSA9ICR2YWx1ZTsKICAgIH0gZWxzZSB7CiAgICAgICR0
aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSA9ICR2YWx1ZTsKICAgIH0KICB9CgogIHB1YmxpYyBm
dW5jdGlvbiBnZXRfcGFyYW1ldGVyKCRuYW1lKSB7CiAgICByZXR1cm4gaXNzZXQoJHRoaXMt
PnBhcmFtZXRlcnNbJG5hbWVdKSA/ICR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSA6IG51bGw7
CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gZ2V0X3BhcmFtZXRlcnMoKSB7CiAgICByZXR1cm4g
JHRoaXMtPnBhcmFtZXRlcnM7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gdW5zZXRfcGFyYW1l
dGVyKCRuYW1lKSB7CiAgICB1bnNldCgkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0pOwogIH0K
CiAgLyoqCiAgICogVGhlIHJlcXVlc3QgcGFyYW1ldGVycywgc29ydGVkIGFuZCBjb25jYXRl
bmF0ZWQgaW50byBhIG5vcm1hbGl6ZWQgc3RyaW5nLgogICAqIEByZXR1cm4gc3RyaW5nCiAg
ICovCiAgcHVibGljIGZ1bmN0aW9uIGdldF9zaWduYWJsZV9wYXJhbWV0ZXJzKCkgewogICAg
Ly8gR3JhYiBhbGwgcGFyYW1ldGVycwogICAgJHBhcmFtcyA9ICR0aGlzLT5wYXJhbWV0ZXJz
OwoKICAgIC8vIFJlbW92ZSBvYXV0aF9zaWduYXR1cmUgaWYgcHJlc2VudAogICAgLy8gUmVm
OiBTcGVjOiA5LjEuMSAoIlRoZSBvYXV0aF9zaWduYXR1cmUgcGFyYW1ldGVyIE1VU1QgYmUg
ZXhjbHVkZWQuIikKICAgIGlmIChpc3NldCgkcGFyYW1zWydvYXV0aF9zaWduYXR1cmUnXSkp
IHsKICAgICAgdW5zZXQoJHBhcmFtc1snb2F1dGhfc2lnbmF0dXJlJ10pOwogICAgfQoKICAg
IHJldHVybiBPQXV0aFV0aWw6OmJ1aWxkX2h0dHBfcXVlcnkoJHBhcmFtcyk7CiAgfQoKICAv
KioKICAgKiBSZXR1cm5zIHRoZSBiYXNlIHN0cmluZyBvZiB0aGlzIHJlcXVlc3QKICAgKgog
ICAqIFRoZSBiYXNlIHN0cmluZyBkZWZpbmVkIGFzIHRoZSBtZXRob2QsIHRoZSB1cmwKICAg
KiBhbmQgdGhlIHBhcmFtZXRlcnMgKG5vcm1hbGl6ZWQpLCBlYWNoIHVybGVuY29kZWQKICAg
KiBhbmQgdGhlIGNvbmNhdGVkIHdpdGggJi4KICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gZ2V0
X3NpZ25hdHVyZV9iYXNlX3N0cmluZygpIHsKICAgICRwYXJ0cyA9IGFycmF5KAogICAgICAk
dGhpcy0+Z2V0X25vcm1hbGl6ZWRfaHR0cF9tZXRob2QoKSwKICAgICAgJHRoaXMtPmdldF9u
b3JtYWxpemVkX2h0dHBfdXJsKCksCiAgICAgICR0aGlzLT5nZXRfc2lnbmFibGVfcGFyYW1l
dGVycygpCiAgICApOwoKICAgICRwYXJ0cyA9IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5
ODYoJHBhcnRzKTsKCiAgICByZXR1cm4gaW1wbG9kZSgnJicsICRwYXJ0cyk7CiAgfQoKICAv
KioKICAgKiBqdXN0IHVwcGVyY2FzZXMgdGhlIGh0dHAgbWV0aG9kCiAgICovCiAgcHVibGlj
IGZ1bmN0aW9uIGdldF9ub3JtYWxpemVkX2h0dHBfbWV0aG9kKCkgewogICAgcmV0dXJuIHN0
cnRvdXBwZXIoJHRoaXMtPmh0dHBfbWV0aG9kKTsKICB9CgogIC8qKgogICAqIHBhcnNlcyB0
aGUgdXJsIGFuZCByZWJ1aWxkcyBpdCB0byBiZQogICAqIHNjaGVtZTovL2hvc3QvcGF0aAog
ICAqLwogIHB1YmxpYyBmdW5jdGlvbiBnZXRfbm9ybWFsaXplZF9odHRwX3VybCgpIHsKICAg
ICRwYXJ0cyA9IHBhcnNlX3VybCgkdGhpcy0+aHR0cF91cmwpOwoKICAgICRwb3J0ID0gQCRw
YXJ0c1sncG9ydCddOwogICAgJHNjaGVtZSA9ICRwYXJ0c1snc2NoZW1lJ107CiAgICAkaG9z
dCA9ICRwYXJ0c1snaG9zdCddOwogICAgJHBhdGggPSBAJHBhcnRzWydwYXRoJ107CgogICAg
JHBvcnQgb3IgJHBvcnQgPSAoJHNjaGVtZSA9PSAnaHR0cHMnKSA/ICc0NDMnIDogJzgwJzsK
CiAgICBpZiAoKCRzY2hlbWUgPT0gJ2h0dHBzJyAmJiAkcG9ydCAhPSAnNDQzJykKICAgICAg
ICB8fCAoJHNjaGVtZSA9PSAnaHR0cCcgJiYgJHBvcnQgIT0gJzgwJykpIHsKICAgICAgJGhv
c3QgPSAiJGhvc3Q6JHBvcnQiOwogICAgfQogICAgcmV0dXJuICIkc2NoZW1lOi8vJGhvc3Qk
cGF0aCI7CiAgfQoKICAvKioKICAgKiBidWlsZHMgYSB1cmwgdXNhYmxlIGZvciBhIEdFVCBy
ZXF1ZXN0CiAgICovCiAgcHVibGljIGZ1bmN0aW9uIHRvX3VybCgpIHsKICAgICRwb3N0X2Rh
dGEgPSAkdGhpcy0+dG9fcG9zdGRhdGEoKTsKICAgICRvdXQgPSAkdGhpcy0+Z2V0X25vcm1h
bGl6ZWRfaHR0cF91cmwoKTsKICAgIGlmICgkcG9zdF9kYXRhKSB7CiAgICAgICRvdXQgLj0g
Jz8nLiRwb3N0X2RhdGE7CiAgICB9CiAgICByZXR1cm4gJG91dDsKICB9CgogIC8qKgogICAq
IGJ1aWxkcyB0aGUgZGF0YSBvbmUgd291bGQgc2VuZCBpbiBhIFBPU1QgcmVxdWVzdAogICAq
LwogIHB1YmxpYyBmdW5jdGlvbiB0b19wb3N0ZGF0YSgpIHsKICAgIHJldHVybiBPQXV0aFV0
aWw6OmJ1aWxkX2h0dHBfcXVlcnkoJHRoaXMtPnBhcmFtZXRlcnMpOwogIH0KCiAgLyoqCiAg
ICogYnVpbGRzIHRoZSBBdXRob3JpemF0aW9uOiBoZWFkZXIKICAgKi8KICBwdWJsaWMgZnVu
Y3Rpb24gdG9faGVhZGVyKCRyZWFsbT1udWxsKSB7CiAgICAkZmlyc3QgPSB0cnVlOwogIGlm
KCRyZWFsbSkgewogICAgICAkb3V0ID0gJ0F1dGhvcml6YXRpb246IE9BdXRoIHJlYWxtPSIn
IC4gT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NigkcmVhbG0pIC4gJyInOwogICAgICAk
Zmlyc3QgPSBmYWxzZTsKICAgIH0gZWxzZQogICAgICAkb3V0ID0gJ0F1dGhvcml6YXRpb246
IE9BdXRoJzsKCiAgICAkdG90YWwgPSBhcnJheSgpOwogICAgZm9yZWFjaCAoJHRoaXMtPnBh
cmFtZXRlcnMgYXMgJGsgPT4gJHYpIHsKICAgICAgaWYgKHN1YnN0cigkaywgMCwgNSkgIT0g
Im9hdXRoIikgY29udGludWU7CiAgICAgIGlmIChpc19hcnJheSgkdikpIHsKICAgICAgICB0
aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oJ0FycmF5cyBub3Qgc3VwcG9ydGVkIGluIGhlYWRl
cnMnKTsKICAgICAgfQogICAgICAkb3V0IC49ICgkZmlyc3QpID8gJyAnIDogJywnOwogICAg
ICAkb3V0IC49IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJGspIC4KICAgICAgICAg
ICAgICAnPSInIC4KICAgICAgICAgICAgICBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2
KCR2KSAuCiAgICAgICAgICAgICAgJyInOwogICAgICAkZmlyc3QgPSBmYWxzZTsKICAgIH0K
ICAgIHJldHVybiAkb3V0OwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIF9fdG9TdHJpbmcoKSB7
CiAgICByZXR1cm4gJHRoaXMtPnRvX3VybCgpOwogIH0KCgogIHB1YmxpYyBmdW5jdGlvbiBz
aWduX3JlcXVlc3QoJHNpZ25hdHVyZV9tZXRob2QsICRjb25zdW1lciwgJHRva2VuKSB7CiAg
ICAkdGhpcy0+c2V0X3BhcmFtZXRlcigKICAgICAgIm9hdXRoX3NpZ25hdHVyZV9tZXRob2Qi
LAogICAgICAkc2lnbmF0dXJlX21ldGhvZC0+Z2V0X25hbWUoKSwKICAgICAgZmFsc2UKICAg
ICk7CiAgICAkc2lnbmF0dXJlID0gJHRoaXMtPmJ1aWxkX3NpZ25hdHVyZSgkc2lnbmF0dXJl
X21ldGhvZCwgJGNvbnN1bWVyLCAkdG9rZW4pOwogICAgJHRoaXMtPnNldF9wYXJhbWV0ZXIo
Im9hdXRoX3NpZ25hdHVyZSIsICRzaWduYXR1cmUsIGZhbHNlKTsKICB9CgogIHB1YmxpYyBm
dW5jdGlvbiBidWlsZF9zaWduYXR1cmUoJHNpZ25hdHVyZV9tZXRob2QsICRjb25zdW1lciwg
JHRva2VuKSB7CiAgICAkc2lnbmF0dXJlID0gJHNpZ25hdHVyZV9tZXRob2QtPmJ1aWxkX3Np
Z25hdHVyZSgkdGhpcywgJGNvbnN1bWVyLCAkdG9rZW4pOwogICAgcmV0dXJuICRzaWduYXR1
cmU7CiAgfQoKICAvKioKICAgKiB1dGlsIGZ1bmN0aW9uOiBjdXJyZW50IHRpbWVzdGFtcAog
ICAqLwogIHByaXZhdGUgc3RhdGljIGZ1bmN0aW9uIGdlbmVyYXRlX3RpbWVzdGFtcCgpIHsK
ICAgIHJldHVybiB0aW1lKCk7CiAgfQoKICAvKioKICAgKiB1dGlsIGZ1bmN0aW9uOiBjdXJy
ZW50IG5vbmNlCiAgICovCiAgcHJpdmF0ZSBzdGF0aWMgZnVuY3Rpb24gZ2VuZXJhdGVfbm9u
Y2UoKSB7CiAgICAkbXQgPSBtaWNyb3RpbWUoKTsKICAgICRyYW5kID0gbXRfcmFuZCgpOwoK
ICAgIHJldHVybiBtZDUoJG10IC4gJHJhbmQpOyAvLyBtZDVzIGxvb2sgbmljZXIgdGhhbiBu
dW1iZXJzCiAgfQp9CgpjbGFzcyBPQXV0aFNlcnZlciB7CiAgcHJvdGVjdGVkICR0aW1lc3Rh
bXBfdGhyZXNob2xkID0gMzAwOyAvLyBpbiBzZWNvbmRzLCBmaXZlIG1pbnV0ZXMKICBwcm90
ZWN0ZWQgJHZlcnNpb24gPSAnMS4wJzsgICAgICAgICAgICAgLy8gaGkgYmxhaW5lCiAgcHJv
dGVjdGVkICRzaWduYXR1cmVfbWV0aG9kcyA9IGFycmF5KCk7CgogIHByb3RlY3RlZCAkZGF0
YV9zdG9yZTsKCiAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGRhdGFfc3RvcmUpIHsKICAgICR0
aGlzLT5kYXRhX3N0b3JlID0gJGRhdGFfc3RvcmU7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24g
YWRkX3NpZ25hdHVyZV9tZXRob2QoJHNpZ25hdHVyZV9tZXRob2QpIHsKICAgICR0aGlzLT5z
aWduYXR1cmVfbWV0aG9kc1skc2lnbmF0dXJlX21ldGhvZC0+Z2V0X25hbWUoKV0gPQogICAg
ICAkc2lnbmF0dXJlX21ldGhvZDsKICB9CgogIC8vIGhpZ2ggbGV2ZWwgZnVuY3Rpb25zCgog
IC8qKgogICAqIHByb2Nlc3MgYSByZXF1ZXN0X3Rva2VuIHJlcXVlc3QKICAgKiByZXR1cm5z
IHRoZSByZXF1ZXN0IHRva2VuIG9uIHN1Y2Nlc3MKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24g
ZmV0Y2hfcmVxdWVzdF90b2tlbigmJHJlcXVlc3QpIHsKICAgICR0aGlzLT5nZXRfdmVyc2lv
bigkcmVxdWVzdCk7CgogICAgJGNvbnN1bWVyID0gJHRoaXMtPmdldF9jb25zdW1lcigkcmVx
dWVzdCk7CgogICAgLy8gbm8gdG9rZW4gcmVxdWlyZWQgZm9yIHRoZSBpbml0aWFsIHRva2Vu
IHJlcXVlc3QKICAgICR0b2tlbiA9IE5VTEw7CgogICAgJHRoaXMtPmNoZWNrX3NpZ25hdHVy
ZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pOwoKICAgIC8vIFJldiBBIGNoYW5nZQog
ICAgJGNhbGxiYWNrID0gJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoJ29hdXRoX2NhbGxiYWNr
Jyk7CiAgICAkbmV3X3Rva2VuID0gJHRoaXMtPmRhdGFfc3RvcmUtPm5ld19yZXF1ZXN0X3Rv
a2VuKCRjb25zdW1lciwgJGNhbGxiYWNrKTsKCiAgICByZXR1cm4gJG5ld190b2tlbjsKICB9
CgogIC8qKgogICAqIHByb2Nlc3MgYW4gYWNjZXNzX3Rva2VuIHJlcXVlc3QKICAgKiByZXR1
cm5zIHRoZSBhY2Nlc3MgdG9rZW4gb24gc3VjY2VzcwogICAqLwogIHB1YmxpYyBmdW5jdGlv
biBmZXRjaF9hY2Nlc3NfdG9rZW4oJiRyZXF1ZXN0KSB7CiAgICAkdGhpcy0+Z2V0X3ZlcnNp
b24oJHJlcXVlc3QpOwoKICAgICRjb25zdW1lciA9ICR0aGlzLT5nZXRfY29uc3VtZXIoJHJl
cXVlc3QpOwoKICAgIC8vIHJlcXVpcmVzIGF1dGhvcml6ZWQgcmVxdWVzdCB0b2tlbgogICAg
JHRva2VuID0gJHRoaXMtPmdldF90b2tlbigkcmVxdWVzdCwgJGNvbnN1bWVyLCAicmVxdWVz
dCIpOwoKICAgICR0aGlzLT5jaGVja19zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwg
JHRva2VuKTsKCiAgICAvLyBSZXYgQSBjaGFuZ2UKICAgICR2ZXJpZmllciA9ICRyZXF1ZXN0
LT5nZXRfcGFyYW1ldGVyKCdvYXV0aF92ZXJpZmllcicpOwogICAgJG5ld190b2tlbiA9ICR0
aGlzLT5kYXRhX3N0b3JlLT5uZXdfYWNjZXNzX3Rva2VuKCR0b2tlbiwgJGNvbnN1bWVyLCAk
dmVyaWZpZXIpOwoKICAgIHJldHVybiAkbmV3X3Rva2VuOwogIH0KCiAgLyoqCiAgICogdmVy
aWZ5IGFuIGFwaSBjYWxsLCBjaGVja3MgYWxsIHRoZSBwYXJhbWV0ZXJzCiAgICovCiAgcHVi
bGljIGZ1bmN0aW9uIHZlcmlmeV9yZXF1ZXN0KCYkcmVxdWVzdCkgewogICAgJHRoaXMtPmdl
dF92ZXJzaW9uKCRyZXF1ZXN0KTsKICAgICRjb25zdW1lciA9ICR0aGlzLT5nZXRfY29uc3Vt
ZXIoJHJlcXVlc3QpOwogICAgJHRva2VuID0gJHRoaXMtPmdldF90b2tlbigkcmVxdWVzdCwg
JGNvbnN1bWVyLCAiYWNjZXNzIik7CiAgICAkdGhpcy0+Y2hlY2tfc2lnbmF0dXJlKCRyZXF1
ZXN0LCAkY29uc3VtZXIsICR0b2tlbik7CiAgICByZXR1cm4gYXJyYXkoJGNvbnN1bWVyLCAk
dG9rZW4pOwogIH0KCiAgLy8gSW50ZXJuYWxzIGZyb20gaGVyZQogIC8qKgogICAqIHZlcnNp
b24gMQogICAqLwogIHByaXZhdGUgZnVuY3Rpb24gZ2V0X3ZlcnNpb24oJiRyZXF1ZXN0KSB7
CiAgICAkdmVyc2lvbiA9ICRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCJvYXV0aF92ZXJzaW9u
Iik7CiAgICBpZiAoISR2ZXJzaW9uKSB7CiAgICAgIC8vIFNlcnZpY2UgUHJvdmlkZXJzIE1V
U1QgYXNzdW1lIHRoZSBwcm90b2NvbCB2ZXJzaW9uIHRvIGJlIDEuMCBpZiB0aGlzIHBhcmFt
ZXRlciBpcyBub3QgcHJlc2VudC4KICAgICAgLy8gQ2hhcHRlciA3LjAgKCJBY2Nlc3Npbmcg
UHJvdGVjdGVkIFJlc3NvdXJjZXMiKQogICAgICAkdmVyc2lvbiA9ICcxLjAnOwogICAgfQog
ICAgaWYgKCR2ZXJzaW9uICE9PSAkdGhpcy0+dmVyc2lvbikgewogICAgICB0aHJvdyBuZXcg
T0F1dGhFeGNlcHRpb24oIk9BdXRoIHZlcnNpb24gJyR2ZXJzaW9uJyBub3Qgc3VwcG9ydGVk
Iik7CiAgICB9CiAgICByZXR1cm4gJHZlcnNpb247CiAgfQoKICAvKioKICAgKiBmaWd1cmUg
b3V0IHRoZSBzaWduYXR1cmUgd2l0aCBzb21lIGRlZmF1bHRzCiAgICovCiAgcHJpdmF0ZSBm
dW5jdGlvbiBnZXRfc2lnbmF0dXJlX21ldGhvZCgmJHJlcXVlc3QpIHsKICAgICRzaWduYXR1
cmVfbWV0aG9kID0KICAgICAgICBAJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoIm9hdXRoX3Np
Z25hdHVyZV9tZXRob2QiKTsKCiAgICBpZiAoISRzaWduYXR1cmVfbWV0aG9kKSB7CiAgICAg
IC8vIEFjY29yZGluZyB0byBjaGFwdGVyIDcgKCJBY2Nlc3NpbmcgUHJvdGVjdGVkIFJlc3Nv
dXJjZXMiKSB0aGUgc2lnbmF0dXJlLW1ldGhvZAogICAgICAvLyBwYXJhbWV0ZXIgaXMgcmVx
dWlyZWQsIGFuZCB3ZSBjYW4ndCBqdXN0IGZhbGxiYWNrIHRvIFBMQUlOVEVYVAogICAgICB0
aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oJ05vIHNpZ25hdHVyZSBtZXRob2QgcGFyYW1ldGVy
LiBUaGlzIHBhcmFtZXRlciBpcyByZXF1aXJlZCcpOwogICAgfQoKICAgIGlmICghaW5fYXJy
YXkoJHNpZ25hdHVyZV9tZXRob2QsCiAgICAgICAgICAgICAgICAgIGFycmF5X2tleXMoJHRo
aXMtPnNpZ25hdHVyZV9tZXRob2RzKSkpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0
aW9uKAogICAgICAgICJTaWduYXR1cmUgbWV0aG9kICckc2lnbmF0dXJlX21ldGhvZCcgbm90
IHN1cHBvcnRlZCAiIC4KICAgICAgICAidHJ5IG9uZSBvZiB0aGUgZm9sbG93aW5nOiAiIC4K
ICAgICAgICBpbXBsb2RlKCIsICIsIGFycmF5X2tleXMoJHRoaXMtPnNpZ25hdHVyZV9tZXRo
b2RzKSkKICAgICAgKTsKICAgIH0KICAgIHJldHVybiAkdGhpcy0+c2lnbmF0dXJlX21ldGhv
ZHNbJHNpZ25hdHVyZV9tZXRob2RdOwogIH0KCiAgLyoqCiAgICogdHJ5IHRvIGZpbmQgdGhl
IGNvbnN1bWVyIGZvciB0aGUgcHJvdmlkZWQgcmVxdWVzdCdzIGNvbnN1bWVyIGtleQogICAq
LwogIHByaXZhdGUgZnVuY3Rpb24gZ2V0X2NvbnN1bWVyKCYkcmVxdWVzdCkgewogICAgJGNv
bnN1bWVyX2tleSA9IEAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcigib2F1dGhfY29uc3VtZXJf
a2V5Iik7CiAgICBpZiAoISRjb25zdW1lcl9rZXkpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRo
RXhjZXB0aW9uKCJJbnZhbGlkIGNvbnN1bWVyIGtleSIpOwogICAgfQoKICAgICRjb25zdW1l
ciA9ICR0aGlzLT5kYXRhX3N0b3JlLT5sb29rdXBfY29uc3VtZXIoJGNvbnN1bWVyX2tleSk7
CiAgICBpZiAoISRjb25zdW1lcikgewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24o
IkludmFsaWQgY29uc3VtZXIiKTsKICAgIH0KCiAgICByZXR1cm4gJGNvbnN1bWVyOwogIH0K
CiAgLyoqCiAgICogdHJ5IHRvIGZpbmQgdGhlIHRva2VuIGZvciB0aGUgcHJvdmlkZWQgcmVx
dWVzdCdzIHRva2VuIGtleQogICAqLwogIHByaXZhdGUgZnVuY3Rpb24gZ2V0X3Rva2VuKCYk
cmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW5fdHlwZT0iYWNjZXNzIikgewogICAgJHRva2Vu
X2ZpZWxkID0gQCRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCdvYXV0aF90b2tlbicpOwogICAg
JHRva2VuID0gJHRoaXMtPmRhdGFfc3RvcmUtPmxvb2t1cF90b2tlbigKICAgICAgJGNvbnN1
bWVyLCAkdG9rZW5fdHlwZSwgJHRva2VuX2ZpZWxkCiAgICApOwogICAgaWYgKCEkdG9rZW4p
IHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJJbnZhbGlkICR0b2tlbl90eXBl
IHRva2VuOiAkdG9rZW5fZmllbGQiKTsKICAgIH0KICAgIHJldHVybiAkdG9rZW47CiAgfQoK
ICAvKioKICAgKiBhbGwtaW4tb25lIGZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBzaWduYXR1cmUg
b24gYSByZXF1ZXN0CiAgICogc2hvdWxkIGd1ZXNzIHRoZSBzaWduYXR1cmUgbWV0aG9kIGFw
cHJvcHJpYXRlbHkKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGNoZWNrX3NpZ25hdHVyZSgm
JHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAvLyB0aGlzIHNob3VsZCBwcm9i
YWJseSBiZSBpbiBhIGRpZmZlcmVudCBtZXRob2QKICAgICR0aW1lc3RhbXAgPSBAJHJlcXVl
c3QtPmdldF9wYXJhbWV0ZXIoJ29hdXRoX3RpbWVzdGFtcCcpOwogICAgJG5vbmNlID0gQCRy
ZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCdvYXV0aF9ub25jZScpOwoKICAgICR0aGlzLT5jaGVj
a190aW1lc3RhbXAoJHRpbWVzdGFtcCk7CiAgICAkdGhpcy0+Y2hlY2tfbm9uY2UoJGNvbnN1
bWVyLCAkdG9rZW4sICRub25jZSwgJHRpbWVzdGFtcCk7CgogICAgJHNpZ25hdHVyZV9tZXRo
b2QgPSAkdGhpcy0+Z2V0X3NpZ25hdHVyZV9tZXRob2QoJHJlcXVlc3QpOwoKICAgICRzaWdu
YXR1cmUgPSAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcignb2F1dGhfc2lnbmF0dXJlJyk7CiAg
ICAkdmFsaWRfc2lnID0gJHNpZ25hdHVyZV9tZXRob2QtPmNoZWNrX3NpZ25hdHVyZSgKICAg
ICAgJHJlcXVlc3QsCiAgICAgICRjb25zdW1lciwKICAgICAgJHRva2VuLAogICAgICAkc2ln
bmF0dXJlCiAgICApOwoKICAgIGlmICghJHZhbGlkX3NpZykgewogICAgICB0aHJvdyBuZXcg
T0F1dGhFeGNlcHRpb24oIkludmFsaWQgc2lnbmF0dXJlIik7CiAgICB9CiAgfQoKICAvKioK
ICAgKiBjaGVjayB0aGF0IHRoZSB0aW1lc3RhbXAgaXMgbmV3IGVub3VnaAogICAqLwogIHBy
aXZhdGUgZnVuY3Rpb24gY2hlY2tfdGltZXN0YW1wKCR0aW1lc3RhbXApIHsKICAgIGlmKCAh
ICR0aW1lc3RhbXAgKQogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oCiAgICAgICAg
J01pc3NpbmcgdGltZXN0YW1wIHBhcmFtZXRlci4gVGhlIHBhcmFtZXRlciBpcyByZXF1aXJl
ZCcKICAgICAgKTsKCiAgICAvLyB2ZXJpZnkgdGhhdCB0aW1lc3RhbXAgaXMgcmVjZW50aXNo
CiAgICAkbm93ID0gdGltZSgpOwogICAgaWYgKGFicygkbm93IC0gJHRpbWVzdGFtcCkgPiAk
dGhpcy0+dGltZXN0YW1wX3RocmVzaG9sZCkgewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNl
cHRpb24oCiAgICAgICAgIkV4cGlyZWQgdGltZXN0YW1wLCB5b3VycyAkdGltZXN0YW1wLCBv
dXJzICRub3ciCiAgICAgICk7CiAgICB9CiAgfQoKICAvKioKICAgKiBjaGVjayB0aGF0IHRo
ZSBub25jZSBpcyBub3QgcmVwZWF0ZWQKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGNoZWNr
X25vbmNlKCRjb25zdW1lciwgJHRva2VuLCAkbm9uY2UsICR0aW1lc3RhbXApIHsKICAgIGlm
KCAhICRub25jZSApCiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigKICAgICAgICAn
TWlzc2luZyBub25jZSBwYXJhbWV0ZXIuIFRoZSBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQnCiAg
ICAgICk7CgogICAgLy8gdmVyaWZ5IHRoYXQgdGhlIG5vbmNlIGlzIHVuaXF1ZWlzaAogICAg
JGZvdW5kID0gJHRoaXMtPmRhdGFfc3RvcmUtPmxvb2t1cF9ub25jZSgKICAgICAgJGNvbnN1
bWVyLAogICAgICAkdG9rZW4sCiAgICAgICRub25jZSwKICAgICAgJHRpbWVzdGFtcAogICAg
KTsKICAgIGlmICgkZm91bmQpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJO
b25jZSBhbHJlYWR5IHVzZWQ6ICRub25jZSIpOwogICAgfQogIH0KCn0KCmNsYXNzIE9BdXRo
RGF0YVN0b3JlIHsKICBmdW5jdGlvbiBsb29rdXBfY29uc3VtZXIoJGNvbnN1bWVyX2tleSkg
ewogICAgLy8gaW1wbGVtZW50IG1lCiAgfQoKICBmdW5jdGlvbiBsb29rdXBfdG9rZW4oJGNv
bnN1bWVyLCAkdG9rZW5fdHlwZSwgJHRva2VuKSB7CiAgICAvLyBpbXBsZW1lbnQgbWUKICB9
CgogIGZ1bmN0aW9uIGxvb2t1cF9ub25jZSgkY29uc3VtZXIsICR0b2tlbiwgJG5vbmNlLCAk
dGltZXN0YW1wKSB7CiAgICAvLyBpbXBsZW1lbnQgbWUKICB9CgogIGZ1bmN0aW9uIG5ld19y
ZXF1ZXN0X3Rva2VuKCRjb25zdW1lciwgJGNhbGxiYWNrID0gbnVsbCkgewogICAgLy8gcmV0
dXJuIGEgbmV3IHRva2VuIGF0dGFjaGVkIHRvIHRoaXMgY29uc3VtZXIKICB9CgogIGZ1bmN0
aW9uIG5ld19hY2Nlc3NfdG9rZW4oJHRva2VuLCAkY29uc3VtZXIsICR2ZXJpZmllciA9IG51
bGwpIHsKICAgIC8vIHJldHVybiBhIG5ldyBhY2Nlc3MgdG9rZW4gYXR0YWNoZWQgdG8gdGhp
cyBjb25zdW1lcgogICAgLy8gZm9yIHRoZSB1c2VyIGFzc29jaWF0ZWQgd2l0aCB0aGlzIHRv
a2VuIGlmIHRoZSByZXF1ZXN0IHRva2VuCiAgICAvLyBpcyBhdXRob3JpemVkCiAgICAvLyBz
aG91bGQgYWxzbyBpbnZhbGlkYXRlIHRoZSByZXF1ZXN0IHRva2VuCiAgfQoKfQoKY2xhc3Mg
T0F1dGhVdGlsIHsKICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIHVybGVuY29kZV9yZmMzOTg2
KCRpbnB1dCkgewogIGlmIChpc19hcnJheSgkaW5wdXQpKSB7CiAgICByZXR1cm4gYXJyYXlf
bWFwKGFycmF5KCdPQXV0aFV0aWwnLCAndXJsZW5jb2RlX3JmYzM5ODYnKSwgJGlucHV0KTsK
ICB9IGVsc2UgaWYgKGlzX3NjYWxhcigkaW5wdXQpKSB7CiAgICByZXR1cm4gc3RyX3JlcGxh
Y2UoCiAgICAgICcrJywKICAgICAgJyAnLAogICAgICBzdHJfcmVwbGFjZSgnJTdFJywgJ34n
LCByYXd1cmxlbmNvZGUoJGlucHV0KSkKICAgICk7CiAgfSBlbHNlIHsKICAgIHJldHVybiAn
JzsKICB9Cn0KCgogIC8vIFRoaXMgZGVjb2RlIGZ1bmN0aW9uIGlzbid0IHRha2luZyBpbnRv
IGNvbnNpZGVyYXRpb24gdGhlIGFib3ZlCiAgLy8gbW9kaWZpY2F0aW9ucyB0byB0aGUgZW5j
b2RpbmcgcHJvY2Vzcy4gSG93ZXZlciwgdGhpcyBtZXRob2QgZG9lc24ndAogIC8vIHNlZW0g
dG8gYmUgdXNlZCBhbnl3aGVyZSBzbyBsZWF2aW5nIGl0IGFzIGlzLgogIHB1YmxpYyBzdGF0
aWMgZnVuY3Rpb24gdXJsZGVjb2RlX3JmYzM5ODYoJHN0cmluZykgewogICAgcmV0dXJuIHVy
bGRlY29kZSgkc3RyaW5nKTsKICB9CgogIC8vIFV0aWxpdHkgZnVuY3Rpb24gZm9yIHR1cm5p
bmcgdGhlIEF1dGhvcml6YXRpb246IGhlYWRlciBpbnRvCiAgLy8gcGFyYW1ldGVycywgaGFz
IHRvIGRvIHNvbWUgdW5lc2NhcGluZwogIC8vIENhbiBmaWx0ZXIgb3V0IGFueSBub24tb2F1
dGggcGFyYW1ldGVycyBpZiBuZWVkZWQgKGRlZmF1bHQgYmVoYXZpb3VyKQogIHB1YmxpYyBz
dGF0aWMgZnVuY3Rpb24gc3BsaXRfaGVhZGVyKCRoZWFkZXIsICRvbmx5X2FsbG93X29hdXRo
X3BhcmFtZXRlcnMgPSB0cnVlKSB7CiAgICAkcGF0dGVybiA9ICcvKChbLV9hLXpdKik9KCIo
W14iXSopInwoW14sXSopKSw/KS8nOwogICAgJG9mZnNldCA9IDA7CiAgICAkcGFyYW1zID0g
YXJyYXkoKTsKICAgIHdoaWxlIChwcmVnX21hdGNoKCRwYXR0ZXJuLCAkaGVhZGVyLCAkbWF0
Y2hlcywgUFJFR19PRkZTRVRfQ0FQVFVSRSwgJG9mZnNldCkgPiAwKSB7CiAgICAgICRtYXRj
aCA9ICRtYXRjaGVzWzBdOwogICAgICAkaGVhZGVyX25hbWUgPSAkbWF0Y2hlc1syXVswXTsK
ICAgICAgJGhlYWRlcl9jb250ZW50ID0gKGlzc2V0KCRtYXRjaGVzWzVdKSkgPyAkbWF0Y2hl
c1s1XVswXSA6ICRtYXRjaGVzWzRdWzBdOwogICAgICBpZiAocHJlZ19tYXRjaCgnL15vYXV0
aF8vJywgJGhlYWRlcl9uYW1lKSB8fCAhJG9ubHlfYWxsb3dfb2F1dGhfcGFyYW1ldGVycykg
ewogICAgICAgICRwYXJhbXNbJGhlYWRlcl9uYW1lXSA9IE9BdXRoVXRpbDo6dXJsZGVjb2Rl
X3JmYzM5ODYoJGhlYWRlcl9jb250ZW50KTsKICAgICAgfQogICAgICAkb2Zmc2V0ID0gJG1h
dGNoWzFdICsgc3RybGVuKCRtYXRjaFswXSk7CiAgICB9CgogICAgaWYgKGlzc2V0KCRwYXJh
bXNbJ3JlYWxtJ10pKSB7CiAgICAgIHVuc2V0KCRwYXJhbXNbJ3JlYWxtJ10pOwogICAgfQoK
ICAgIHJldHVybiAkcGFyYW1zOwogIH0KCiAgLy8gaGVscGVyIHRvIHRyeSB0byBzb3J0IG91
dCBoZWFkZXJzIGZvciBwZW9wbGUgd2hvIGFyZW4ndCBydW5uaW5nIGFwYWNoZQogIHB1Ymxp
YyBzdGF0aWMgZnVuY3Rpb24gZ2V0X2hlYWRlcnMoKSB7CiAgICBpZiAoZnVuY3Rpb25fZXhp
c3RzKCdhcGFjaGVfcmVxdWVzdF9oZWFkZXJzJykpIHsKICAgICAgLy8gd2UgbmVlZCB0aGlz
IHRvIGdldCB0aGUgYWN0dWFsIEF1dGhvcml6YXRpb246IGhlYWRlcgogICAgICAvLyBiZWNh
dXNlIGFwYWNoZSB0ZW5kcyB0byB0ZWxsIHVzIGl0IGRvZXNuJ3QgZXhpc3QKICAgICAgJGhl
YWRlcnMgPSBhcGFjaGVfcmVxdWVzdF9oZWFkZXJzKCk7CgogICAgICAvLyBzYW5pdGl6ZSB0
aGUgb3V0cHV0IG9mIGFwYWNoZV9yZXF1ZXN0X2hlYWRlcnMgYmVjYXVzZQogICAgICAvLyB3
ZSBhbHdheXMgd2FudCB0aGUga2V5cyB0byBiZSBDYXNlZC1MaWtlLVRoaXMgYW5kIGFyaCgp
CiAgICAgIC8vIHJldHVybnMgdGhlIGhlYWRlcnMgaW4gdGhlIHNhbWUgY2FzZSBhcyB0aGV5
IGFyZSBpbiB0aGUKICAgICAgLy8gcmVxdWVzdAogICAgICAkb3V0ID0gYXJyYXkoKTsKICAg
ICAgZm9yZWFjaCggJGhlYWRlcnMgQVMgJGtleSA9PiAkdmFsdWUgKSB7CiAgICAgICAgJGtl
eSA9IHN0cl9yZXBsYWNlKAogICAgICAgICAgICAiICIsCiAgICAgICAgICAgICItIiwKICAg
ICAgICAgICAgdWN3b3JkcyhzdHJ0b2xvd2VyKHN0cl9yZXBsYWNlKCItIiwgIiAiLCAka2V5
KSkpCiAgICAgICAgICApOwogICAgICAgICRvdXRbJGtleV0gPSAkdmFsdWU7CiAgICAgIH0K
ICAgIH0gZWxzZSB7CiAgICAgIC8vIG90aGVyd2lzZSB3ZSBkb24ndCBoYXZlIGFwYWNoZSBh
bmQgYXJlIGp1c3QgZ29pbmcgdG8gaGF2ZSB0byBob3BlCiAgICAgIC8vIHRoYXQgJF9TRVJW
RVIgYWN0dWFsbHkgY29udGFpbnMgd2hhdCB3ZSBuZWVkCiAgICAgICRvdXQgPSBhcnJheSgp
OwogICAgICBpZiggaXNzZXQoJF9TRVJWRVJbJ0NPTlRFTlRfVFlQRSddKSApCiAgICAgICAg
JG91dFsnQ29udGVudC1UeXBlJ10gPSAkX1NFUlZFUlsnQ09OVEVOVF9UWVBFJ107CiAgICAg
IGlmKCBpc3NldCgkX0VOVlsnQ09OVEVOVF9UWVBFJ10pICkKICAgICAgICAkb3V0WydDb250
ZW50LVR5cGUnXSA9ICRfRU5WWydDT05URU5UX1RZUEUnXTsKCiAgICAgIGZvcmVhY2ggKCRf
U0VSVkVSIGFzICRrZXkgPT4gJHZhbHVlKSB7CiAgICAgICAgaWYgKHN1YnN0cigka2V5LCAw
LCA1KSA9PSAiSFRUUF8iKSB7CiAgICAgICAgICAvLyB0aGlzIGlzIGNoYW9zLCBiYXNpY2Fs
bHkgaXQgaXMganVzdCB0aGVyZSB0byBjYXBpdGFsaXplIHRoZSBmaXJzdAogICAgICAgICAg
Ly8gbGV0dGVyIG9mIGV2ZXJ5IHdvcmQgdGhhdCBpcyBub3QgYW4gaW5pdGlhbCBIVFRQIGFu
ZCBzdHJpcCBIVFRQCiAgICAgICAgICAvLyBjb2RlIGZyb20gcHJ6ZW1lawogICAgICAgICAg
JGtleSA9IHN0cl9yZXBsYWNlKAogICAgICAgICAgICAiICIsCiAgICAgICAgICAgICItIiwK
ICAgICAgICAgICAgdWN3b3JkcyhzdHJ0b2xvd2VyKHN0cl9yZXBsYWNlKCJfIiwgIiAiLCBz
dWJzdHIoJGtleSwgNSkpKSkKICAgICAgICAgICk7CiAgICAgICAgICAkb3V0WyRrZXldID0g
JHZhbHVlOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgcmV0dXJuICRvdXQ7CiAgfQoK
ICAvLyBUaGlzIGZ1bmN0aW9uIHRha2VzIGEgaW5wdXQgbGlrZSBhPWImYT1jJmQ9ZSBhbmQg
cmV0dXJucyB0aGUgcGFyc2VkCiAgLy8gcGFyYW1ldGVycyBsaWtlIHRoaXMKICAvLyBhcnJh
eSgnYScgPT4gYXJyYXkoJ2InLCdjJyksICdkJyA9PiAnZScpCiAgcHVibGljIHN0YXRpYyBm
dW5jdGlvbiBwYXJzZV9wYXJhbWV0ZXJzKCAkaW5wdXQgKSB7CiAgICBpZiAoIWlzc2V0KCRp
bnB1dCkgfHwgISRpbnB1dCkgcmV0dXJuIGFycmF5KCk7CgogICAgJHBhaXJzID0gZXhwbG9k
ZSgnJicsICRpbnB1dCk7CgogICAgJHBhcnNlZF9wYXJhbWV0ZXJzID0gYXJyYXkoKTsKICAg
IGZvcmVhY2ggKCRwYWlycyBhcyAkcGFpcikgewogICAgICAkc3BsaXQgPSBleHBsb2RlKCc9
JywgJHBhaXIsIDIpOwogICAgICAkcGFyYW1ldGVyID0gT0F1dGhVdGlsOjp1cmxkZWNvZGVf
cmZjMzk4Nigkc3BsaXRbMF0pOwogICAgICAkdmFsdWUgPSBpc3NldCgkc3BsaXRbMV0pID8g
T0F1dGhVdGlsOjp1cmxkZWNvZGVfcmZjMzk4Nigkc3BsaXRbMV0pIDogJyc7CgogICAgICBp
ZiAoaXNzZXQoJHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0ZXJdKSkgewogICAgICAgIC8v
IFdlIGhhdmUgYWxyZWFkeSByZWNpZXZlZCBwYXJhbWV0ZXIocykgd2l0aCB0aGlzIG5hbWUs
IHNvIGFkZCB0byB0aGUgbGlzdAogICAgICAgIC8vIG9mIHBhcmFtZXRlcnMgd2l0aCB0aGlz
IG5hbWUKCiAgICAgICAgaWYgKGlzX3NjYWxhcigkcGFyc2VkX3BhcmFtZXRlcnNbJHBhcmFt
ZXRlcl0pKSB7CiAgICAgICAgICAvLyBUaGlzIGlzIHRoZSBmaXJzdCBkdXBsaWNhdGUsIHNv
IHRyYW5zZm9ybSBzY2FsYXIgKHN0cmluZykgaW50byBhbiBhcnJheQogICAgICAgICAgLy8g
c28gd2UgY2FuIGFkZCB0aGUgZHVwbGljYXRlcwogICAgICAgICAgJHBhcnNlZF9wYXJhbWV0
ZXJzWyRwYXJhbWV0ZXJdID0gYXJyYXkoJHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0ZXJd
KTsKICAgICAgICB9CgogICAgICAgICRwYXJzZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVyXVtd
ID0gJHZhbHVlOwogICAgICB9IGVsc2UgewogICAgICAgICRwYXJzZWRfcGFyYW1ldGVyc1sk
cGFyYW1ldGVyXSA9ICR2YWx1ZTsKICAgICAgfQogICAgfQogICAgcmV0dXJuICRwYXJzZWRf
cGFyYW1ldGVyczsKICB9CgogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gYnVpbGRfaHR0cF9x
dWVyeSgkcGFyYW1zKSB7CiAgICBpZiAoISRwYXJhbXMpIHJldHVybiAnJzsKCiAgICAvLyBV
cmxlbmNvZGUgYm90aCBrZXlzIGFuZCB2YWx1ZXMKICAgICRrZXlzID0gT0F1dGhVdGlsOjp1
cmxlbmNvZGVfcmZjMzk4NihhcnJheV9rZXlzKCRwYXJhbXMpKTsKICAgICR2YWx1ZXMgPSBP
QXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KGFycmF5X3ZhbHVlcygkcGFyYW1zKSk7CiAg
ICAkcGFyYW1zID0gYXJyYXlfY29tYmluZSgka2V5cywgJHZhbHVlcyk7CgogICAgLy8gUGFy
YW1ldGVycyBhcmUgc29ydGVkIGJ5IG5hbWUsIHVzaW5nIGxleGljb2dyYXBoaWNhbCBieXRl
IHZhbHVlIG9yZGVyaW5nLgogICAgLy8gUmVmOiBTcGVjOiA5LjEuMSAoMSkKICAgIHVrc29y
dCgkcGFyYW1zLCAnc3RyY21wJyk7CgogICAgJHBhaXJzID0gYXJyYXkoKTsKICAgIGZvcmVh
Y2ggKCRwYXJhbXMgYXMgJHBhcmFtZXRlciA9PiAkdmFsdWUpIHsKICAgICAgaWYgKGlzX2Fy
cmF5KCR2YWx1ZSkpIHsKICAgICAgICAvLyBJZiB0d28gb3IgbW9yZSBwYXJhbWV0ZXJzIHNo
YXJlIHRoZSBzYW1lIG5hbWUsIHRoZXkgYXJlIHNvcnRlZCBieSB0aGVpciB2YWx1ZQogICAg
ICAgIC8vIFJlZjogU3BlYzogOS4xLjEgKDEpCiAgICAgICAgbmF0c29ydCgkdmFsdWUpOwog
ICAgICAgIGZvcmVhY2ggKCR2YWx1ZSBhcyAkZHVwbGljYXRlX3ZhbHVlKSB7CiAgICAgICAg
ICAkcGFpcnNbXSA9ICRwYXJhbWV0ZXIgLiAnPScgLiAkZHVwbGljYXRlX3ZhbHVlOwogICAg
ICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAkcGFpcnNbXSA9ICRwYXJhbWV0ZXIgLiAn
PScgLiAkdmFsdWU7CiAgICAgIH0KICAgIH0KICAgIC8vIEZvciBlYWNoIHBhcmFtZXRlciwg
dGhlIG5hbWUgaXMgc2VwYXJhdGVkIGZyb20gdGhlIGNvcnJlc3BvbmRpbmcgdmFsdWUgYnkg
YW4gJz0nIGNoYXJhY3RlciAoQVNDSUkgY29kZSA2MSkKICAgIC8vIEVhY2ggbmFtZS12YWx1
ZSBwYWlyIGlzIHNlcGFyYXRlZCBieSBhbiAnJicgY2hhcmFjdGVyIChBU0NJSSBjb2RlIDM4
KQogICAgcmV0dXJuIGltcGxvZGUoJyYnLCAkcGFpcnMpOwogIH0KfSI7czozOiJtZDUiO3M6
MzI6IjMwMzI1ZTU4ZTAxY2JmOTdkMWI4ZmJjYTNlMmVmZDIxIjt9
